---
"@esengine/pathfinding": patch
---

fix(pathfinding): 防止代理被推入障碍物或出界，支持沿墙滑动

## 问题
1. 当多个代理碰撞时，`resolveAgentCollisions` 可能会将代理推入障碍物内部
2. 正常移动过程中，代理可能被移动到地图边界外或障碍物内
3. 之前的检查只验证中心点，没有考虑代理半径
4. 当代理边缘轻微触碰障碍物时，会完全停止无法移动

## 解决方案

### 1. 添加 `isPositionWalkable` 方法
考虑代理半径的可行走性检查：
- 检查代理中心点和边界框4个角点
- 支持 tolerance 参数（默认 0.8），允许轻微重叠
- 正常移动使用宽松容差，防止卡死
- 碰撞推挤使用严格容差（1.0），防止被推入障碍物

### 2. 添加 `findSlidePosition` 方法
当目标位置不可行走时，尝试沿墙滑动：
- 尝试只沿 X 轴移动
- 尝试只沿 Y 轴移动
- 尝试 50% 的移动距离
- 实现平滑的沿墙滑动效果

### 3. 在 `resolveAgentCollisions` 中使用严格检查
- 使用 tolerance=1.0 进行完整半径检查
- 防止代理被其他代理推入障碍物

### 4. 在 `applyAvoidanceResult` 中使用滑动回退
- 使用 tolerance=0.8 允许轻微重叠
- 当检测到不可行走时，尝试滑动而不是停止
