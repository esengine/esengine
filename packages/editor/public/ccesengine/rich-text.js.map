{"version":3,"file":"rich-text.js","sources":["../../../cocos/2d/components/rich-text.ts"],"sourcesContent":["/*\r\n Copyright (c) 2013-2016 Chukong Technologies Inc.\r\n Copyright (c) 2017-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n http://www.cocos.com\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport { ccclass, requireComponent, executeInEditMode, executionOrder, help, menu, multiline, type, displayOrder, serializable, editable } from 'cc.decorator';\r\nimport { DEBUG, DEV, EDITOR } from 'internal:constants';\r\nimport { Font, SpriteAtlas, TTFFont, SpriteFrame } from '../assets';\r\nimport { EventTouch } from '../../input/types';\r\nimport { assert, warnID, Color, Vec2, CCObjectFlags, cclegacy, js, Size } from '../../core';\r\nimport { HtmlTextParser, IHtmlTextParserResultObj, IHtmlTextParserStack } from '../utils/html-text-parser';\r\nimport { Node } from '../../scene-graph';\r\nimport { CacheMode, HorizontalTextAlignment, Label, VerticalTextAlignment } from './label';\r\nimport { Sprite } from './sprite';\r\nimport { UITransform } from '../framework';\r\nimport { Component } from '../../scene-graph/component';\r\nimport { NodeEventType } from '../../scene-graph/node-event';\r\nimport {\r\n    BASELINE_RATIO,\r\n    fragmentText,\r\n    isUnicodeCJK,\r\n    isUnicodeSpace,\r\n    getEnglishWordPartAtFirst,\r\n    getEnglishWordPartAtLast,\r\n    getSymbolAt,\r\n} from '../utils/text-utils';\r\n\r\nconst _htmlTextParser = new HtmlTextParser();\r\nconst RichTextChildName = 'RICHTEXT_CHILD';\r\nconst RichTextChildImageName = 'RICHTEXT_Image_CHILD';\r\n\r\nconst _tempSize = new Vec2();\r\nconst _tempSizeLeft = new Vec2();\r\n\r\n/**\r\n * 富文本池。<br/>\r\n */\r\nconst labelPool = new js.Pool((seg: ISegment) => {\r\n    if (DEV) {\r\n        assert(!seg.node.parent, 'Recycling node\\'s parent should be null!');\r\n    }\r\n    if (!cclegacy.isValid(seg.node)) {\r\n        return false;\r\n    } else {\r\n        const label = seg.node.getComponent(Label);\r\n        if (label) {\r\n            label.outlineWidth = 0;\r\n        }\r\n    }\r\n    return true;\r\n}, 20);\r\n\r\nconst imagePool = new js.Pool((seg: ISegment) => {\r\n    if (DEV) {\r\n        assert(!seg.node.parent, 'Recycling node\\'s parent should be null!');\r\n    }\r\n    return cclegacy.isValid(seg.node) as boolean;\r\n}, 10);\r\n\r\n//\r\nfunction createSegment (type: string): ISegment {\r\n    return {\r\n        node: new Node(type),\r\n        comp: null,\r\n        lineCount: 0,\r\n        styleIndex: 0,\r\n        imageOffset: '',\r\n        clickParam: '',\r\n        clickHandler: '',\r\n        type,\r\n    };\r\n}\r\n\r\nfunction getSegmentByPool (type: string, content: string | SpriteFrame): ISegment | null {\r\n    let seg;\r\n    if (type === RichTextChildName) {\r\n        seg = labelPool._get();\r\n    } else if (type === RichTextChildImageName) {\r\n        seg = imagePool._get();\r\n    }\r\n    seg = seg || createSegment(type);\r\n    let node = seg.node as Node;\r\n    if (!node) {\r\n        node = new Node(type);\r\n    }\r\n    node.hideFlags |= CCObjectFlags.DontSave | CCObjectFlags.HideInHierarchy;\r\n    node.active = true; // Reset node state when use node\r\n    if (type === RichTextChildImageName) {\r\n        seg.comp = node.getComponent(Sprite) || node.addComponent(Sprite);\r\n        seg.comp.spriteFrame = content as SpriteFrame;\r\n        seg.comp.type = Sprite.Type.SLICED;\r\n        seg.comp.sizeMode = Sprite.SizeMode.CUSTOM;\r\n    } else { // RichTextChildName\r\n        seg.comp = node.getComponent(Label) || node.addComponent(Label);\r\n        seg.comp.string = content as string;\r\n        seg.comp.horizontalAlign = HorizontalTextAlignment.LEFT;\r\n        seg.comp.verticalAlign = VerticalTextAlignment.TOP;\r\n        seg.comp.underlineHeight = 2;\r\n    }\r\n    node.setPosition(0, 0, 0);\r\n    const trans = node._getUITransformComp()!;\r\n    trans.setAnchorPoint(0.5, 0.5);\r\n\r\n    seg.node = node;\r\n    seg.lineCount = 0;\r\n    seg.styleIndex = 0;\r\n    seg.imageOffset = '';\r\n    seg.clickParam = '';\r\n    seg.clickHandler = '';\r\n    return seg as ISegment | null;\r\n}\r\n\r\ninterface ISegment {\r\n    node: Node;\r\n    comp: Label | Sprite | null;\r\n    lineCount: number;\r\n    styleIndex: number;\r\n    imageOffset: string;\r\n    clickParam: string;\r\n    clickHandler: string;\r\n    type: string,\r\n}\r\n\r\n/**\r\n * @en\r\n * The RichText Component.\r\n *\r\n * @zh\r\n * 富文本组件。\r\n */\r\n@ccclass('cc.RichText')\r\n@requireComponent(UITransform)\r\n@help('i18n:cc.RichText')\r\n@executionOrder(110)\r\n@menu('2D/RichText')\r\n@executeInEditMode\r\nexport class RichText extends Component {\r\n    /**\r\n     * @en\r\n     * Content string of RichText.\r\n     *\r\n     * @zh\r\n     * 富文本显示的文本内容。\r\n     */\r\n    @multiline\r\n    get string (): string {\r\n        return this._string;\r\n    }\r\n    set string (value) {\r\n        if (this._string === value) {\r\n            return;\r\n        }\r\n\r\n        this._string = value;\r\n        this._updateRichTextStatus();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * Horizontal Alignment of each line in RichText.\r\n     *\r\n     * @zh\r\n     * 文本内容的水平对齐方式。\r\n     */\r\n    @type(HorizontalTextAlignment)\r\n    get horizontalAlign (): HorizontalTextAlignment {\r\n        return this._horizontalAlign;\r\n    }\r\n\r\n    set horizontalAlign (value) {\r\n        if (this.horizontalAlign === value) {\r\n            return;\r\n        }\r\n\r\n        this._horizontalAlign = value;\r\n        this._layoutDirty = true;\r\n        this._updateRichTextStatus();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * Vertical Alignment of each line in RichText.\r\n     *\r\n     * @zh\r\n     * 文本内容的竖直对齐方式。\r\n     */\r\n    @type(VerticalTextAlignment)\r\n    get verticalAlign (): VerticalTextAlignment {\r\n        return this._verticalAlign;\r\n    }\r\n\r\n    set verticalAlign (value) {\r\n        if (this._verticalAlign === value) {\r\n            return;\r\n        }\r\n\r\n        this._verticalAlign = value;\r\n        this._layoutDirty = true;\r\n        this._updateRichTextStatus();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * Font size of RichText.\r\n     *\r\n     * @zh\r\n     * 富文本字体大小。\r\n     */\r\n    @editable\r\n    get fontSize (): number {\r\n        return this._fontSize;\r\n    }\r\n\r\n    set fontSize (value) {\r\n        if (this._fontSize === value) {\r\n            return;\r\n        }\r\n\r\n        this._fontSize = value;\r\n        this._layoutDirty = true;\r\n        this._updateRichTextStatus();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * Font color of RichText. Works when the text content does not have a color parameter set. Transparency cascade is not supported.\r\n     *\r\n     * @zh\r\n     * 富文本默认文字颜色。在文本内容没有设置颜色参数时生效。暂不支持颜色级联。\r\n     */\r\n    @type(Color)\r\n    get fontColor (): Color {\r\n        return this._fontColor;\r\n    }\r\n    set fontColor (value: Color) {\r\n        if (this._fontColor === value) {\r\n            return;\r\n        }\r\n\r\n        this._fontColor = value;\r\n        this._updateTextDefaultColor();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * Custom System font of RichText.\r\n     *\r\n     * @zh\r\n     * 富文本定制系统字体。\r\n     */\r\n    @editable\r\n    get fontFamily (): string {\r\n        return this._fontFamily;\r\n    }\r\n    set fontFamily (value: string) {\r\n        if (this._fontFamily === value) return;\r\n        this._fontFamily = value;\r\n        this._layoutDirty = true;\r\n        this._updateRichTextStatus();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * Custom System font of RichText.\r\n     *\r\n     * @zh\r\n     * 富文本定制字体。\r\n     */\r\n    @type(Font)\r\n    get font (): TTFFont | null {\r\n        return this._font;\r\n    }\r\n    set font (value) {\r\n        if (this._font === value) {\r\n            return;\r\n        }\r\n        this._font = value;\r\n        this._layoutDirty = true;\r\n        if (this._font) {\r\n            if (EDITOR) {\r\n                this._userDefinedFont = this._font;\r\n            }\r\n            this.useSystemFont = false;\r\n            this._onTTFLoaded();\r\n        } else {\r\n            this.useSystemFont = true;\r\n        }\r\n        this._updateRichTextStatus();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * Whether to use system font name or not.\r\n     *\r\n     * @zh\r\n     * 是否使用系统字体。\r\n     */\r\n    @displayOrder(12)\r\n    get useSystemFont (): boolean {\r\n        return this._isSystemFontUsed;\r\n    }\r\n    set useSystemFont (value: boolean) {\r\n        if (this._isSystemFontUsed === value) {\r\n            return;\r\n        }\r\n        this._isSystemFontUsed = value;\r\n\r\n        if (EDITOR) {\r\n            if (value) {\r\n                this._font = null;\r\n            } else if (this._userDefinedFont) {\r\n                this._font = this._userDefinedFont;\r\n                return;\r\n            }\r\n        }\r\n\r\n        this._layoutDirty = true;\r\n        this._updateRichTextStatus();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * The cache mode of label. This mode only supports system fonts.\r\n     *\r\n     * @zh\r\n     * 文本缓存模式, 该模式只支持系统字体。\r\n     */\r\n    @type(CacheMode)\r\n    get cacheMode (): CacheMode {\r\n        return this._cacheMode;\r\n    }\r\n    set cacheMode (value: CacheMode) {\r\n        if (this._cacheMode === value) {\r\n            return;\r\n        }\r\n        this._cacheMode = value;\r\n        this._updateRichTextStatus();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * The maximize width of the RichText.\r\n     *\r\n     * @zh\r\n     * 富文本的最大宽度。\r\n     */\r\n    @editable\r\n    get maxWidth (): number {\r\n        return this._maxWidth;\r\n    }\r\n\r\n    set maxWidth (value) {\r\n        if (this._maxWidth === value) {\r\n            return;\r\n        }\r\n\r\n        this._maxWidth = value;\r\n        this._layoutDirty = true;\r\n        this._updateRichTextStatus();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * Line Height of RichText.\r\n     *\r\n     * @zh\r\n     * 富文本行高。\r\n     */\r\n    @editable\r\n    get lineHeight (): number {\r\n        return this._lineHeight;\r\n    }\r\n\r\n    set lineHeight (value) {\r\n        if (this._lineHeight === value) {\r\n            return;\r\n        }\r\n\r\n        this._lineHeight = value;\r\n        this._layoutDirty = true;\r\n        this._updateRichTextStatus();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * The image atlas for the img tag. For each src value in the img tag, there should be a valid spriteFrame in the image atlas.\r\n     *\r\n     * @zh\r\n     * 对于 img 标签里面的 src 属性名称，都需要在 imageAtlas 里面找到一个有效的 spriteFrame，否则 img tag 会判定为无效。\r\n     */\r\n    @type(SpriteAtlas)\r\n    get imageAtlas (): SpriteAtlas | null {\r\n        return this._imageAtlas;\r\n    }\r\n\r\n    set imageAtlas (value) {\r\n        if (this._imageAtlas === value) {\r\n            return;\r\n        }\r\n\r\n        this._imageAtlas = value;\r\n        this._layoutDirty = true;\r\n        this._updateRichTextStatus();\r\n    }\r\n\r\n    /**\r\n     * @en\r\n     * Once checked, the RichText will block all input events (mouse and touch) within\r\n     * the bounding box of the node, preventing the input from penetrating into the underlying node.\r\n     *\r\n     * @zh\r\n     * 选中此选项后，RichText 将阻止节点边界框中的所有输入事件（鼠标和触摸），从而防止输入事件穿透到底层节点。\r\n     */\r\n    @editable\r\n    get handleTouchEvent (): boolean {\r\n        return this._handleTouchEvent;\r\n    }\r\n\r\n    set handleTouchEvent (value) {\r\n        if (this._handleTouchEvent === value) {\r\n            return;\r\n        }\r\n\r\n        this._handleTouchEvent = value;\r\n        if (this.enabledInHierarchy) {\r\n            if (this.handleTouchEvent) {\r\n                this._addEventListeners();\r\n            } else {\r\n                this._removeEventListeners();\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * @en Enum for horizontal text alignment.\r\n     *\r\n     * @zh 文本横向对齐类型。\r\n     */\r\n    public static HorizontalAlign = HorizontalTextAlignment;\r\n    /**\r\n     * @en Enum for vertical text alignment.\r\n     *\r\n     * @zh 文本垂直对齐类型。\r\n     */\r\n    public static VerticalAlign = VerticalTextAlignment;\r\n\r\n    @serializable\r\n    protected _lineHeight = 40;\r\n    @serializable\r\n    protected _string = '<color=#00ff00>Rich</color><color=#0fffff>Text</color>';\r\n    // protected _updateRichTextStatus =\r\n    @serializable\r\n    protected _horizontalAlign = HorizontalTextAlignment.LEFT;\r\n    @serializable\r\n    protected _verticalAlign = VerticalTextAlignment.TOP;\r\n    @serializable\r\n    protected _fontSize = 40;\r\n    @serializable\r\n    protected _fontColor: Color = Color.WHITE.clone();\r\n    @serializable\r\n    protected _maxWidth = 0;\r\n    @serializable\r\n    protected _fontFamily = 'Arial';\r\n    @serializable\r\n    protected _font: TTFFont | null = null;\r\n    @serializable\r\n    protected _isSystemFontUsed = true;\r\n    @serializable\r\n    protected _userDefinedFont: TTFFont | null = null;\r\n    @serializable\r\n    protected _cacheMode: CacheMode = CacheMode.NONE;\r\n    @serializable\r\n    protected _imageAtlas: SpriteAtlas | null = null;\r\n    @serializable\r\n    protected _handleTouchEvent = true;\r\n\r\n    protected _textArray: IHtmlTextParserResultObj[] = [];\r\n    protected _segments: ISegment[] = [];\r\n    protected _labelSegmentsCache: ISegment[] = [];\r\n    protected _linesWidth: number[] = [];\r\n    protected _lineCount = 1;\r\n    protected _labelWidth = 0;\r\n    protected _labelHeight = 0;\r\n    protected _layoutDirty = true;\r\n    protected _lineOffsetX = 0;\r\n    protected declare _updateRichTextStatus: () => void;\r\n    protected _labelChildrenNum = 0; // only ISegment\r\n\r\n    constructor () {\r\n        super();\r\n        this._updateRichTextStatus = this._updateRichText;\r\n    }\r\n\r\n    public onLoad (): void {\r\n        this.node.on(NodeEventType.LAYER_CHANGED, this._applyLayer, this);\r\n        this.node.on(NodeEventType.ANCHOR_CHANGED, this._updateRichTextPosition, this);\r\n    }\r\n\r\n    public onEnable (): void {\r\n        if (this.handleTouchEvent) {\r\n            this._addEventListeners();\r\n        }\r\n\r\n        this._updateRichText();\r\n        this._activateChildren(true);\r\n    }\r\n\r\n    public onDisable (): void {\r\n        if (this.handleTouchEvent) {\r\n            this._removeEventListeners();\r\n        }\r\n\r\n        this._activateChildren(false);\r\n    }\r\n\r\n    public onRestore (): void {\r\n        if (!EDITOR) {\r\n            return;\r\n        }\r\n\r\n        // TODO: refine undo/redo system\r\n        // Because undo/redo will not call onEnable/onDisable,\r\n        // we need call onEnable/onDisable manually to active/disactive children nodes.\r\n        if (this.enabledInHierarchy) {\r\n            this.onEnable();\r\n        } else {\r\n            this.onDisable();\r\n        }\r\n    }\r\n\r\n    public onDestroy (): void {\r\n        this._segments.forEach((seg) => {\r\n            seg.node.removeFromParent();\r\n            if (seg.type === RichTextChildName) {\r\n                labelPool.put(seg);\r\n            } else if (seg.type === RichTextChildImageName) {\r\n                imagePool.put(seg);\r\n            }\r\n        });\r\n\r\n        this.node.off(NodeEventType.ANCHOR_CHANGED, this._updateRichTextPosition, this);\r\n        this.node.off(NodeEventType.LAYER_CHANGED, this._applyLayer, this);\r\n    }\r\n\r\n    protected _addEventListeners (): void {\r\n        this.node.on(NodeEventType.TOUCH_END, this._onTouchEnded, this);\r\n    }\r\n\r\n    protected _removeEventListeners (): void {\r\n        this.node.off(NodeEventType.TOUCH_END, this._onTouchEnded, this);\r\n    }\r\n\r\n    protected _updateLabelSegmentTextAttributes (): void {\r\n        this._segments.forEach((item) => {\r\n            this._applyTextAttribute(item);\r\n        });\r\n    }\r\n\r\n    protected _createFontLabel (str: string): ISegment {\r\n        return getSegmentByPool(RichTextChildName, str)!;\r\n    }\r\n\r\n    protected _createImage (spriteFrame: SpriteFrame): ISegment {\r\n        return getSegmentByPool(RichTextChildImageName, spriteFrame)!;\r\n    }\r\n\r\n    protected _onTTFLoaded (): void {\r\n        if (this._font instanceof TTFFont) {\r\n            this._layoutDirty = true;\r\n            this._updateRichText();\r\n        } else {\r\n            this._layoutDirty = true;\r\n            this._updateRichText();\r\n        }\r\n    }\r\n\r\n    /**\r\n    * @engineInternal\r\n    * @mangle\r\n    */\r\n    protected splitLongStringApproximatelyIn2048 (text: string, styleIndex: number): string[] {\r\n        const approxSize = text.length * this.fontSize;\r\n        const partStringArr: string[] = [];\r\n        // avoid that many short richtext still execute _calculateSize so that performance is low\r\n        // we set a threshold as 2048 * 0.8, if the estimated size is less than it, we can skip _calculateSize precisely\r\n        if (approxSize <= 2048 * 0.8) {\r\n            partStringArr.push(text);\r\n            return partStringArr;\r\n        }\r\n\r\n        this._calculateSize(_tempSize, styleIndex, text);\r\n        if (_tempSize.x < 2048) {\r\n            partStringArr.push(text);\r\n        } else {\r\n            const multilineTexts = text.split('\\n');\r\n            for (let i = 0; i < multilineTexts.length; i++) {\r\n                this._calculateSize(_tempSize, styleIndex, multilineTexts[i]);\r\n                if (_tempSize.x < 2048) {\r\n                    partStringArr.push(multilineTexts[i]);\r\n                } else {\r\n                    const thisPartSplitResultArr =  this.splitLongStringOver2048(multilineTexts[i], styleIndex);\r\n                    partStringArr.push(...thisPartSplitResultArr);\r\n                }\r\n            }\r\n        }\r\n        return partStringArr;\r\n    }\r\n\r\n    /**\r\n    * @engineInternal\r\n    * @mangle\r\n    */\r\n    protected splitLongStringOver2048 (text: string, styleIndex: number): string[] {\r\n        const partStringArr: string[] = [];\r\n        const longStr = text;\r\n\r\n        let curStart = 0;\r\n        let curEnd = longStr.length / 2;\r\n        let curString = longStr.substring(curStart, curEnd);\r\n        let leftString = longStr.substring(curEnd);\r\n        const curStringSize = this._calculateSize(_tempSize, styleIndex, curString);\r\n        const leftStringSize = this._calculateSize(_tempSizeLeft, styleIndex, leftString);\r\n        let maxWidth = this._maxWidth;\r\n        if (this._maxWidth === 0) {\r\n            maxWidth = 2047.9; // Callback when maxWidth is 0\r\n        }\r\n\r\n        // a line should be an unit to split long string\r\n        const lineCountForOnePart = 1;\r\n        const sizeForOnePart = lineCountForOnePart * maxWidth;\r\n\r\n        // divide text into some pieces of which the size is less than sizeForOnePart\r\n        while (curStringSize.x > sizeForOnePart) {\r\n            curEnd /= 2;\r\n            // at least one char can be an entity, step back.\r\n            if (curEnd < 1) {\r\n                curEnd *= 2;\r\n                break;\r\n            }\r\n\r\n            curString = curString.substring(curStart, curEnd);\r\n            leftString = longStr.substring(curEnd);\r\n            this._calculateSize(curStringSize, styleIndex, curString);\r\n        }\r\n\r\n        // avoid too many loops\r\n        let leftTryTimes = 1000;\r\n        // the minimum step of expansion or reduction\r\n        let curWordStep = 1;\r\n        while (leftTryTimes && curStart < text.length) {\r\n            while (leftTryTimes && curStringSize.x < sizeForOnePart) {\r\n                const nextPartExec = getEnglishWordPartAtFirst(leftString);\r\n                // add a character, unless there is a complete word at the beginning of the next line\r\n                if (nextPartExec && nextPartExec.length > 0) {\r\n                    curWordStep = nextPartExec[0].length;\r\n                }\r\n                curEnd += curWordStep;\r\n\r\n                curString = longStr.substring(curStart, curEnd);\r\n                leftString = longStr.substring(curEnd);\r\n                this._calculateSize(curStringSize, styleIndex, curString);\r\n\r\n                leftTryTimes--;\r\n            }\r\n\r\n            // reduce condition：size > maxwidth && curString.length >= 2\r\n            while (leftTryTimes && curString.length >= 2 && curStringSize.x > sizeForOnePart) {\r\n                curEnd -= curWordStep;\r\n                curString = longStr.substring(curStart, curEnd);\r\n                this._calculateSize(curStringSize, styleIndex, curString);\r\n                // after the first reduction, the step should be 1.\r\n                curWordStep = 1;\r\n\r\n                leftTryTimes--;\r\n            }\r\n\r\n            // consider there is a part of a word at the end of this line, it should be moved to the next line\r\n            if (curString.length >= 2) {\r\n                const lastWordExec = getEnglishWordPartAtLast(curString);\r\n                if (lastWordExec && lastWordExec.length > 0\r\n                    // to avoid endless loop when there is only one word in this line\r\n                    && curString !== lastWordExec[0]) {\r\n                    curEnd -= lastWordExec[0].length;\r\n                    curString = longStr.substring(curStart, curEnd);\r\n                }\r\n            }\r\n\r\n            // curStart and curEnd can be float since they are like positions of pointer,\r\n            // but step must be integer because we split the complete characters of which the unit is integer.\r\n            // it is reasonable that using the length of this result to estimate the next result.\r\n            partStringArr.push(curString);\r\n            const partStep = curString.length;\r\n            curStart = curEnd;\r\n            curEnd += partStep;\r\n\r\n            curString = longStr.substring(curStart, curEnd);\r\n            leftString = longStr.substring(curEnd);\r\n            this._calculateSize(leftStringSize, styleIndex, leftString);\r\n            this._calculateSize(curStringSize, styleIndex, curString);\r\n\r\n            leftTryTimes--;\r\n\r\n            // Exit: If the left part string size is less than 2048, the method will finish.\r\n            if (leftStringSize.x < 2048 && curStringSize.x < sizeForOnePart) {\r\n                partStringArr.push(curString);\r\n                curStart = text.length;\r\n                curEnd = text.length;\r\n                curString = leftString;\r\n                if (leftString !== '') {\r\n                    partStringArr.push(curString);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        return partStringArr;\r\n    }\r\n\r\n    protected _measureText (styleIndex: number, string?: string): number | ((s: string) => number) {\r\n        const func = (s: string): number => {\r\n            const width = this._calculateSize(_tempSize, styleIndex, s).x;\r\n            return width;\r\n        };\r\n        if (string) {\r\n            return func(string);\r\n        } else {\r\n            return func;\r\n        }\r\n    }\r\n\r\n    /**\r\n    * @engineInternal\r\n    * @mangle\r\n    */\r\n    protected _calculateSize (out: Vec2, styleIndex: number, s: string): Vec2 {\r\n        let label: ISegment;\r\n        if (this._labelSegmentsCache.length === 0) {\r\n            label = this._createFontLabel(s);\r\n            this._labelSegmentsCache.push(label);\r\n        } else {\r\n            label = this._labelSegmentsCache[0];\r\n            label.node.getComponent(Label)!.string = s;\r\n        }\r\n        label.styleIndex = styleIndex;\r\n        this._applyTextAttribute(label);\r\n        const size = label.node._getUITransformComp()!.contentSize;\r\n        Vec2.set(out, size.x, size.y);\r\n        return out;\r\n    }\r\n\r\n    protected _onTouchEnded (event: EventTouch): void {\r\n        const components = this.node.getComponents(Component);\r\n\r\n        this._segments.forEach((seg) => {\r\n            const clickHandler = seg.clickHandler;\r\n            const clickParam = seg.clickParam;\r\n            if (clickHandler && this._containsTouchLocation(seg, event.touch!.getUILocation())) {\r\n                components.forEach((component) => {\r\n                    const func = component[clickHandler];\r\n                    if (component.enabledInHierarchy && func) {\r\n                        func.call(component, event, clickParam);\r\n                    }\r\n                });\r\n                event.propagationStopped = true;\r\n            }\r\n        });\r\n    }\r\n\r\n    protected _containsTouchLocation (label: ISegment, point: Vec2): boolean {\r\n        const comp = label.node.getComponent(UITransform);\r\n        if (!comp) {\r\n            return false;\r\n        }\r\n\r\n        const myRect = comp.getBoundingBoxToWorld();\r\n        return myRect.contains(point);\r\n    }\r\n\r\n    protected _resetState (): void {\r\n        const children = this.node.children;\r\n\r\n        for (let i = children.length - 1; i >= 0; i--) {\r\n            const child = children[i];\r\n            if (child.name === RichTextChildName || child.name === RichTextChildImageName) {\r\n                if (DEBUG) {\r\n                    assert(child.parent === this.node);\r\n                }\r\n                child.parent = null;\r\n\r\n                const segment = createSegment(child.name);\r\n                segment.node = child;\r\n                if (child.name === RichTextChildName) {\r\n                    segment.comp = child.getComponent(Label);\r\n                    labelPool.put(segment);\r\n                } else {\r\n                    segment.comp = child.getComponent(Sprite);\r\n                    imagePool.put(segment);\r\n                }\r\n                this._labelChildrenNum--;\r\n            }\r\n        }\r\n\r\n        this._segments.length = 0;\r\n        this._labelSegmentsCache.length = 0;\r\n        this._linesWidth.length = 0;\r\n        this._lineOffsetX = 0;\r\n        this._lineCount = 1;\r\n        this._labelWidth = 0;\r\n        this._labelHeight = 0;\r\n        this._layoutDirty = true;\r\n    }\r\n\r\n    protected _activateChildren (active): void {\r\n        for (let i = this.node.children.length - 1; i >= 0; i--) {\r\n            const child = this.node.children[i];\r\n            if (child.name === RichTextChildName || child.name === RichTextChildImageName) {\r\n                child.active = active;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected _addLabelSegment (stringToken: string, styleIndex: number): ISegment {\r\n        let labelSegment: ISegment;\r\n        if (this._labelSegmentsCache.length === 0) {\r\n            labelSegment = this._createFontLabel(stringToken);\r\n        } else {\r\n            labelSegment = this._labelSegmentsCache.pop()!;\r\n            const label = labelSegment.node.getComponent(Label);\r\n            if (label) {\r\n                label.string = stringToken;\r\n            }\r\n        }\r\n\r\n        // set vertical alignments\r\n        // because horizontal alignment is applied with line offsets in method \"_updateRichTextPosition\"\r\n        const labelComp: Label = labelSegment.comp as Label;\r\n        if (labelComp.verticalAlign !== this._verticalAlign) {\r\n            labelComp.verticalAlign = this._verticalAlign;\r\n        }\r\n\r\n        labelSegment.styleIndex = styleIndex;\r\n        labelSegment.lineCount = this._lineCount;\r\n        labelSegment.node._getUITransformComp()!.setAnchorPoint(0, 0);\r\n        labelSegment.node.layer = this.node.layer;\r\n        this.node.insertChild(labelSegment.node, this._labelChildrenNum++);\r\n        this._applyTextAttribute(labelSegment);\r\n        this._segments.push(labelSegment);\r\n\r\n        return labelSegment;\r\n    }\r\n\r\n    protected _updateRichTextWithMaxWidth (labelString: string, labelWidth: number, styleIndex: number): void {\r\n        let fragmentWidth = labelWidth;\r\n        let labelSegment: ISegment;\r\n\r\n        if (this._lineOffsetX > 0 && fragmentWidth + this._lineOffsetX > this._maxWidth) {\r\n            // concat previous line\r\n            let checkStartIndex = 0;\r\n            while (this._lineOffsetX <= this._maxWidth) {\r\n                const checkEndIndex = this._getFirstWordLen(labelString, checkStartIndex, labelString.length);\r\n                const checkString = labelString.substr(checkStartIndex, checkEndIndex);\r\n                const checkStringWidth = this._measureText(styleIndex, checkString) as number;\r\n\r\n                if (this._lineOffsetX + checkStringWidth <= this._maxWidth) {\r\n                    this._lineOffsetX += checkStringWidth;\r\n                    checkStartIndex += checkEndIndex;\r\n                } else {\r\n                    if (checkStartIndex > 0) {\r\n                        const remainingString = labelString.substr(0, checkStartIndex);\r\n                        this._addLabelSegment(remainingString, styleIndex);\r\n                        labelString = labelString.substr(checkStartIndex, labelString.length);\r\n                        fragmentWidth = this._measureText(styleIndex, labelString) as number;\r\n                    }\r\n                    this._updateLineInfo();\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (fragmentWidth > this._maxWidth) {\r\n            const fragments = fragmentText(\r\n                labelString,\r\n                fragmentWidth,\r\n                this._maxWidth,\r\nthis._measureText(styleIndex) as unknown as (s: string) => number,\r\n            );\r\n            for (let k = 0; k < fragments.length; ++k) {\r\n                const splitString = fragments[k];\r\n                labelSegment = this._addLabelSegment(splitString, styleIndex);\r\n                const labelSize = labelSegment.node._getUITransformComp()!.contentSize;\r\n                this._lineOffsetX += labelSize.width;\r\n                if (fragments.length > 1 && k < fragments.length - 1) {\r\n                    this._updateLineInfo();\r\n                }\r\n            }\r\n        } else {\r\n            this._lineOffsetX += fragmentWidth;\r\n            this._addLabelSegment(labelString, styleIndex);\r\n        }\r\n    }\r\n\r\n    protected _isLastComponentCR (stringToken): boolean {\r\n        return stringToken.length - 1 === stringToken.lastIndexOf('\\n');\r\n    }\r\n\r\n    protected _updateLineInfo (): void {\r\n        this._linesWidth.push(this._lineOffsetX);\r\n        this._lineOffsetX = 0;\r\n        this._lineCount++;\r\n    }\r\n\r\n    protected _needsUpdateTextLayout (newTextArray: IHtmlTextParserResultObj[]): boolean {\r\n        if (this._layoutDirty || !this._textArray || !newTextArray) {\r\n            return true;\r\n        }\r\n\r\n        if (this._textArray.length !== newTextArray.length) {\r\n            return true;\r\n        }\r\n\r\n        for (let i = 0; i < this._textArray.length; i++) {\r\n            const oldItem = this._textArray[i];\r\n            const newItem = newTextArray[i];\r\n            if (oldItem.text !== newItem.text) {\r\n                return true;\r\n            } else {\r\n                const oldStyle = oldItem.style; const newStyle = newItem.style;\r\n                if (oldStyle) {\r\n                    if (newStyle) {\r\n                        if (!!newStyle.outline !== !!oldStyle.outline) {\r\n                            return true;\r\n                        }\r\n                        if (oldStyle.size !== newStyle.size\r\n                            || oldStyle.italic !== newStyle.italic\r\n                            || oldStyle.isImage !== newStyle.isImage) {\r\n                            return true;\r\n                        }\r\n                        if (oldStyle.src !== newStyle.src\r\n                            || oldStyle.imageAlign !== newStyle.imageAlign\r\n                            || oldStyle.imageHeight !== newStyle.imageHeight\r\n                            || oldStyle.imageWidth !== newStyle.imageWidth\r\n                            || oldStyle.imageOffset !== newStyle.imageOffset) {\r\n                            return true;\r\n                        }\r\n                    } else if (oldStyle.size || oldStyle.italic || oldStyle.isImage || oldStyle.outline) {\r\n                        return true;\r\n                    }\r\n                } else if (newStyle) {\r\n                    if (newStyle.size || newStyle.italic || newStyle.isImage || newStyle.outline) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    protected _addRichTextImageElement (richTextElement: IHtmlTextParserResultObj): void {\r\n        if (!richTextElement.style) {\r\n            return;\r\n        }\r\n\r\n        const style = richTextElement.style;\r\n        const spriteFrameName = style.src;\r\n        const spriteFrame = this._imageAtlas && spriteFrameName && this._imageAtlas.getSpriteFrame(spriteFrameName);\r\n        if (!spriteFrame) {\r\n            warnID(4400);\r\n        } else {\r\n            const segment = this._createImage(spriteFrame);\r\n            const uiTransform = segment.node._getUITransformComp()!;\r\n            switch (style.imageAlign) {\r\n            case 'top':\r\n                uiTransform.setAnchorPoint(0, 1);\r\n                break;\r\n            case 'center':\r\n                uiTransform.setAnchorPoint(0, 0.5);\r\n                break;\r\n            default:\r\n                uiTransform.setAnchorPoint(0, 0);\r\n                break;\r\n            }\r\n\r\n            if (style.imageOffset) {\r\n                segment.imageOffset = style.imageOffset;\r\n            }\r\n            segment.node.layer = this.node.layer;\r\n            this.node.insertChild(segment.node, this._labelChildrenNum++);\r\n            this._segments.push(segment);\r\n\r\n            const spriteRect = spriteFrame.rect.clone();\r\n            let scaleFactor = 1;\r\n            let spriteWidth = spriteRect.width;\r\n            let spriteHeight = spriteRect.height;\r\n            const expectWidth = style.imageWidth || 0;\r\n            const expectHeight = style.imageHeight || 0;\r\n\r\n            if (expectHeight > 0) {\r\n                scaleFactor = expectHeight / spriteHeight;\r\n                spriteWidth *= scaleFactor;\r\n                spriteHeight *= scaleFactor;\r\n            } else {\r\n                scaleFactor = this._lineHeight / spriteHeight;\r\n                spriteWidth *= scaleFactor;\r\n                spriteHeight *= scaleFactor;\r\n            }\r\n\r\n            if (expectWidth > 0) {\r\n                spriteWidth = expectWidth;\r\n            }\r\n\r\n            if (this._maxWidth > 0) {\r\n                if (this._lineOffsetX + spriteWidth > this._maxWidth) {\r\n                    this._updateLineInfo();\r\n                }\r\n                this._lineOffsetX += spriteWidth;\r\n            } else {\r\n                this._lineOffsetX += spriteWidth;\r\n                if (this._lineOffsetX > this._labelWidth) {\r\n                    this._labelWidth = this._lineOffsetX;\r\n                }\r\n            }\r\n            uiTransform.setContentSize(spriteWidth, spriteHeight);\r\n            segment.lineCount = this._lineCount;\r\n\r\n            segment.clickHandler = '';\r\n            segment.clickParam = '';\r\n            const event = style.event;\r\n            if (event) {\r\n                segment.clickHandler = event.click;\r\n                segment.clickParam = event.param;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected _updateTextDefaultColor (): void {\r\n        for (let i = 0; i < this._segments.length; ++i) {\r\n            const segment = this._segments[i];\r\n            const label = segment.node.getComponent(Label);\r\n            if (!label) {\r\n                continue;\r\n            }\r\n            if (this._textArray[segment.styleIndex]?.style?.color) {\r\n                continue;\r\n            }\r\n\r\n            label.color = this._fontColor;\r\n        }\r\n    }\r\n\r\n    protected _updateRichText (): void {\r\n        if (!this.enabledInHierarchy) {\r\n            return;\r\n        }\r\n\r\n        const newTextArray = _htmlTextParser.parse(this._string);\r\n        if (!this._needsUpdateTextLayout(newTextArray)) {\r\n            this._textArray = newTextArray.slice();\r\n            this._updateLabelSegmentTextAttributes();\r\n            return;\r\n        }\r\n\r\n        this._textArray = newTextArray.slice();\r\n        this._resetState();\r\n\r\n        let lastEmptyLine = false;\r\n        let label: ISegment;\r\n\r\n        for (let i = 0; i < this._textArray.length; ++i) {\r\n            const richTextElement = this._textArray[i];\r\n            let text = richTextElement.text;\r\n            if (text === undefined) {\r\n                continue;\r\n            }\r\n\r\n            // handle <br/> <img /> tag\r\n            if (text === '') {\r\n                if (richTextElement.style && richTextElement.style.isNewLine) {\r\n                    this._updateLineInfo();\r\n                    continue;\r\n                }\r\n                if (richTextElement.style && richTextElement.style.isImage && this._imageAtlas) {\r\n                    this._addRichTextImageElement(richTextElement);\r\n                    continue;\r\n                }\r\n            }\r\n\r\n            const splitArr: string[] = this.splitLongStringApproximatelyIn2048(text, i);\r\n            text = splitArr.join('\\n');\r\n\r\n            const multilineTexts = text.split('\\n');\r\n\r\n            for (let j = 0; j < multilineTexts.length; ++j) {\r\n                const labelString = multilineTexts[j];\r\n                if (labelString === '') {\r\n                    // for continues \\n\r\n                    if (this._isLastComponentCR(text) && j === multilineTexts.length - 1) {\r\n                        continue;\r\n                    }\r\n                    this._updateLineInfo();\r\n                    lastEmptyLine = true;\r\n                    continue;\r\n                }\r\n                lastEmptyLine = false;\r\n\r\n                if (this._maxWidth > 0) {\r\n                    const labelWidth = this._measureText(i, labelString) as number;\r\n                    this._updateRichTextWithMaxWidth(labelString, labelWidth, i);\r\n\r\n                    if (multilineTexts.length > 1 && j < multilineTexts.length - 1) {\r\n                        this._updateLineInfo();\r\n                    }\r\n                } else {\r\n                    label = this._addLabelSegment(labelString, i);\r\n\r\n                    this._lineOffsetX += label.node._getUITransformComp()!.width;\r\n                    if (this._lineOffsetX > this._labelWidth) {\r\n                        this._labelWidth = this._lineOffsetX;\r\n                    }\r\n\r\n                    if (multilineTexts.length > 1 && j < multilineTexts.length - 1) {\r\n                        this._updateLineInfo();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (!lastEmptyLine) {\r\n            this._linesWidth.push(this._lineOffsetX);\r\n        }\r\n\r\n        if (this._maxWidth > 0) {\r\n            this._labelWidth = this._maxWidth;\r\n        }\r\n        this._labelHeight = (this._lineCount + BASELINE_RATIO) * this._lineHeight;\r\n\r\n        // trigger \"size-changed\" event\r\n        this.node._getUITransformComp()!.setContentSize(this._labelWidth, this._labelHeight);\r\n\r\n        this._updateRichTextPosition();\r\n        this._layoutDirty = false;\r\n    }\r\n\r\n    protected _getFirstWordLen (text: string, startIndex: number, textLen: number): number {\r\n        let character = getSymbolAt(text, startIndex);\r\n        if (isUnicodeCJK(character) || isUnicodeSpace(character)) {\r\n            return 1;\r\n        }\r\n\r\n        let len = 1;\r\n        for (let index = startIndex + 1; index < textLen; ++index) {\r\n            character = getSymbolAt(text, index);\r\n            if (isUnicodeSpace(character) || isUnicodeCJK(character)) {\r\n                break;\r\n            }\r\n\r\n            len++;\r\n        }\r\n\r\n        return len;\r\n    }\r\n\r\n    protected _updateRichTextPosition (): void {\r\n        let nextTokenX = 0;\r\n        let nextLineIndex = 1;\r\n        const totalLineCount = this._lineCount;\r\n        const trans = this.node._getUITransformComp()!;\r\n        const anchorX = trans.anchorX;\r\n        const anchorY = trans.anchorY;\r\n        for (let i = 0; i < this._segments.length; ++i) {\r\n            const segment = this._segments[i];\r\n            const lineCount = segment.lineCount;\r\n            if (lineCount > nextLineIndex) {\r\n                nextTokenX = 0;\r\n                nextLineIndex = lineCount;\r\n            }\r\n\r\n            let lineOffsetX = this._labelWidth * (this._horizontalAlign * 0.5 - anchorX);\r\n            switch (this._horizontalAlign) {\r\n            case HorizontalTextAlignment.LEFT:\r\n                break;\r\n            case HorizontalTextAlignment.CENTER:\r\n                lineOffsetX -= this._linesWidth[lineCount - 1] / 2;\r\n                break;\r\n            case HorizontalTextAlignment.RIGHT:\r\n                lineOffsetX -= this._linesWidth[lineCount - 1];\r\n                break;\r\n            default:\r\n                break;\r\n            }\r\n\r\n            const segmentNode = segment.node;\r\n\r\n            const pos = segmentNode.position;\r\n            segmentNode.setPosition(\r\n                nextTokenX + lineOffsetX,\r\n                this._lineHeight * (totalLineCount - lineCount) - this._labelHeight * anchorY,\r\n                pos.z,\r\n            );\r\n\r\n            if (lineCount === nextLineIndex) {\r\n                nextTokenX += segmentNode._getUITransformComp()!.width;\r\n            }\r\n\r\n            const sprite = segmentNode.getComponent(Sprite);\r\n            if (sprite) {\r\n                const position = segmentNode.position.clone();\r\n                // adjust img align (from <img align=top|center|bottom>)\r\n                const lineHeightSet = this._lineHeight;\r\n                const lineHeightReal = this._lineHeight * (1 + BASELINE_RATIO); // single line node height\r\n                switch (segmentNode._getUITransformComp()!.anchorY) {\r\n                case 1:\r\n                    position.y += (lineHeightSet + ((lineHeightReal - lineHeightSet) / 2));\r\n                    break;\r\n                case 0.5:\r\n                    position.y += (lineHeightReal / 2);\r\n                    break;\r\n                default:\r\n                    position.y += ((lineHeightReal - lineHeightSet) / 2);\r\n                    break;\r\n                }\r\n                // adjust img offset (from <img offset=12|12,34>)\r\n                if (segment.imageOffset) {\r\n                    const offsets = segment.imageOffset.split(',');\r\n                    if (offsets.length === 1 && offsets[0]) {\r\n                        const offsetY = parseFloat(offsets[0]);\r\n                        if (Number.isInteger(offsetY)) position.y += offsetY;\r\n                    } else if (offsets.length === 2) {\r\n                        const offsetX = parseFloat(offsets[0]);\r\n                        const offsetY = parseFloat(offsets[1]);\r\n                        if (Number.isInteger(offsetX)) position.x += offsetX;\r\n                        if (Number.isInteger(offsetY)) position.y += offsetY;\r\n                    }\r\n                }\r\n                segmentNode.position = position;\r\n            }\r\n\r\n            // adjust y for label with outline\r\n            const label = segmentNode.getComponent(Label);\r\n            if (label && label.enableOutline) {\r\n                const position = segmentNode.position.clone();\r\n                position.y -= label.outlineWidth;\r\n                segmentNode.position = position;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected _convertLiteralColorValue (color: string): Color {\r\n        const colorValue = color.toUpperCase();\r\n        if (Color[colorValue]) {\r\n            const colorUse: Color = Color[colorValue];\r\n            return colorUse;\r\n        } else {\r\n            const out = new Color();\r\n            return out.fromHEX(color);\r\n        }\r\n    }\r\n\r\n    protected _applyTextAttribute (labelSeg: ISegment): void {\r\n        const label = labelSeg.node.getComponent(Label);\r\n        if (!label) {\r\n            return;\r\n        }\r\n        this._resetLabelState(label);\r\n\r\n        const index = labelSeg.styleIndex;\r\n\r\n        let textStyle: IHtmlTextParserStack | undefined;\r\n        if (this._textArray[index]) {\r\n            textStyle = this._textArray[index].style;\r\n        }\r\n\r\n        if (textStyle) {\r\n            if (textStyle.color) {\r\n                label.color = this._convertLiteralColorValue(textStyle.color);\r\n            } else {\r\n                label.color = this._fontColor;\r\n            }\r\n            label.isBold = !!textStyle.bold;\r\n            label.isItalic = !!textStyle.italic;\r\n            // TODO: temporary implementation, the italic effect should be implemented in the internal of label-assembler.\r\n            // if (textStyle.italic) {\r\n            //     labelNode.skewX = 12;\r\n            // }\r\n\r\n            label.isUnderline = !!textStyle.underline;\r\n            if (textStyle.outline) {\r\n                label.enableOutline = true;\r\n                label.outlineColor = this._convertLiteralColorValue(textStyle.outline.color);\r\n                label.outlineWidth = textStyle.outline.width;\r\n            }\r\n\r\n            label.fontSize = textStyle.size || this._fontSize;\r\n\r\n            labelSeg.clickHandler = '';\r\n            labelSeg.clickParam = '';\r\n            const event = textStyle.event;\r\n            if (event) {\r\n                labelSeg.clickHandler = event.click || '';\r\n                labelSeg.clickParam = event.param || '';\r\n            }\r\n        }\r\n\r\n        label.cacheMode = this._cacheMode;\r\n\r\n        const isAsset = this._font instanceof Font;\r\n        if (isAsset && !this._isSystemFontUsed) {\r\n            label.font = this._font;\r\n        } else {\r\n            label.fontFamily = this._fontFamily;\r\n        }\r\n        label.useSystemFont = this._isSystemFontUsed;\r\n        label.lineHeight = this._lineHeight;\r\n\r\n        label.updateRenderData(true);\r\n    }\r\n\r\n    protected _applyLayer (): void {\r\n        this._segments.forEach((seg) => {\r\n            seg.node.layer = this.node.layer;\r\n        });\r\n    }\r\n\r\n    protected _resetLabelState (label: Label): void {\r\n        label.fontSize = this._fontSize;\r\n        label.color = this._fontColor;\r\n        label.isBold = false;\r\n        label.isItalic = false;\r\n        label.isUnderline = false;\r\n    }\r\n}\r\n\r\ncclegacy.RichText = RichText;\r\n"],"names":["_htmlTextParser","HtmlTextParser","RichTextChildName","RichTextChildImageName","_tempSize","Vec2","_tempSizeLeft","labelPool","js","seg","assert","node","parent","cclegacy","isValid","label","getComponent","Label","outlineWidth","imagePool","createSegment","type","Node","comp","lineCount","styleIndex","imageOffset","clickParam","clickHandler","getSegmentByPool","content","_get","hideFlags","CCObjectFlags","DontSave","HideInHierarchy","active","Sprite","addComponent","spriteFrame","Type","SLICED","sizeMode","SizeMode","CUSTOM","string","horizontalAlign","HorizontalTextAlignment","LEFT","verticalAlign","VerticalTextAlignment","TOP","underlineHeight","setPosition","trans","_getUITransformComp","setAnchorPoint","RichText","_dec","ccclass","_dec2","requireComponent","UITransform","_dec3","executionOrder","_dec4","_dec5","_dec6","Color","_dec7","Font","_dec8","CacheMode","_dec9","SpriteAtlas","_class","_class2","_RichText","_Component","_this","call","_lineHeight","_initializer","_string","_initializer2","_horizontalAlign","_initializer3","_verticalAlign","_initializer4","_fontSize","_initializer5","_fontColor","_initializer6","_maxWidth","_initializer7","_fontFamily","_initializer8","_font","_initializer9","_isSystemFontUsed","_initializer0","_userDefinedFont","_initializer1","_cacheMode","_initializer10","_imageAtlas","_initializer11","_handleTouchEvent","_initializer12","_textArray","_segments","_labelSegmentsCache","_linesWidth","_lineCount","_labelWidth","_labelHeight","_layoutDirty","_lineOffsetX","_labelChildrenNum","_updateRichTextStatus","_updateRichText","_inheritsLoose","_proto","prototype","onLoad","on","NodeEventType","LAYER_CHANGED","_applyLayer","ANCHOR_CHANGED","_updateRichTextPosition","onEnable","handleTouchEvent","_addEventListeners","_activateChildren","onDisable","_removeEventListeners","onRestore","onDestroy","forEach","removeFromParent","put","off","TOUCH_END","_onTouchEnded","_updateLabelSegmentTextAttributes","_this2","item","_applyTextAttribute","_createFontLabel","str","_createImage","_onTTFLoaded","TTFFont","splitLongStringApproximatelyIn2048","text","approxSize","length","fontSize","partStringArr","push","_calculateSize","x","multilineTexts","split","i","thisPartSplitResultArr","splitLongStringOver2048","apply","longStr","curStart","curEnd","curString","substring","leftString","curStringSize","leftStringSize","maxWidth","lineCountForOnePart","sizeForOnePart","leftTryTimes","curWordStep","nextPartExec","getEnglishWordPartAtFirst","lastWordExec","getEnglishWordPartAtLast","partStep","_measureText","_this3","func","s","width","out","size","contentSize","set","y","event","_this4","components","getComponents","Component","_containsTouchLocation","touch","getUILocation","component","enabledInHierarchy","propagationStopped","point","myRect","getBoundingBoxToWorld","contains","_resetState","children","child","name","segment","_addLabelSegment","stringToken","labelSegment","pop","labelComp","layer","insertChild","_updateRichTextWithMaxWidth","labelString","labelWidth","fragmentWidth","checkStartIndex","checkEndIndex","_getFirstWordLen","checkString","substr","checkStringWidth","remainingString","_updateLineInfo","fragments","fragmentText","k","splitString","labelSize","_isLastComponentCR","lastIndexOf","_needsUpdateTextLayout","newTextArray","oldItem","newItem","oldStyle","style","newStyle","outline","italic","isImage","src","imageAlign","imageHeight","imageWidth","_addRichTextImageElement","richTextElement","spriteFrameName","getSpriteFrame","warnID","uiTransform","spriteRect","rect","clone","scaleFactor","spriteWidth","spriteHeight","height","expectWidth","expectHeight","setContentSize","click","param","_updateTextDefaultColor","_this$_textArray$segm","_this$_textArray$segm2","color","parse","slice","lastEmptyLine","undefined","isNewLine","splitArr","join","j","BASELINE_RATIO","startIndex","textLen","character","getSymbolAt","isUnicodeCJK","isUnicodeSpace","len","index","nextTokenX","nextLineIndex","totalLineCount","anchorX","anchorY","lineOffsetX","CENTER","RIGHT","segmentNode","pos","position","z","sprite","lineHeightSet","lineHeightReal","offsets","offsetY","parseFloat","Number","isInteger","offsetX","enableOutline","_convertLiteralColorValue","colorValue","toUpperCase","colorUse","fromHEX","labelSeg","_resetLabelState","textStyle","isBold","bold","isItalic","isUnderline","underline","outlineColor","cacheMode","isAsset","font","fontFamily","useSystemFont","lineHeight","updateRenderData","_this5","_createClass","key","get","value","HorizontalAlign","VerticalAlign","_applyDecoratedDescriptor","Object","getOwnPropertyDescriptor","_applyDecoratedInitializer","serializable","WHITE","NONE"],"mappings":"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"}