{"version":3,"file":"physics-2d-box2d.js","sources":["../../../cocos/physics-2d/box2d/platform/physics-contact-listener.ts","../../../cocos/physics-2d/box2d/platform/physics-aabb-query-callback.ts","../../../cocos/physics-2d/box2d/platform/physics-ray-cast-callback.ts","../../../cocos/physics-2d/box2d/physics-contact.ts","../../../cocos/physics-2d/box2d/platform/physics-debug-draw.ts","../../../cocos/physics-2d/box2d/physics-world.ts","../../../cocos/physics-2d/box2d/rigid-body.ts","../../../cocos/physics-2d/box2d/shapes/shape-2d.ts","../../../cocos/physics-2d/box2d/shapes/box-shape-2d.ts","../../../cocos/physics-2d/box2d/shapes/circle-shape-2d.ts","../../../cocos/physics-2d/box2d/shapes/polygon-shape-2d.ts","../../../cocos/physics-2d/box2d/joints/joint-2d.ts","../../../cocos/physics-2d/box2d/joints/mouse-joint.ts","../../../cocos/physics-2d/box2d/joints/distance-joint.ts","../../../cocos/physics-2d/box2d/joints/spring-joint.ts","../../../cocos/physics-2d/box2d/joints/relative-joint.ts","../../../cocos/physics-2d/box2d/joints/slider-joint.ts","../../../cocos/physics-2d/box2d/joints/fixed-joint.ts","../../../cocos/physics-2d/box2d/joints/wheel-joint.ts","../../../cocos/physics-2d/box2d/joints/hinge-joint.ts","../../../cocos/physics-2d/box2d/instantiate.ts"],"sourcesContent":["/*\r\n Copyright (c) 2017-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { js } from '../../../core';\r\nimport type { b2ContactExtends } from '../physics-contact';\r\n\r\ntype BeginContactCallback = (contact: b2ContactExtends) => void;\r\ntype EndContactCallback = (contact: b2ContactExtends) => void;\r\ntype PreSolveCallback = (contact: b2ContactExtends, oldManifold: b2.Manifold) => void;\r\ntype PostSolveCallback = (contact: b2ContactExtends, impulse: b2.ContactImpulse) => void;\r\n\r\n/** @mangle */\r\nexport class PhysicsContactListener extends b2.ContactListener {\r\n    _contactFixtures: b2.Fixture[] = [];\r\n\r\n    _BeginContact: BeginContactCallback | null = null;\r\n    _EndContact: EndContactCallback | null = null;\r\n    _PreSolve: PreSolveCallback | null = null;\r\n    _PostSolve: PostSolveCallback | null = null;\r\n\r\n    setBeginContact (cb: BeginContactCallback): void {\r\n        this._BeginContact = cb;\r\n    }\r\n\r\n    setEndContact (cb: EndContactCallback): void {\r\n        this._EndContact = cb;\r\n    }\r\n\r\n    setPreSolve (cb: PreSolveCallback): void {\r\n        this._PreSolve = cb;\r\n    }\r\n\r\n    setPostSolve (cb: PostSolveCallback): void {\r\n        this._PostSolve = cb;\r\n    }\r\n\r\n    BeginContact (contact: b2ContactExtends): void {\r\n        if (!this._BeginContact) return;\r\n\r\n        const fixtureA = contact.GetFixtureA();\r\n        const fixtureB = contact.GetFixtureB();\r\n        const fixtures = this._contactFixtures;\r\n\r\n        (contact as any)._shouldReport = false;\r\n\r\n        if (fixtures.indexOf(fixtureA) !== -1 || fixtures.indexOf(fixtureB) !== -1) {\r\n            (contact as any)._shouldReport = true; // for quick check whether this contact should report\r\n            this._BeginContact(contact);\r\n        }\r\n    }\r\n\r\n    EndContact (contact: b2ContactExtends): void {\r\n        if (this._EndContact && (contact as any)._shouldReport) {\r\n            (contact as any)._shouldReport = false;\r\n            this._EndContact(contact);\r\n        }\r\n    }\r\n\r\n    PreSolve (contact: b2ContactExtends, oldManifold: b2.Manifold): void {\r\n        if (this._PreSolve && (contact as any)._shouldReport) {\r\n            this._PreSolve(contact, oldManifold);\r\n        }\r\n    }\r\n\r\n    PostSolve (contact: b2ContactExtends, impulse: b2.ContactImpulse): void {\r\n        if (this._PostSolve && (contact as any)._shouldReport) {\r\n            this._PostSolve(contact, impulse);\r\n        }\r\n    }\r\n\r\n    registerContactFixture (fixture: b2.Fixture): void {\r\n        this._contactFixtures.push(fixture);\r\n    }\r\n\r\n    unregisterContactFixture (fixture: b2.Fixture): void {\r\n        js.array.remove(this._contactFixtures, fixture);\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2017-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { Vec2 } from '../../../core';\r\n\r\n/** @mangle */\r\nexport class PhysicsAABBQueryCallback extends b2.QueryCallback {\r\n    _point = new b2.Vec2();\r\n    _isPoint = false;\r\n    _fixtures: b2.Fixture[] = [];\r\n\r\n    init (point?: Vec2): void {\r\n        if (point) {\r\n            this._isPoint = true;\r\n            this._point.x = point.x;\r\n            this._point.y = point.y;\r\n        } else {\r\n            this._isPoint = false;\r\n        }\r\n\r\n        this._fixtures.length = 0;\r\n    }\r\n\r\n    ReportFixture (fixture: b2.Fixture): boolean {\r\n        if (this._isPoint) {\r\n            if (fixture.TestPoint(this._point)) {\r\n                this._fixtures.push(fixture);\r\n            }\r\n        } else {\r\n            this._fixtures.push(fixture);\r\n        }\r\n\r\n        // True to continue the query, false to terminate the query.\r\n        return true;\r\n    }\r\n\r\n    getFixture (): any {\r\n        return this._fixtures[0];\r\n    }\r\n\r\n    getFixtures (): any[] {\r\n        return this._fixtures;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2017-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { Vec2 } from '../../../core';\r\nimport { ERaycast2DType } from '../../framework';\r\n\r\n/** @mangle */\r\nexport class PhysicsRayCastCallback extends b2.RayCastCallback {\r\n    _type = ERaycast2DType.Closest;\r\n    _fixtures: b2.Fixture[] = [];\r\n    _points: Vec2[] = [];\r\n    _normals: Vec2[] = [];\r\n    _fractions: number[] = [];\r\n\r\n    _mask = 0xffffffff;\r\n\r\n    init (type: ERaycast2DType, mask: number): void {\r\n        this._type = type;\r\n        this._mask = mask;\r\n        this._fixtures.length = 0;\r\n        this._points.length = 0;\r\n        this._normals.length = 0;\r\n        this._fractions.length = 0;\r\n    }\r\n\r\n    ReportFixture (fixture: b2.Fixture, point: B2.Vec2, normal: B2.Vec2, fraction: number): number {\r\n        if ((fixture.GetFilterData().categoryBits & this._mask) === 0) {\r\n            return -1;\r\n        }\r\n\r\n        if (this._type === ERaycast2DType.Closest) {\r\n            this._fixtures[0] = fixture;\r\n            this._points[0] = point as Vec2;\r\n            this._normals[0] = normal as Vec2;\r\n            this._fractions[0] = fraction;\r\n            return fraction;\r\n        }\r\n\r\n        this._fixtures.push(fixture);\r\n        this._points.push(new Vec2(point.x, point.y));\r\n        this._normals.push(new Vec2(normal.x, normal.y));\r\n        this._fractions.push(fraction);\r\n\r\n        if (this._type === ERaycast2DType.Any) {\r\n            return 0;\r\n        } else if (this._type >= ERaycast2DType.All) {\r\n            return 1;\r\n        }\r\n\r\n        return fraction;\r\n    }\r\n\r\n    getFixtures (): any[] {\r\n        return this._fixtures;\r\n    }\r\n\r\n    getPoints (): Vec2[] {\r\n        return this._points;\r\n    }\r\n\r\n    getNormals (): Vec2[] {\r\n        return this._normals;\r\n    }\r\n\r\n    getFractions (): number[] {\r\n        return this._fractions;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2017-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { Vec2 } from '../../core';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../framework/physics-types';\r\nimport { Collider2D, Contact2DType, PhysicsSystem2D } from '../framework';\r\nimport { b2Shape2D } from './shapes/shape-2d';\r\nimport { IPhysics2DContact, IPhysics2DImpulse, IPhysics2DManifoldPoint, IPhysics2DWorldManifold } from '../spec/i-physics-contact';\r\n\r\nexport type b2ContactExtends = b2.Contact & {\r\n    m_userData: any;\r\n}\r\n\r\nconst pools: PhysicsContact[] = [];\r\n\r\n// temp world manifold\r\nconst pointCache = [new Vec2(), new Vec2()];\r\n\r\nconst b2worldmanifold = new b2.WorldManifold();\r\n\r\nconst worldmanifold: IPhysics2DWorldManifold = {\r\n    points: [] as Vec2[],\r\n    separations: [] as number[],\r\n    normal: new Vec2(),\r\n};\r\n\r\nclass ManifoldPoint implements IPhysics2DManifoldPoint {\r\n    localPoint = new Vec2();\r\n    normalImpulse = 0;\r\n    tangentImpulse = 0;\r\n}\r\n\r\nconst manifoldPointCache = [new ManifoldPoint(), new ManifoldPoint()];\r\n\r\nconst manifold = {\r\n    type: 0,\r\n    localPoint: new Vec2(),\r\n    localNormal: new Vec2(),\r\n    points: [] as ManifoldPoint[],\r\n};\r\n\r\nconst impulse: IPhysics2DImpulse = {\r\n    normalImpulses: [] as number[],\r\n    tangentImpulses: [] as number[],\r\n};\r\n\r\n/** @mangle */\r\nexport class PhysicsContact implements IPhysics2DContact {\r\n    static get (b2contact: b2ContactExtends): PhysicsContact {\r\n        let c = pools.pop();\r\n\r\n        if (!c) {\r\n            c = new PhysicsContact();\r\n        }\r\n\r\n        c.init(b2contact);\r\n        return c;\r\n    }\r\n\r\n    static put (b2contact: b2ContactExtends): void {\r\n        const c: PhysicsContact = b2contact.m_userData as PhysicsContact;\r\n        if (!c) return;\r\n\r\n        pools.push(c);\r\n        c.reset();\r\n    }\r\n\r\n    colliderA: Collider2D | null = null;\r\n    colliderB: Collider2D | null = null;\r\n\r\n    disabled = false;\r\n    disabledOnce = false;\r\n\r\n    private _impulse: b2.ContactImpulse | null = null;\r\n    private _inverted = false;\r\n    private _b2contact: b2ContactExtends | null = null;\r\n\r\n    _setImpulse (impulse: b2.ContactImpulse | null): void {\r\n        this._impulse = impulse;\r\n    }\r\n\r\n    init (b2contact: b2ContactExtends): void {\r\n        this.colliderA = (b2contact.m_fixtureA.m_userData as b2Shape2D).collider;\r\n        this.colliderB = (b2contact.m_fixtureB.m_userData as b2Shape2D).collider;\r\n        this.disabled = false;\r\n        this.disabledOnce = false;\r\n        this._impulse = null;\r\n\r\n        this._inverted = false;\r\n\r\n        this._b2contact = b2contact;\r\n        b2contact.m_userData = this;\r\n    }\r\n\r\n    reset (): void {\r\n        this.setTangentSpeed(0);\r\n        this.resetFriction();\r\n        this.resetRestitution();\r\n\r\n        this.colliderA = null;\r\n        this.colliderB = null;\r\n        this.disabled = false;\r\n        this._impulse = null;\r\n\r\n        this._b2contact!.m_userData = null;\r\n        this._b2contact = null;\r\n    }\r\n\r\n    getWorldManifold (): IPhysics2DWorldManifold {\r\n        const points = worldmanifold.points;\r\n        const separations = worldmanifold.separations;\r\n        const normal = worldmanifold.normal;\r\n\r\n        this._b2contact!.GetWorldManifold(b2worldmanifold);\r\n        const b2points = b2worldmanifold.points;\r\n        const b2separations = b2worldmanifold.separations;\r\n\r\n        const count = this._b2contact!.GetManifold().pointCount;\r\n        points.length = separations.length = count;\r\n\r\n        for (let i = 0; i < count; i++) {\r\n            const p = pointCache[i];\r\n            p.x = b2points[i].x * PHYSICS_2D_PTM_RATIO;\r\n            p.y = b2points[i].y * PHYSICS_2D_PTM_RATIO;\r\n\r\n            points[i] = p;\r\n            separations[i] = b2separations[i] * PHYSICS_2D_PTM_RATIO;\r\n        }\r\n\r\n        normal.x = b2worldmanifold.normal.x;\r\n        normal.y = b2worldmanifold.normal.y;\r\n\r\n        if (this._inverted) {\r\n            normal.x *= -1;\r\n            normal.y *= -1;\r\n        }\r\n\r\n        return worldmanifold;\r\n    }\r\n\r\n    getManifold (): { type: number; localPoint: Vec2; localNormal: Vec2; points: ManifoldPoint[]; } {\r\n        const points = manifold.points;\r\n        const localNormal = manifold.localNormal;\r\n        const localPoint = manifold.localPoint;\r\n\r\n        const b2manifold = this._b2contact!.GetManifold();\r\n        const b2points = b2manifold.points;\r\n        const count = points.length = b2manifold.pointCount;\r\n\r\n        for (let i = 0; i < count; i++) {\r\n            const p = manifoldPointCache[i];\r\n            const b2p = b2points[i];\r\n            p.localPoint.x = b2p.localPoint.x * PHYSICS_2D_PTM_RATIO;\r\n            p.localPoint.y = b2p.localPoint.y * PHYSICS_2D_PTM_RATIO;\r\n            p.normalImpulse = b2p.normalImpulse * PHYSICS_2D_PTM_RATIO;\r\n            p.tangentImpulse = b2p.tangentImpulse;\r\n\r\n            points[i] = p;\r\n        }\r\n\r\n        localPoint.x = b2manifold.localPoint.x * PHYSICS_2D_PTM_RATIO;\r\n        localPoint.y = b2manifold.localPoint.y * PHYSICS_2D_PTM_RATIO;\r\n        localNormal.x = b2manifold.localNormal.x;\r\n        localNormal.y = b2manifold.localNormal.y;\r\n        manifold.type = b2manifold.type;\r\n\r\n        if (this._inverted) {\r\n            localNormal.x *= -1;\r\n            localNormal.y *= -1;\r\n        }\r\n\r\n        return manifold;\r\n    }\r\n\r\n    getImpulse (): IPhysics2DImpulse | null {\r\n        const b2impulse = this._impulse;\r\n        if (!b2impulse) return null;\r\n\r\n        const normalImpulses = impulse.normalImpulses;\r\n        const tangentImpulses = impulse.tangentImpulses;\r\n        const count = b2impulse.count;\r\n        for (let i = 0; i < count; i++) {\r\n            normalImpulses[i] = b2impulse.normalImpulses[i] * PHYSICS_2D_PTM_RATIO;\r\n            tangentImpulses[i] = b2impulse.tangentImpulses[i];\r\n        }\r\n\r\n        tangentImpulses.length = normalImpulses.length = count;\r\n\r\n        return impulse;\r\n    }\r\n\r\n    emit (contactType: string): void {\r\n        const colliderA = this.colliderA;\r\n        const colliderB = this.colliderB;\r\n\r\n        const hasListenerA = colliderA?.body?.enabledContactListener;\r\n        const hasListenerB = colliderB?.body?.enabledContactListener;\r\n\r\n        if (hasListenerA) {\r\n            colliderA.emit(contactType, colliderA, colliderB, this);\r\n        }\r\n\r\n        if (hasListenerB) {\r\n            colliderB.emit(contactType, colliderB, colliderA, this);\r\n        }\r\n\r\n        if (hasListenerA || hasListenerB) {\r\n            PhysicsSystem2D.instance.emit(contactType, colliderA, colliderB, this);\r\n        }\r\n\r\n        if (this.disabled || this.disabledOnce) {\r\n            this.setEnabled(false);\r\n            this.disabledOnce = false;\r\n        }\r\n    }\r\n\r\n    setEnabled (value: boolean): void {\r\n        this._b2contact!.SetEnabled(value);\r\n    }\r\n\r\n    isTouching (): boolean {\r\n        return this._b2contact!.IsTouching();\r\n    }\r\n\r\n    setTangentSpeed (value: number): void {\r\n        this._b2contact!.SetTangentSpeed(value);\r\n    }\r\n\r\n    getTangentSpeed (): number {\r\n        return this._b2contact!.GetTangentSpeed();\r\n    }\r\n\r\n    setFriction (value: number): void {\r\n        this._b2contact!.SetFriction(value);\r\n    }\r\n\r\n    getFriction (): number {\r\n        return this._b2contact!.GetFriction();\r\n    }\r\n\r\n    resetFriction (): void {\r\n        return this._b2contact!.ResetFriction();\r\n    }\r\n\r\n    setRestitution (value: number): void {\r\n        this._b2contact!.SetRestitution(value);\r\n    }\r\n\r\n    getRestitution (): number {\r\n        return this._b2contact!.GetRestitution();\r\n    }\r\n\r\n    resetRestitution (): void {\r\n        return this._b2contact!.ResetRestitution();\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2017-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2, { Vec2 } from '@cocos/box2d';\r\nimport { Color } from '../../../core';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework';\r\nimport type { Graphics } from '../../../2d/components/graphics';\r\n\r\nconst _tmp_vec2 = new b2.Vec2();\r\nconst _tmp_color = new Color();\r\n\r\nconst GREEN_COLOR = Color.GREEN;\r\nconst RED_COLOR = Color.RED;\r\n\r\n/** @mangle */\r\nexport class PhysicsDebugDraw extends b2.Draw {\r\n    _drawer: Graphics | null = null;\r\n\r\n    _xf = new b2.Transform();\r\n    _dxf = new b2.Transform();\r\n\r\n    constructor (drawer: Graphics) {\r\n        super();\r\n        this._drawer = drawer;\r\n    }\r\n\r\n    _DrawPolygon (vertices: Vec2[], vertexCount: number): void {\r\n        const drawer = this._drawer!;\r\n\r\n        for (let i = 0; i < vertexCount; i++) {\r\n            b2.Transform.MulXV(this._xf, vertices[i], _tmp_vec2);\r\n            const x = _tmp_vec2.x * PHYSICS_2D_PTM_RATIO;\r\n            const y = _tmp_vec2.y * PHYSICS_2D_PTM_RATIO;\r\n            if (i === 0) drawer.moveTo(x, y);\r\n            else {\r\n                drawer.lineTo(x, y);\r\n            }\r\n        }\r\n\r\n        drawer.close();\r\n    }\r\n\r\n    DrawPolygon (vertices: Vec2[], vertexCount: number, color: Color): void {\r\n        this._applyStrokeColor(color);\r\n        this._DrawPolygon(vertices, vertexCount);\r\n        this._drawer!.stroke();\r\n    }\r\n\r\n    DrawSolidPolygon (vertices: Vec2[], vertexCount: number, color: Color): void {\r\n        this._applyFillColor(color);\r\n        this._DrawPolygon(vertices, vertexCount);\r\n        this._drawer!.fill();\r\n        this._drawer!.stroke();\r\n    }\r\n\r\n    _DrawCircle (center: b2.Vec2, radius: number): void {\r\n        b2.Transform.MulXV(this._xf, center, _tmp_vec2);\r\n        //scale?\r\n        this._drawer!.circle((_tmp_vec2.x) * PHYSICS_2D_PTM_RATIO, (_tmp_vec2.y) * PHYSICS_2D_PTM_RATIO, radius * PHYSICS_2D_PTM_RATIO);\r\n    }\r\n\r\n    DrawCircle (center: b2.Vec2, radius: number, color): void {\r\n        this._applyStrokeColor(color);\r\n        this._DrawCircle(center, radius);\r\n        this._drawer!.stroke();\r\n    }\r\n\r\n    DrawSolidCircle (center: b2.Vec2, radius: number, axis, color): void {\r\n        this._applyFillColor(color);\r\n        this._DrawCircle(center, radius);\r\n        this._drawer!.fill();\r\n    }\r\n\r\n    DrawSegment (p1: b2.Vec2, p2: b2.Vec2, color): void {\r\n        const drawer = this._drawer!;\r\n\r\n        if (p1.x === p2.x && p1.y === p2.y) {\r\n            this._applyFillColor(color);\r\n            this._DrawCircle(p1, 2 / PHYSICS_2D_PTM_RATIO);\r\n            drawer.fill();\r\n            return;\r\n        }\r\n        this._applyStrokeColor(color);\r\n\r\n        b2.Transform.MulXV(this._xf, p1, _tmp_vec2);\r\n        drawer.moveTo(_tmp_vec2.x * PHYSICS_2D_PTM_RATIO, _tmp_vec2.y * PHYSICS_2D_PTM_RATIO);\r\n        b2.Transform.MulXV(this._xf, p2, _tmp_vec2);\r\n        drawer.lineTo(_tmp_vec2.x * PHYSICS_2D_PTM_RATIO, _tmp_vec2.y * PHYSICS_2D_PTM_RATIO);\r\n        drawer.stroke();\r\n    }\r\n\r\n    DrawTransform (xf: b2.Transform): void {\r\n        const drawer = this._drawer!;\r\n\r\n        drawer.strokeColor = RED_COLOR;\r\n\r\n        _tmp_vec2.x = _tmp_vec2.y = 0;\r\n        b2.Transform.MulXV(xf, _tmp_vec2, _tmp_vec2);\r\n        drawer.moveTo(_tmp_vec2.x * PHYSICS_2D_PTM_RATIO, _tmp_vec2.y * PHYSICS_2D_PTM_RATIO);\r\n\r\n        _tmp_vec2.x = 1; _tmp_vec2.y = 0;\r\n        b2.Transform.MulXV(xf, _tmp_vec2, _tmp_vec2);\r\n        drawer.lineTo(_tmp_vec2.x * PHYSICS_2D_PTM_RATIO, _tmp_vec2.y * PHYSICS_2D_PTM_RATIO);\r\n\r\n        drawer.stroke();\r\n\r\n        drawer.strokeColor = GREEN_COLOR;\r\n\r\n        _tmp_vec2.x = _tmp_vec2.y = 0;\r\n        b2.Transform.MulXV(xf, _tmp_vec2, _tmp_vec2);\r\n        drawer.moveTo(_tmp_vec2.x * PHYSICS_2D_PTM_RATIO, _tmp_vec2.y * PHYSICS_2D_PTM_RATIO);\r\n\r\n        _tmp_vec2.x = 0; _tmp_vec2.y = 1;\r\n        b2.Transform.MulXV(xf, _tmp_vec2, _tmp_vec2);\r\n        drawer.lineTo(_tmp_vec2.x * PHYSICS_2D_PTM_RATIO, _tmp_vec2.y * PHYSICS_2D_PTM_RATIO);\r\n\r\n        drawer.stroke();\r\n    }\r\n\r\n    DrawPoint (center, radius, color): void {\r\n        //empty\r\n    }\r\n\r\n    DrawParticles (): void {\r\n        //empty\r\n    }\r\n\r\n    _applyStrokeColor (color): void {\r\n        this._drawer!.strokeColor = _tmp_color.set(\r\n            color.r * 255,\r\n            color.g * 255,\r\n            color.b * 255,\r\n            150,\r\n        );\r\n    }\r\n\r\n    _applyFillColor (color): void {\r\n        this._drawer!.fillColor = _tmp_color.set(\r\n            color.r * 255,\r\n            color.g * 255,\r\n            color.b * 255,\r\n            150,\r\n        );\r\n    }\r\n\r\n    PushTransform (xf): void {\r\n        this._xf = xf;\r\n    }\r\n\r\n    PopTransform (): void {\r\n        this._xf = this._dxf;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { EDITOR_NOT_IN_PREVIEW, TEST } from 'internal:constants';\r\n\r\nimport { IPhysicsWorld } from '../spec/i-physics-world';\r\nimport { IVec2Like, Vec3, Quat, Vec2, toDegree, Rect, CCObjectFlags, js, errorID } from '../../core';\r\nimport { PHYSICS_2D_PTM_RATIO, ERaycast2DType, ERigidBody2DType } from '../framework/physics-types';\r\nimport { b2RigidBody2D } from './rigid-body';\r\nimport { PhysicsContactListener } from './platform/physics-contact-listener';\r\nimport { PhysicsAABBQueryCallback } from './platform/physics-aabb-query-callback';\r\nimport { PhysicsRayCastCallback } from './platform/physics-ray-cast-callback';\r\nimport { PhysicsContact, b2ContactExtends } from './physics-contact';\r\nimport { Contact2DType, Collider2D, RaycastResult2D } from '../framework';\r\nimport { b2Shape2D } from './shapes/shape-2d';\r\nimport { PhysicsDebugDraw } from './platform/physics-debug-draw';\r\nimport { Node, find, Layers } from '../../scene-graph';\r\nimport { director } from '../../game';\r\nimport type { Graphics } from '../../2d/components/graphics';\r\n\r\nconst tempVec3 = new Vec3();\r\nconst tempVec2_1 = new Vec2();\r\nconst tempVec2_2 = new Vec2();\r\n\r\nconst temoBodyDef = new b2.BodyDef();\r\nconst tempB2AABB = new b2.AABB();\r\n\r\nconst testResults: Collider2D[] = [];\r\n\r\n/** @mangle */\r\nexport class b2PhysicsWorld implements IPhysicsWorld {\r\n    protected _world: b2.World;\r\n    protected _bodies: b2RigidBody2D[] = [];\r\n    protected _animatedBodies: b2RigidBody2D[] = [];\r\n    protected _rotationAxis: Vec3 = new Vec3();\r\n    protected _physicsGroundBody: b2.Body;\r\n\r\n    protected _contactListener: PhysicsContactListener;\r\n    protected _aabbQueryCallback: PhysicsAABBQueryCallback;\r\n    protected _raycastQueryCallback: PhysicsRayCastCallback;\r\n\r\n    get impl (): b2.World {\r\n        return this._world;\r\n    }\r\n\r\n    get groundBodyImpl (): b2.Body {\r\n        return this._physicsGroundBody;\r\n    }\r\n\r\n    constructor () {\r\n        this._world = new b2.World(new b2.Vec2(0, -10));\r\n        const tempBodyDef = new b2.BodyDef();\r\n        //tempBodyDef.position.Set(480 / PHYSICS_2D_PTM_RATIO, 320 / PHYSICS_2D_PTM_RATIO);//temporary\r\n        this._physicsGroundBody = this._world.CreateBody(tempBodyDef);\r\n        const listener = new PhysicsContactListener();\r\n        listener.setBeginContact(this._onBeginContact);\r\n        listener.setEndContact(this._onEndContact);\r\n        listener.setPreSolve(this._onPreSolve);\r\n        listener.setPostSolve(this._onPostSolve);\r\n        this._world.SetContactListener(listener);\r\n\r\n        this._contactListener = listener;\r\n\r\n        this._aabbQueryCallback = new PhysicsAABBQueryCallback();\r\n        this._raycastQueryCallback = new PhysicsRayCastCallback();\r\n    }\r\n\r\n    _debugGraphics: Graphics | null = null;\r\n    _b2DebugDrawer: b2.Draw | null = null;\r\n\r\n    _debugDrawFlags = 0;\r\n    get debugDrawFlags (): number {\r\n        return this._debugDrawFlags;\r\n    }\r\n    set debugDrawFlags (v) {\r\n        if (EDITOR_NOT_IN_PREVIEW) return;\r\n\r\n        if (!v) {\r\n            if (this._debugGraphics) {\r\n                this._debugGraphics.node.parent = null;\r\n            }\r\n        }\r\n\r\n        this._debugDrawFlags = v;\r\n    }\r\n\r\n    _checkDebugDrawValid (): void {\r\n        if (EDITOR_NOT_IN_PREVIEW) return;\r\n        if (!this._debugGraphics || !this._debugGraphics.isValid) {\r\n            let canvas = find('Canvas');\r\n            if (!canvas) {\r\n                const scene = director.getScene();\r\n                if (!scene) {\r\n                    return;\r\n                }\r\n\r\n                canvas = new Node('Canvas');\r\n                canvas.addComponent('cc.Canvas');\r\n                canvas.parent = scene;\r\n            }\r\n\r\n            let node: Node | null = new Node('PHYSICS_2D_DEBUG_DRAW');\r\n            // node.zIndex = cc.macro.MAX_ZINDEX;\r\n            node.hideFlags |= CCObjectFlags.DontSave;\r\n            node.parent = canvas;\r\n            node.worldPosition = Vec3.ZERO;\r\n            node.layer = Layers.Enum.UI_2D;\r\n\r\n            try {\r\n                this._debugGraphics = node.addComponent('cc.Graphics') as Graphics;\r\n                this._debugGraphics.lineWidth = 3;\r\n\r\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\r\n                const debugDraw = new PhysicsDebugDraw(this._debugGraphics);\r\n                this._b2DebugDrawer = debugDraw;\r\n                this._world.SetDebugDraw(debugDraw);\r\n            } catch (e: any) {\r\n                errorID(4501, e.message as string);\r\n                node.destroy();\r\n                node = null;\r\n            }\r\n        }\r\n\r\n        if (this._debugGraphics) {\r\n            const parent = this._debugGraphics.node.parent!;\r\n            this._debugGraphics.node.setSiblingIndex(parent.children.length - 1);\r\n        }\r\n\r\n        if (this._b2DebugDrawer) {\r\n            this._b2DebugDrawer.SetFlags(this.debugDrawFlags);\r\n        }\r\n    }\r\n\r\n    setGravity (v: IVec2Like): void {\r\n        this._world.SetGravity(v as b2.Vec2);\r\n    }\r\n\r\n    setAllowSleep (v: boolean): void {\r\n        this._world.SetAllowSleeping(true);\r\n    }\r\n\r\n    step (deltaTime: number, velocityIterations = 10, positionIterations = 10): void {\r\n        const animatedBodies = this._animatedBodies;\r\n        for (let i = 0, l = animatedBodies.length; i < l; i++) {\r\n            animatedBodies[i].animate(deltaTime);\r\n        }\r\n        this._world.Step(deltaTime, velocityIterations, positionIterations);\r\n    }\r\n\r\n    raycast (p1: Vec2, p2: Vec2, type: ERaycast2DType, mask: number): RaycastResult2D[] {\r\n        if (p1.equals(p2)) {\r\n            return [];\r\n        }\r\n\r\n        type = type || ERaycast2DType.Closest;\r\n\r\n        tempVec2_1.x = p1.x / PHYSICS_2D_PTM_RATIO;\r\n        tempVec2_1.y = p1.y / PHYSICS_2D_PTM_RATIO;\r\n        tempVec2_2.x = p2.x / PHYSICS_2D_PTM_RATIO;\r\n        tempVec2_2.y = p2.y / PHYSICS_2D_PTM_RATIO;\r\n\r\n        const callback = this._raycastQueryCallback;\r\n        callback.init(type, mask);\r\n        this._world.RayCast(callback, tempVec2_1, tempVec2_2);\r\n\r\n        const fixtures = callback.getFixtures() as b2.Fixture[];\r\n        if (fixtures.length > 0) {\r\n            const points = callback.getPoints();\r\n            const normals = callback.getNormals();\r\n            const fractions = callback.getFractions();\r\n\r\n            const results: RaycastResult2D[] = [];\r\n            for (let i = 0, l = fixtures.length; i < l; i++) {\r\n                const fixture = fixtures[i];\r\n                const shape = fixture.m_userData as b2Shape2D;\r\n                const collider = shape.collider;\r\n\r\n                if (type === ERaycast2DType.AllClosest) {\r\n                    let result;\r\n                    for (let j = 0; j < results.length; j++) {\r\n                        if (results[j].collider === collider) {\r\n                            result = results[j];\r\n                        }\r\n                    }\r\n\r\n                    if (result) {\r\n                        if (fractions[i] < result.fraction) {\r\n                            result.fixtureIndex = shape.getFixtureIndex(fixture);\r\n                            result.point.x = points[i].x * PHYSICS_2D_PTM_RATIO;\r\n                            result.point.y = points[i].y * PHYSICS_2D_PTM_RATIO;\r\n                            result.normal.x = normals[i].x;\r\n                            result.normal.y = normals[i].y;\r\n                            result.fraction = fractions[i];\r\n                        }\r\n                        continue;\r\n                    }\r\n                }\r\n\r\n                results.push({\r\n                    collider,\r\n                    fixtureIndex: shape.getFixtureIndex(fixture),\r\n                    point: new Vec2(points[i].x * PHYSICS_2D_PTM_RATIO, points[i].y * PHYSICS_2D_PTM_RATIO),\r\n                    normal: new Vec2(normals[i].x, normals[i].y),\r\n                    fraction: fractions[i],\r\n                });\r\n            }\r\n\r\n            return results;\r\n        }\r\n\r\n        return [];\r\n    }\r\n\r\n    syncPhysicsToScene (): void {\r\n        const bodies = this._bodies;\r\n        for (let i = 0, l = bodies.length; i < l; i++) {\r\n            const body = bodies[i];\r\n            const bodyComp = body.rigidBody;\r\n            if (bodyComp.type === ERigidBody2DType.Animated) {\r\n                body.resetVelocity();\r\n                continue;\r\n            }\r\n\r\n            const node = bodyComp.node;\r\n            const b2body = body.impl;\r\n\r\n            // position\r\n            const pos = b2body!.GetPosition();\r\n            tempVec3.x = pos.x * PHYSICS_2D_PTM_RATIO;\r\n            tempVec3.y = pos.y * PHYSICS_2D_PTM_RATIO;\r\n            tempVec3.z = 0;\r\n            node.worldPosition = tempVec3;\r\n\r\n            // rotation\r\n            const angle = toDegree(b2body!.GetAngle());\r\n            node.setWorldRotationFromEuler(0, 0, angle);\r\n        }\r\n    }\r\n    syncSceneToPhysics (): void {\r\n        const bodies = this._bodies;\r\n        for (let i = 0; i < bodies.length; i++) {\r\n            bodies[i].syncSceneToPhysics();\r\n        }\r\n    }\r\n\r\n    addBody (body: b2RigidBody2D): void {\r\n        const bodies = this._bodies;\r\n        if (bodies.includes(body)) {\r\n            return;\r\n        }\r\n\r\n        const bodyDef = temoBodyDef;\r\n\r\n        const comp = body.rigidBody;\r\n\r\n        bodyDef.allowSleep = comp.allowSleep;\r\n        bodyDef.gravityScale = comp.gravityScale;\r\n        bodyDef.linearDamping = comp.linearDamping;\r\n        bodyDef.angularDamping = comp.angularDamping;\r\n\r\n        bodyDef.fixedRotation = comp.fixedRotation;\r\n        bodyDef.bullet = comp.bullet;\r\n\r\n        const node = comp.node;\r\n        const pos = node.worldPosition;\r\n        bodyDef.position.Set(pos.x / PHYSICS_2D_PTM_RATIO, pos.y / PHYSICS_2D_PTM_RATIO);\r\n\r\n        tempVec3.z = Quat.getAxisAngle(this._rotationAxis, node.worldRotation);\r\n        if (this._rotationAxis.z < 0.0) {\r\n            tempVec3.z = Math.PI * 2 - tempVec3.z;\r\n        }\r\n        bodyDef.angle = tempVec3.z;\r\n\r\n        bodyDef.awake = comp.awakeOnLoad;\r\n\r\n        if (comp.type === ERigidBody2DType.Animated) {\r\n            bodyDef.type = ERigidBody2DType.Kinematic as number;\r\n\r\n            this._animatedBodies.push(body);\r\n            body._animatedPos.set(bodyDef.position.x, bodyDef.position.y);\r\n            body._animatedAngle = bodyDef.angle;\r\n        } else {\r\n            bodyDef.type = comp.type as number;\r\n        }\r\n\r\n        // read private property\r\n        const compPrivate = comp as any;\r\n        const linearVelocity = compPrivate._linearVelocity as Vec2;\r\n        bodyDef.linearVelocity.Set(linearVelocity.x, linearVelocity.y);\r\n\r\n        bodyDef.angularVelocity = compPrivate._angularVelocity;\r\n\r\n        const b2Body = this._world.CreateBody(bodyDef);\r\n        b2Body.m_userData = body;\r\n        body._imp = b2Body;\r\n\r\n        this._bodies.push(body);\r\n    }\r\n\r\n    removeBody (body: b2RigidBody2D): void {\r\n        if (!this._bodies.includes(body)) {\r\n            return;\r\n        }\r\n        if (body.impl) {\r\n            body.impl.m_userData = null;\r\n            this._world.DestroyBody(body.impl);\r\n            body._imp = null;\r\n        }\r\n        js.array.remove(this._bodies, body);\r\n\r\n        const comp = body.rigidBody;\r\n        if (comp.type === ERigidBody2DType.Animated) {\r\n            js.array.remove(this._animatedBodies, body);\r\n        }\r\n    }\r\n\r\n    public _updateBodyType (body: b2RigidBody2D): void {\r\n        const animatedBodies = this._animatedBodies;\r\n        const comp = body.rigidBody;\r\n        if (comp.type !== ERigidBody2DType.Animated) {\r\n            js.array.remove(animatedBodies, body);\r\n        } else {\r\n            if (animatedBodies.includes(body)) {\r\n                return;\r\n            }\r\n            animatedBodies.push(body);\r\n        }\r\n    }\r\n\r\n    registerContactFixture (fixture: b2.Fixture): void {\r\n        this._contactListener.registerContactFixture(fixture);\r\n    }\r\n    unregisterContactFixture (fixture: b2.Fixture): void {\r\n        this._contactListener.unregisterContactFixture(fixture);\r\n    }\r\n\r\n    testPoint (point: Vec2): readonly Collider2D[] {\r\n        const x = tempVec2_1.x = point.x / PHYSICS_2D_PTM_RATIO;\r\n        const y = tempVec2_1.y = point.y / PHYSICS_2D_PTM_RATIO;\r\n\r\n        const d = 0.2 / PHYSICS_2D_PTM_RATIO;\r\n        tempB2AABB.lowerBound.x = x - d;\r\n        tempB2AABB.lowerBound.y = y - d;\r\n        tempB2AABB.upperBound.x = x + d;\r\n        tempB2AABB.upperBound.y = y + d;\r\n\r\n        const callback = this._aabbQueryCallback;\r\n        callback.init(tempVec2_1);\r\n        this._world.QueryAABB(callback, tempB2AABB);\r\n\r\n        const fixtures = callback.getFixtures();\r\n        testResults.length = 0;\r\n        for (let i = 0; i < fixtures.length; i++) {\r\n            const collider = (fixtures[i].m_userData as b2Shape2D).collider;\r\n            if (!testResults.includes(collider)) {\r\n                testResults.push(collider);\r\n            }\r\n        }\r\n        return testResults;\r\n    }\r\n\r\n    testAABB (rect: Rect): readonly Collider2D[] {\r\n        tempB2AABB.lowerBound.x = rect.xMin / PHYSICS_2D_PTM_RATIO;\r\n        tempB2AABB.lowerBound.y = rect.yMin / PHYSICS_2D_PTM_RATIO;\r\n        tempB2AABB.upperBound.x = rect.xMax / PHYSICS_2D_PTM_RATIO;\r\n        tempB2AABB.upperBound.y = rect.yMax / PHYSICS_2D_PTM_RATIO;\r\n\r\n        const callback = this._aabbQueryCallback;\r\n        callback.init();\r\n        this._world.QueryAABB(callback, tempB2AABB);\r\n\r\n        const fixtures = callback.getFixtures();\r\n        testResults.length = 0;\r\n        for (let i = 0; i < fixtures.length; i++) {\r\n            const collider = (fixtures[i].m_userData as b2Shape2D).collider;\r\n            if (!testResults.includes(collider)) {\r\n                testResults.push(collider);\r\n            }\r\n        }\r\n        return testResults;\r\n    }\r\n\r\n    drawDebug (): void {\r\n        if (TEST) return;\r\n        this._checkDebugDrawValid();\r\n\r\n        if (!this._debugGraphics) {\r\n            return;\r\n        }\r\n        this._debugGraphics.clear();\r\n        this._world.DrawDebugData();\r\n    }\r\n\r\n    _onBeginContact (b2contact: b2ContactExtends): void {\r\n        const c = PhysicsContact.get(b2contact);\r\n        c.emit(Contact2DType.BEGIN_CONTACT);\r\n    }\r\n\r\n    _onEndContact (b2contact: b2ContactExtends): void {\r\n        const c = b2contact.m_userData as PhysicsContact;\r\n        if (!c) {\r\n            return;\r\n        }\r\n        c.emit(Contact2DType.END_CONTACT);\r\n\r\n        PhysicsContact.put(b2contact);\r\n    }\r\n\r\n    _onPreSolve (b2contact: b2ContactExtends): void {\r\n        const c = b2contact.m_userData as PhysicsContact;\r\n        if (!c) {\r\n            return;\r\n        }\r\n\r\n        c.emit(Contact2DType.PRE_SOLVE);\r\n    }\r\n\r\n    _onPostSolve (b2contact: b2ContactExtends, impulse: b2.ContactImpulse): void {\r\n        const c: PhysicsContact = b2contact.m_userData as PhysicsContact;\r\n        if (!c) {\r\n            return;\r\n        }\r\n\r\n        // impulse only survive during post sole callback\r\n        c._setImpulse(impulse);\r\n        c.emit(Contact2DType.POST_SOLVE);\r\n        c._setImpulse(null);\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { DEBUG } from 'internal:constants';\r\nimport { IRigidBody2D } from '../spec/i-rigid-body';\r\nimport { RigidBody2D } from '../framework/components/rigid-body-2d';\r\nimport { PhysicsSystem2D } from '../framework/physics-system';\r\nimport { b2PhysicsWorld } from './physics-world';\r\nimport { Vec2, toRadian, Vec3, Quat, IVec2Like, TWO_PI, HALF_PI, warn } from '../../core';\r\nimport { PHYSICS_2D_PTM_RATIO, ERigidBody2DType } from '../framework/physics-types';\r\n\r\nimport { Node } from '../../scene-graph/node';\r\nimport { Collider2D } from '../framework';\r\nimport { TransformBit } from '../../scene-graph/node-enum';\r\n\r\nconst tempVec3 = new Vec3();\r\n\r\nconst tempVec2_1 = new b2.Vec2();\r\n\r\n/** @mangle */\r\nexport class b2RigidBody2D implements IRigidBody2D {\r\n    get impl (): b2.Body | null {\r\n        return this._body;\r\n    }\r\n    set _imp (v: b2.Body | null) {\r\n        this._body = v;\r\n    }\r\n\r\n    get rigidBody (): RigidBody2D {\r\n        return this._rigidBody;\r\n    }\r\n    get isAwake (): boolean {\r\n        return this._body!.IsAwake();\r\n    }\r\n    get isSleeping (): boolean {\r\n        return !(this._body!.IsAwake());\r\n    }\r\n\r\n    _animatedPos = new Vec2();\r\n    _animatedAngle = 0;\r\n\r\n    private _body: b2.Body | null = null;\r\n    private _rigidBody!: RigidBody2D;\r\n\r\n    private _inited = false;\r\n\r\n    initialize (com: RigidBody2D): void {\r\n        this._rigidBody = com;\r\n\r\n        PhysicsSystem2D.instance._callAfterStep(this, this._init);\r\n    }\r\n\r\n    onDestroy (): void {\r\n        PhysicsSystem2D.instance._callAfterStep(this, this._destroy);\r\n    }\r\n\r\n    onEnable (): void {\r\n        this.setActive(true);\r\n    }\r\n\r\n    onDisable (): void {\r\n        this.setActive(false);\r\n    }\r\n\r\n    nodeTransformChanged (type: TransformBit): void {\r\n        if (PhysicsSystem2D.instance.stepping) {\r\n            return;\r\n        }\r\n\r\n        if (type & Node.TransformBit.SCALE) {\r\n            const colliders = this.rigidBody.getComponents(Collider2D);\r\n            for (let i = 0; i < colliders.length; i++) {\r\n                colliders[i].apply();\r\n            }\r\n        }\r\n        if (type & Node.TransformBit.POSITION) {\r\n            this.syncPositionToPhysics(true);\r\n        }\r\n        if (type & Node.TransformBit.ROTATION) {\r\n            this.syncRotationToPhysics(true);\r\n        }\r\n    }\r\n\r\n    _init (): void {\r\n        if (this._inited) {\r\n            return;\r\n        }\r\n\r\n        (PhysicsSystem2D.instance.physicsWorld as b2PhysicsWorld).addBody(this);\r\n        this.setActive(false);\r\n\r\n        this._inited = true;\r\n    }\r\n\r\n    _destroy (): void {\r\n        if (!this._inited) return;\r\n\r\n        (PhysicsSystem2D.instance.physicsWorld as b2PhysicsWorld).removeBody(this);\r\n\r\n        this._inited = false;\r\n    }\r\n\r\n    animate (dt: number): void {\r\n        const b2body = this._body;\r\n        if (!b2body) return;\r\n        const b2Pos = b2body.GetPosition();\r\n\r\n        b2body.SetAwake(true);\r\n\r\n        const timeStep = 1 / dt;\r\n        tempVec2_1.x = (this._animatedPos.x - b2Pos.x) * timeStep;\r\n        tempVec2_1.y = (this._animatedPos.y - b2Pos.y) * timeStep;\r\n        b2body.SetLinearVelocity(tempVec2_1);\r\n\r\n        //convert b2Rotation to [-PI~PI], which is the same as this._animatedAngle\r\n        let b2Rotation = b2body.GetAngle() % (TWO_PI);\r\n        if (b2Rotation > Math.PI) {\r\n            b2Rotation -= TWO_PI;\r\n        }\r\n\r\n        //calculate angular velocity\r\n        let angularVelocity = (this._animatedAngle - b2Rotation) * timeStep;\r\n        if (this._animatedAngle < -HALF_PI && b2Rotation > HALF_PI) { //ccw, crossing PI\r\n            angularVelocity = (this._animatedAngle + TWO_PI - b2Rotation) * timeStep;\r\n        } if (this._animatedAngle > HALF_PI && b2Rotation < -HALF_PI) { //cw, crossing PI\r\n            angularVelocity = (this._animatedAngle - TWO_PI - b2Rotation) * timeStep;\r\n        }\r\n\r\n        b2body.SetAngularVelocity(angularVelocity);\r\n    }\r\n\r\n    syncSceneToPhysics (): void {\r\n        const dirty = this._rigidBody.node.hasChangedFlags;\r\n        if (dirty) { this.nodeTransformChanged(dirty); }\r\n    }\r\n\r\n    syncPositionToPhysics (enableAnimated = false): void {\r\n        const b2body = this._body;\r\n        if (!b2body) return;\r\n\r\n        const pos = this._rigidBody.node.worldPosition;\r\n\r\n        let temp: b2.Vec2;\r\n        const bodyType = this._rigidBody.type;\r\n        if (bodyType === ERigidBody2DType.Animated) {\r\n            temp = b2body.GetLinearVelocity();\r\n        } else {\r\n            temp = b2body.GetPosition();\r\n        }\r\n\r\n        temp.x = pos.x / PHYSICS_2D_PTM_RATIO;\r\n        temp.y = pos.y / PHYSICS_2D_PTM_RATIO;\r\n\r\n        if (bodyType === ERigidBody2DType.Animated && enableAnimated) {\r\n            this._animatedPos.set(temp.x, temp.y);\r\n        } else {\r\n            b2body.SetTransformVec(temp, b2body.GetAngle());\r\n        }\r\n    }\r\n\r\n    syncRotationToPhysics (enableAnimated = false): void {\r\n        const b2body = this._body;\r\n        if (!b2body) return;\r\n\r\n        const rot = this._rigidBody.node.worldRotation;\r\n        const euler = tempVec3;\r\n        Quat.toEulerInYXZOrder(euler, rot);\r\n        const rotation = toRadian(euler.z);\r\n\r\n        const bodyType = this._rigidBody.type;\r\n        if (bodyType === ERigidBody2DType.Animated && enableAnimated) {\r\n            this._animatedAngle = rotation;\r\n        } else {\r\n            b2body.SetTransformVec(b2body.GetPosition(), rotation);\r\n        }\r\n    }\r\n\r\n    resetVelocity (): void {\r\n        const b2body = this._body;\r\n        if (!b2body) return;\r\n\r\n        const temp = b2body.m_linearVelocity;\r\n        temp.Set(0, 0);\r\n\r\n        b2body.SetLinearVelocity(temp);\r\n        b2body.SetAngularVelocity(0);\r\n    }\r\n\r\n    setType (v: ERigidBody2DType): void {\r\n        (PhysicsSystem2D.instance.physicsWorld as b2PhysicsWorld)._updateBodyType(this);\r\n        this._body!.SetType(v as number);\r\n    }\r\n    setLinearDamping (v: number): void {\r\n        this._body!.SetLinearDamping(v);\r\n    }\r\n    setAngularDamping (v: number): void {\r\n        this._body!.SetAngularDamping(v);\r\n    }\r\n    setGravityScale (v: number): void {\r\n        this._body!.SetGravityScale(v);\r\n    }\r\n    setFixedRotation (v: boolean): void {\r\n        this._body!.SetFixedRotation(v);\r\n    }\r\n    setAllowSleep (v: boolean): void {\r\n        this._body!.SetSleepingAllowed(v);\r\n    }\r\n    isActive (): any {\r\n        return this._body!.IsActive();\r\n    }\r\n    setActive (v: boolean): void {\r\n        if (!this._body!.m_world.IsLocked()) {\r\n            this._body!.SetActive(v);\r\n        } else if (DEBUG) {\r\n            warn('Can not active RigidBody in contract listener.');\r\n        }\r\n    }\r\n    wakeUp (): void {\r\n        this._body!.SetAwake(true);\r\n    }\r\n    sleep (): void {\r\n        this._body!.SetAwake(false);\r\n    }\r\n    getMass (): any {\r\n        return this._body!.GetMass();\r\n    }\r\n    setLinearVelocity (v: IVec2Like): void {\r\n        this._body!.SetLinearVelocity(v as b2.Vec2);\r\n    }\r\n    getLinearVelocity<Out extends IVec2Like> (out: Out): Out {\r\n        const velocity = this._body!.GetLinearVelocity();\r\n        out.x = velocity.x;\r\n        out.y = velocity.y;\r\n        return out;\r\n    }\r\n    getLinearVelocityFromWorldPoint<Out extends IVec2Like> (worldPoint: IVec2Like, out: Out): Out {\r\n        tempVec2_1.Set(worldPoint.x / PHYSICS_2D_PTM_RATIO, worldPoint.y / PHYSICS_2D_PTM_RATIO);\r\n        this._body!.GetLinearVelocityFromWorldPoint(tempVec2_1, out as any);\r\n        out.x *= PHYSICS_2D_PTM_RATIO;\r\n        out.y *= PHYSICS_2D_PTM_RATIO;\r\n        return out;\r\n    }\r\n    setAngularVelocity (v: number): void {\r\n        this._body!.SetAngularVelocity(v);\r\n    }\r\n    getAngularVelocity (): number {\r\n        return this._body!.GetAngularVelocity();\r\n    }\r\n\r\n    getLocalVector<Out extends IVec2Like> (worldVector: IVec2Like, out: Out): Out {\r\n        out = out || new Vec2();\r\n        tempVec2_1.Set(worldVector.x / PHYSICS_2D_PTM_RATIO, worldVector.y / PHYSICS_2D_PTM_RATIO);\r\n        this._body!.GetLocalVector(tempVec2_1, out as any);\r\n        out.x *= PHYSICS_2D_PTM_RATIO;\r\n        out.y *= PHYSICS_2D_PTM_RATIO;\r\n        return out;\r\n    }\r\n    getWorldVector<Out extends IVec2Like> (localVector: IVec2Like, out: Out): Out {\r\n        tempVec2_1.Set(localVector.x / PHYSICS_2D_PTM_RATIO, localVector.y / PHYSICS_2D_PTM_RATIO);\r\n        this._body!.GetWorldVector(tempVec2_1, out as any);\r\n        out.x *= PHYSICS_2D_PTM_RATIO;\r\n        out.y *= PHYSICS_2D_PTM_RATIO;\r\n        return out;\r\n    }\r\n\r\n    getLocalPoint<Out extends IVec2Like> (worldPoint: IVec2Like, out: Out): Out {\r\n        out = out || new Vec2();\r\n        tempVec2_1.Set(worldPoint.x / PHYSICS_2D_PTM_RATIO, worldPoint.y / PHYSICS_2D_PTM_RATIO);\r\n        this._body!.GetLocalPoint(tempVec2_1, out as any);\r\n        out.x *= PHYSICS_2D_PTM_RATIO;\r\n        out.y *= PHYSICS_2D_PTM_RATIO;\r\n        return out;\r\n    }\r\n\r\n    getWorldPoint<Out extends IVec2Like> (localPoint: IVec2Like, out: Out): Out {\r\n        out = out || new Vec2();\r\n        tempVec2_1.Set(localPoint.x / PHYSICS_2D_PTM_RATIO, localPoint.y / PHYSICS_2D_PTM_RATIO);\r\n        this._body!.GetWorldPoint(tempVec2_1, out as any);\r\n        out.x *= PHYSICS_2D_PTM_RATIO;\r\n        out.y *= PHYSICS_2D_PTM_RATIO;\r\n        return out;\r\n    }\r\n\r\n    getLocalCenter<Out extends IVec2Like> (out: Out): Out {\r\n        out = out || new Vec2();\r\n        const pos = this._body!.GetLocalCenter();\r\n        out.x = pos.x * PHYSICS_2D_PTM_RATIO;\r\n        out.y = pos.y * PHYSICS_2D_PTM_RATIO;\r\n        return out;\r\n    }\r\n    getWorldCenter<Out extends IVec2Like> (out: Out): Out {\r\n        out = out || new Vec2();\r\n        const pos = this._body!.GetWorldCenter();\r\n        out.x = pos.x * PHYSICS_2D_PTM_RATIO;\r\n        out.y = pos.y * PHYSICS_2D_PTM_RATIO;\r\n        return out;\r\n    }\r\n\r\n    getInertia (): any {\r\n        return this._body!.GetInertia();\r\n    }\r\n\r\n    applyForce (force: IVec2Like, point: IVec2Like, wake: boolean): void {\r\n        if (this._body) {\r\n            tempVec2_1.Set(point.x / PHYSICS_2D_PTM_RATIO, point.y / PHYSICS_2D_PTM_RATIO);\r\n            this._body.ApplyForce(force as b2.Vec2, tempVec2_1, wake);\r\n        }\r\n    }\r\n\r\n    applyForceToCenter (force: IVec2Like, wake: boolean): void {\r\n        if (this._body) {\r\n            this._body.ApplyForceToCenter(force as b2.Vec2, wake);\r\n        }\r\n    }\r\n\r\n    applyTorque (torque: number, wake: boolean): void {\r\n        if (this._body) {\r\n            this._body.ApplyTorque(torque, wake);\r\n        }\r\n    }\r\n\r\n    applyLinearImpulse (impulse: IVec2Like, point: IVec2Like, wake: boolean): void {\r\n        if (this._body) {\r\n            tempVec2_1.Set(point.x / PHYSICS_2D_PTM_RATIO, point.y / PHYSICS_2D_PTM_RATIO);\r\n            this._body.ApplyLinearImpulse(impulse as b2.Vec2, tempVec2_1, wake);\r\n        }\r\n    }\r\n\r\n    applyLinearImpulseToCenter (impulse: IVec2Like, wake: boolean): void {\r\n        if (this._body) {\r\n            this._body.ApplyLinearImpulse(impulse as b2.Vec2, this._body.GetPosition(), wake);\r\n        }\r\n    }\r\n\r\n    applyAngularImpulse (impulse: number, wake: boolean): void {\r\n        if (this._body) {\r\n            this._body.ApplyAngularImpulse(impulse, wake);\r\n        }\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\n\r\nimport { IBaseShape } from '../../spec/i-physics-shape';\r\nimport { Collider2D, PhysicsSystem2D, RigidBody2D, PHYSICS_2D_PTM_RATIO } from '../../../../exports/physics-2d-framework';\r\nimport { Rect, Vec3 } from '../../../core';\r\nimport { b2PhysicsWorld } from '../physics-world';\r\nimport { PhysicsGroup } from '../../../physics/framework/physics-enum';\r\n\r\nconst tempFilter = new b2.Filter();\r\nconst lowerBound = new b2.Vec2();\r\nconst upperBound = new b2.Vec2();\r\n\r\nfunction getFilter (shape: b2Shape2D): b2.Filter {\r\n    const comp = shape.collider;\r\n    if (comp.body) {\r\n        tempFilter.categoryBits = comp.group === PhysicsGroup.DEFAULT ? comp.body.group : comp.group;\r\n    } else {\r\n        tempFilter.categoryBits = comp.group;\r\n    }\r\n    tempFilter.maskBits = PhysicsSystem2D.instance.collisionMatrix[tempFilter.categoryBits];\r\n    return tempFilter;\r\n}\r\n\r\n/** @mangle */\r\nexport class b2Shape2D implements IBaseShape {\r\n    protected _shapes: b2.Shape[] = [];\r\n    protected _fixtures: b2.Fixture[] = [];\r\n\r\n    protected _collider: Collider2D | null = null;\r\n    protected _body: b2.Body | null = null;\r\n\r\n    private _inited = false;\r\n\r\n    private _rect = new Rect();\r\n\r\n    get impl (): b2.Shape[] {\r\n        return this._shapes;\r\n    }\r\n\r\n    get collider (): Collider2D {\r\n        return this._collider!;\r\n    }\r\n\r\n    initialize (comp: Collider2D): void {\r\n        this._collider = comp;\r\n    }\r\n\r\n    onLoad (): void {\r\n    }\r\n\r\n    onEnable (): void {\r\n        PhysicsSystem2D.instance._callAfterStep(this, this._init);\r\n    }\r\n\r\n    onDisable (): void {\r\n        PhysicsSystem2D.instance._callAfterStep(this, this._destroy);\r\n    }\r\n\r\n    start (): void {\r\n\r\n    }\r\n\r\n    onGroupChanged (): void {\r\n        const filter = getFilter(this);\r\n        this._fixtures.forEach((f): void => {\r\n            f.SetFilterData(filter);\r\n        });\r\n    }\r\n\r\n    apply (): void {\r\n        this._destroy();\r\n        if (this.collider.enabledInHierarchy) {\r\n            this._init();\r\n        }\r\n    }\r\n\r\n    get worldAABB (): Readonly<Rect> {\r\n        const MAX = 10e6;\r\n\r\n        let minX = MAX; let minY = MAX;\r\n        let maxX = -MAX; let maxY = -MAX;\r\n\r\n        const fixtures = this._fixtures;\r\n        for (let i = 0; i < fixtures.length; i++) {\r\n            const fixture = fixtures[i];\r\n\r\n            const count = fixture.GetShape().GetChildCount();\r\n            for (let j = 0; j < count; j++) {\r\n                lowerBound.Copy(fixture.GetAABB(j).lowerBound);\r\n                upperBound.Copy(fixture.GetAABB(j).upperBound);\r\n                if (fixture.GetShape().m_type === 2) { //b2ShapeType.e_polygonShape\r\n                    const skinWidth = fixture.GetShape().m_radius;\r\n                    lowerBound.SelfAddXY(skinWidth, skinWidth);\r\n                    upperBound.SelfSubXY(skinWidth, skinWidth);\r\n                }\r\n                if (lowerBound.x < minX) minX = lowerBound.x;\r\n                if (lowerBound.y < minY) minY = lowerBound.y;\r\n                if (upperBound.x > maxX) maxX = upperBound.x;\r\n                if (upperBound.y > maxY) maxY = upperBound.y;\r\n            }\r\n        }\r\n\r\n        minX *= PHYSICS_2D_PTM_RATIO;\r\n        minY *= PHYSICS_2D_PTM_RATIO;\r\n        maxX *= PHYSICS_2D_PTM_RATIO;\r\n        maxY *= PHYSICS_2D_PTM_RATIO;\r\n\r\n        const r = this._rect;\r\n        r.x = minX;\r\n        r.y = minY;\r\n        r.width = maxX - minX;\r\n        r.height = maxY - minY;\r\n\r\n        return r;\r\n    }\r\n\r\n    getFixtureIndex (fixture: b2.Fixture): number {\r\n        return this._fixtures.indexOf(fixture);\r\n    }\r\n\r\n    //relativePositionX/Y : relative Position from shape to rigid body\r\n    _createShapes (scaleX: number, scaleY: number, relativePositionX: number, relativePositionY: number): b2.Shape[] {\r\n        return [];\r\n    }\r\n\r\n    _init (): void {\r\n        if (this._inited) return;\r\n\r\n        const comp = this.collider;\r\n        const scale = comp.node.worldScale;\r\n        // relative Position from shape to rigid body\r\n        let relativePosition = Vec3.ZERO;\r\n        const body = comp.getComponent(RigidBody2D);\r\n\r\n        //if rigid body is not attached to the same node of collider, this b2.shape is attached\r\n        // to the groundRigidBody(pos zero, rot zero)\r\n        if (body && body.impl && body.impl.impl) {\r\n            this._body = body.impl.impl as b2.Body;\r\n        } else {\r\n            this._body = (PhysicsSystem2D.instance.physicsWorld as b2PhysicsWorld).groundBodyImpl;\r\n            relativePosition = comp.node.worldPosition;\r\n        }\r\n\r\n        const shapes = scale.x === 0 && scale.y === 0 ? [] : this._createShapes(scale.x, scale.y, relativePosition.x, relativePosition.y);\r\n\r\n        const filter = getFilter(this);\r\n\r\n        for (let i = 0; i < shapes.length; i++) {\r\n            const shape = shapes[i];\r\n\r\n            const fixDef: b2.IFixtureDef = {\r\n                density: comp.density,\r\n                isSensor: comp.sensor,\r\n                friction: comp.friction,\r\n                restitution: comp.restitution,\r\n                shape,\r\n\r\n                filter,\r\n            };\r\n\r\n            const fixture = this._body.CreateFixture(fixDef);\r\n            fixture.m_userData = this;\r\n\r\n            if (body?.enabledContactListener) {\r\n                (PhysicsSystem2D.instance.physicsWorld as b2PhysicsWorld).registerContactFixture(fixture);\r\n            }\r\n\r\n            this._shapes.push(shape);\r\n            this._fixtures.push(fixture);\r\n        }\r\n\r\n        this._inited = true;\r\n    }\r\n\r\n    _destroy (): void {\r\n        if (!this._inited) return;\r\n\r\n        const fixtures = this._fixtures;\r\n        const body = this._body;\r\n\r\n        for (let i = fixtures.length - 1; i >= 0; i--) {\r\n            const fixture = fixtures[i];\r\n            fixture.m_userData = null;\r\n\r\n            (PhysicsSystem2D.instance.physicsWorld as b2PhysicsWorld).unregisterContactFixture(fixture);\r\n\r\n            if (body) {\r\n                body.DestroyFixture(fixture);\r\n            }\r\n        }\r\n\r\n        this._body = null;\r\n\r\n        this._fixtures.length = 0;\r\n        this._shapes.length = 0;\r\n        this._inited = false;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { b2Shape2D } from './shape-2d';\r\nimport { BoxCollider2D } from '../../framework';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework/physics-types';\r\nimport { IBoxShape } from '../../spec/i-physics-shape';\r\nimport { Vec2, Rect } from '../../../core';\r\n\r\nconst tempAabb = new Rect();\r\n\r\n/** @mangle */\r\nexport class b2BoxShape extends b2Shape2D implements IBoxShape {\r\n    _worldPoints: Vec2[] = [new Vec2(), new Vec2(), new Vec2(), new Vec2()];\r\n    get worldPoints (): Readonly<Vec2>[] {\r\n        const aabb = tempAabb;\r\n\r\n        const collider = this.collider as BoxCollider2D;\r\n        const size = collider.size;\r\n        const offset = collider.offset;\r\n\r\n        aabb.x = offset.x - size.width / 2;\r\n        aabb.y = offset.y - size.height / 2;\r\n        aabb.width = size.width;\r\n        aabb.height = size.height;\r\n\r\n        const wps = this._worldPoints;\r\n        const wp0 = wps[0]; const wp1 = wps[1];\r\n        const wp2 = wps[2]; const wp3 = wps[3];\r\n\r\n        aabb.transformMat4ToPoints(collider.node.worldMatrix, wp0, wp1, wp2, wp3);\r\n\r\n        return wps;\r\n    }\r\n\r\n    _createShapes (scaleX: number, scaleY: number, relativePositionX: number, relativePositionY: number): any[] {\r\n        scaleX = Math.abs(scaleX);\r\n        scaleY = Math.abs(scaleY);\r\n\r\n        const comp = this.collider as BoxCollider2D;\r\n\r\n        const width = comp.size.width / 2 / PHYSICS_2D_PTM_RATIO * scaleX;\r\n        const height = comp.size.height / 2 / PHYSICS_2D_PTM_RATIO * scaleY;\r\n        const offsetX = (relativePositionX + comp.offset.x * scaleX) / PHYSICS_2D_PTM_RATIO;\r\n        const offsetY = (relativePositionY + comp.offset.y * scaleY) / PHYSICS_2D_PTM_RATIO;\r\n\r\n        const shape = new b2.PolygonShape();\r\n        shape.SetAsBox(width, height, new b2.Vec2(offsetX, offsetY), 0);\r\n\r\n        return [shape];\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { b2Shape2D } from './shape-2d';\r\nimport { CircleCollider2D } from '../../framework';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework/physics-types';\r\nimport { ICircleShape } from '../../spec/i-physics-shape';\r\nimport { Vec2 } from '../../../core';\r\n\r\n/** @mangle */\r\nexport class b2CircleShape extends b2Shape2D implements ICircleShape {\r\n    get worldRadius (): number {\r\n        return (this._shapes[0] as b2.CircleShape).m_radius * PHYSICS_2D_PTM_RATIO;\r\n    }\r\n\r\n    _worldPosition = new Vec2();\r\n    get worldPosition (): Vec2 {\r\n        const p = (this._shapes[0] as b2.CircleShape).m_p;\r\n        return this._worldPosition.set(p.x * PHYSICS_2D_PTM_RATIO, p.y * PHYSICS_2D_PTM_RATIO);\r\n    }\r\n\r\n    _createShapes (scaleX: number, scaleY: number, relativePositionX: number, relativePositionY: number): any[] {\r\n        scaleX = Math.abs(scaleX);\r\n        scaleY = Math.abs(scaleY);\r\n\r\n        const comp = this.collider as CircleCollider2D;\r\n\r\n        const offsetX = (relativePositionX + comp.offset.x * scaleX) / PHYSICS_2D_PTM_RATIO;\r\n        const offsetY = (relativePositionY + comp.offset.y * scaleY) / PHYSICS_2D_PTM_RATIO;\r\n\r\n        const shape = new b2.CircleShape();\r\n        shape.m_radius = comp.radius / PHYSICS_2D_PTM_RATIO * scaleX;\r\n        shape.m_p.Set(offsetX, offsetY);\r\n\r\n        return [shape];\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { b2Shape2D } from './shape-2d';\r\nimport * as PolygonPartition from '../../framework/utils/polygon-partition';\r\nimport { PolygonCollider2D } from '../../framework';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework/physics-types';\r\nimport { IPolygonShape } from '../../spec/i-physics-shape';\r\nimport { logID, Vec2 } from '../../../core';\r\n\r\n/** @mangle */\r\nexport class b2PolygonShape extends b2Shape2D implements IPolygonShape {\r\n    _worldPoints: Vec2[] = [];\r\n    get worldPoints (): Readonly<Vec2>[] {\r\n        const comp = this.collider as PolygonCollider2D;\r\n        const points = comp.points;\r\n        const worldPoints = this._worldPoints;\r\n        const m = comp.node.worldMatrix;\r\n        for (let i = 0; i < points.length; i++) {\r\n            if (!worldPoints[i]) {\r\n                worldPoints[i] = new Vec2();\r\n            }\r\n            Vec2.transformMat4(worldPoints[i], points[i], m);\r\n        }\r\n        worldPoints.length = points.length;\r\n\r\n        return this._worldPoints;\r\n    }\r\n\r\n    _createShapes (scaleX: number, scaleY: number, relativePositionX: number, relativePositionY: number): any[] {\r\n        const shapes: b2.PolygonShape[] = [];\r\n\r\n        const comp = this.collider as PolygonCollider2D;\r\n        const points = comp.points;\r\n\r\n        // check if last point equal to first point\r\n        if (points.length > 0 && points[0].equals(points[points.length - 1])) {\r\n            points.length -= 1;\r\n        }\r\n\r\n        const polys = PolygonPartition.ConvexPartition(points);\r\n        if (!polys) {\r\n            logID(16408, comp.node.name);\r\n            return shapes;\r\n        }\r\n\r\n        const offset = comp.offset;\r\n\r\n        for (let i = 0; i < polys.length; i++) {\r\n            const poly = polys[i];\r\n\r\n            let shape: b2.PolygonShape | null = null; let vertices: b2.Vec2[] = [];\r\n            let firstVertice: b2.Vec2 | null = null;\r\n\r\n            for (let j = 0, l = poly.length; j < l; j++) {\r\n                if (!shape) {\r\n                    shape = new b2.PolygonShape();\r\n                }\r\n                const p = poly[j];\r\n                const x = (relativePositionX + (p.x + offset.x) * scaleX) / PHYSICS_2D_PTM_RATIO;\r\n                const y = (relativePositionY + (p.y + offset.y) * scaleY) / PHYSICS_2D_PTM_RATIO;\r\n                const v = new b2.Vec2(x, y);\r\n                vertices.push(v);\r\n\r\n                if (!firstVertice) {\r\n                    firstVertice = v;\r\n                }\r\n\r\n                if (vertices.length === b2.maxPolygonVertices) {\r\n                    shape.Set(vertices, vertices.length);\r\n                    shapes.push(shape);\r\n\r\n                    shape = null;\r\n\r\n                    if (j < l - 1) {\r\n                        vertices = [firstVertice, vertices[vertices.length - 1]];\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (shape) {\r\n                shape.Set(vertices, vertices.length);\r\n                shapes.push(shape);\r\n            }\r\n        }\r\n\r\n        return shapes;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { IJoint2D } from '../../spec/i-physics-joint';\r\nimport { Joint2D, PhysicsSystem2D, RigidBody2D } from '../../framework';\r\nimport { b2PhysicsWorld } from '../physics-world';\r\n\r\n/** @mangle */\r\nexport class b2Joint implements IJoint2D {\r\n    get impl (): b2.Joint | null {\r\n        return this._b2joint;\r\n    }\r\n    get comp (): Joint2D | null {\r\n        return this._jointComp;\r\n    }\r\n    get body (): RigidBody2D | null {\r\n        return this._body;\r\n    }\r\n\r\n    protected _b2joint: b2.Joint | null = null;\r\n    protected _jointComp: Joint2D | null = null;\r\n    protected _body: RigidBody2D | null = null;\r\n\r\n    private _inited = false;\r\n\r\n    initialize (comp: Joint2D): void {\r\n        this._jointComp = comp;\r\n    }\r\n\r\n    onEnable (): void {\r\n        PhysicsSystem2D.instance._callAfterStep(this, this._init);\r\n    }\r\n\r\n    onDisable (): void {\r\n        PhysicsSystem2D.instance._callAfterStep(this, this._destroy);\r\n    }\r\n\r\n    // need init after body and connected body init\r\n    start (): void {\r\n        PhysicsSystem2D.instance._callAfterStep(this, this._init);\r\n    }\r\n\r\n    apply (): void {\r\n        PhysicsSystem2D.instance._callAfterStep(this, this._destroy);\r\n        if (this.comp!.enabledInHierarchy) {\r\n            PhysicsSystem2D.instance._callAfterStep(this, this._init);\r\n        }\r\n    }\r\n\r\n    _init (): void {\r\n        if (this._inited) return;\r\n\r\n        const comp = this._jointComp!;\r\n        if (!comp.isValid) {\r\n            return;\r\n        }\r\n\r\n        this._body = comp.getComponent(RigidBody2D);\r\n\r\n        const def = this._createJointDef();\r\n        if (!def) {\r\n            return;\r\n        }\r\n\r\n        def.bodyA = this._body!.impl!.impl;\r\n        const connectedBody = comp.connectedBody;\r\n        //if connected body is set but not active, return\r\n        if (connectedBody && !connectedBody.enabledInHierarchy) {\r\n            return;\r\n        }\r\n\r\n        //if connected body is not set, use scene origin as connected body\r\n        if (!connectedBody) {\r\n            def.bodyB = (PhysicsSystem2D.instance.physicsWorld as b2PhysicsWorld).groundBodyImpl;\r\n        } else {\r\n            def.bodyB = connectedBody.impl!.impl;\r\n        }\r\n\r\n        def.collideConnected = comp.collideConnected;\r\n\r\n        this._b2joint = (PhysicsSystem2D.instance.physicsWorld as b2PhysicsWorld).impl.CreateJoint(def);\r\n\r\n        this._inited = true;\r\n    }\r\n\r\n    _destroy (): void {\r\n        if (!this._inited) return;\r\n\r\n        (PhysicsSystem2D.instance.physicsWorld as b2PhysicsWorld).impl.DestroyJoint(this._b2joint!);\r\n\r\n        this._b2joint = null;\r\n        this._inited = false;\r\n    }\r\n\r\n    _createJointDef (): b2.JointDef | null {\r\n        return null;\r\n    }\r\n\r\n    isValid (): Joint2D | null {\r\n        return this._b2joint && this._body && this._body.impl && this._jointComp;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { IMouseJoint } from '../../spec/i-physics-joint';\r\nimport { b2Joint } from './joint-2d';\r\nimport { MouseJoint2D, PhysicsSystem2D, Joint2D } from '../../framework';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework/physics-types';\r\nimport { IVec2Like, Vec2 } from '../../../core';\r\nimport { Touch } from '../../../input/types';\r\nimport { b2PhysicsWorld } from '../physics-world';\r\nimport { NodeEventType } from '../../../scene-graph/node-event';\r\nimport { find } from '../../../scene-graph';\r\n\r\nconst tempB2Vec2 = new b2.Vec2();\r\n\r\n/** @mangle */\r\nexport class b2MouseJoint extends b2Joint implements IMouseJoint {\r\n    _touchPoint = new Vec2();\r\n    _isTouched = false;\r\n\r\n    setTarget (v: IVec2Like): void {\r\n        if (this._b2joint) {\r\n            tempB2Vec2.x = v.x / PHYSICS_2D_PTM_RATIO;\r\n            tempB2Vec2.y = v.y / PHYSICS_2D_PTM_RATIO;\r\n            (this._b2joint as b2.MouseJoint).SetTarget(tempB2Vec2);\r\n        }\r\n    }\r\n    setDampingRatio (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.MouseJoint).SetDampingRatio(v);\r\n        }\r\n    }\r\n    setFrequency (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.MouseJoint).SetFrequency(v);\r\n        }\r\n    }\r\n    setMaxForce (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.MouseJoint).SetMaxForce(v);\r\n        }\r\n    }\r\n\r\n    override _createJointDef (): any {\r\n        const def = new b2.MouseJointDef();\r\n        const comp = this._jointComp as MouseJoint2D;\r\n        def.target.Set(\r\n            this._touchPoint.x / PHYSICS_2D_PTM_RATIO,\r\n            this._touchPoint.y / PHYSICS_2D_PTM_RATIO,\r\n        );\r\n        def.maxForce = comp.maxForce;\r\n        def.dampingRatio = comp.dampingRatio;\r\n        def.frequencyHz = comp.frequency;\r\n        return def;\r\n    }\r\n\r\n    override start (): void {\r\n        // empty implementation to override its parent's start, so don't remove it.\r\n    }\r\n\r\n    override onEnable (): void {\r\n        this._enableTouch(true);\r\n    }\r\n\r\n    override onDisable (): void {\r\n        super.onDisable();\r\n        this._enableTouch(false);\r\n    }\r\n\r\n    private _enableTouch (v: boolean): void {\r\n        const canvas = find('Canvas');\r\n        if (canvas) {\r\n            const cb = v ? canvas.on : canvas.off;\r\n            cb.call(canvas, NodeEventType.TOUCH_START, this.onTouchBegan, this);\r\n            cb.call(canvas, NodeEventType.TOUCH_MOVE, this.onTouchMove, this);\r\n            cb.call(canvas, NodeEventType.TOUCH_END, this.onTouchEnd, this);\r\n            cb.call(canvas, NodeEventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n        }\r\n    }\r\n\r\n    onTouchBegan (event: Touch): void {\r\n        this._isTouched = true;\r\n\r\n        const target = this._touchPoint.set(event.getUILocation());\r\n\r\n        const world = PhysicsSystem2D.instance.physicsWorld as b2PhysicsWorld;\r\n        const colliders = world.testPoint(target);\r\n        if (colliders.length <= 0) return;\r\n\r\n        const body = colliders[0].body;\r\n        body!.wakeUp();\r\n\r\n        const comp = this._jointComp as MouseJoint2D;\r\n        comp.connectedBody = body;\r\n\r\n        this._init();\r\n\r\n        this.setMaxForce(comp.maxForce * body!.getMass());\r\n        this.setTarget(target);\r\n    }\r\n\r\n    onTouchMove (event: Touch): void {\r\n        this._touchPoint = event.getUILocation();\r\n    }\r\n\r\n    onTouchEnd (event: Touch): void {\r\n        this._destroy();\r\n        this._isTouched = false;\r\n    }\r\n\r\n    update (): void {\r\n        if (!this._isTouched || !this.isValid()) {\r\n            return;\r\n        }\r\n\r\n        // let camera = cc.Camera.findCamera(this.node);\r\n        // if (camera) {\r\n        //     this.target = camera.getScreenToWorldPoint(this._touchPoint);\r\n        // }\r\n        // else {\r\n        this.setTarget(this._touchPoint);\r\n        // }\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { IDistanceJoint } from '../../spec/i-physics-joint';\r\nimport { b2Joint } from './joint-2d';\r\nimport { DistanceJoint2D } from '../../framework';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework/physics-types';\r\n\r\n/** @mangle */\r\nexport class b2DistanceJoint extends b2Joint implements IDistanceJoint {\r\n    setMaxLength (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.RopeJoint).SetMaxLength(v);\r\n        }\r\n    }\r\n\r\n    _createJointDef (): any {\r\n        const comp = this._jointComp as DistanceJoint2D;\r\n        const def = new b2.RopeJointDef();\r\n        def.localAnchorA.Set(comp.anchor.x / PHYSICS_2D_PTM_RATIO, comp.anchor.y / PHYSICS_2D_PTM_RATIO);\r\n        def.localAnchorB.Set(comp.connectedAnchor.x / PHYSICS_2D_PTM_RATIO, comp.connectedAnchor.y / PHYSICS_2D_PTM_RATIO);\r\n        def.maxLength = comp.maxLength / PHYSICS_2D_PTM_RATIO;\r\n        return def;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { ISpringJoint } from '../../spec/i-physics-joint';\r\nimport { b2Joint } from './joint-2d';\r\nimport { SpringJoint2D } from '../../framework';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework/physics-types';\r\n\r\n/** @mangle */\r\nexport class b2SpringJoint extends b2Joint implements ISpringJoint {\r\n    setDampingRatio (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.DistanceJoint).SetDampingRatio(v);\r\n        }\r\n    }\r\n    setFrequency (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.DistanceJoint).SetFrequency(v);\r\n        }\r\n    }\r\n    setDistance (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.DistanceJoint).SetLength(v);\r\n        }\r\n    }\r\n\r\n    _createJointDef (): any {\r\n        const comp = this._jointComp as SpringJoint2D;\r\n        const def = new b2.DistanceJointDef();\r\n        def.localAnchorA.Set(comp.anchor.x / PHYSICS_2D_PTM_RATIO, comp.anchor.y / PHYSICS_2D_PTM_RATIO);\r\n        def.localAnchorB.Set(comp.connectedAnchor.x / PHYSICS_2D_PTM_RATIO, comp.connectedAnchor.y / PHYSICS_2D_PTM_RATIO);\r\n        def.length = comp.distance / PHYSICS_2D_PTM_RATIO;\r\n        def.dampingRatio = comp.dampingRatio;\r\n        def.frequencyHz = comp.frequency;\r\n        return def;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2, { Vec2 } from '@cocos/box2d';\r\nimport { IRelativeJoint } from '../../spec/i-physics-joint';\r\nimport { b2Joint } from './joint-2d';\r\nimport { RelativeJoint2D } from '../../framework';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework/physics-types';\r\nimport { toRadian } from '../../../core';\r\n\r\n/** @mangle */\r\nexport class b2RelativeJoint extends b2Joint implements IRelativeJoint {\r\n    setMaxForce (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.MotorJoint).SetMaxForce(v);\r\n        }\r\n    }\r\n    setAngularOffset (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.MotorJoint).SetAngularOffset(toRadian(v));\r\n        }\r\n    }\r\n    setLinearOffset (v: Vec2): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.MotorJoint).SetLinearOffset(new b2.Vec2(v.x / PHYSICS_2D_PTM_RATIO, v.y / PHYSICS_2D_PTM_RATIO));\r\n        }\r\n    }\r\n    setCorrectionFactor (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.MotorJoint).m_correctionFactor = v;\r\n        }\r\n    }\r\n    setMaxTorque (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.MotorJoint).SetMaxTorque(v);\r\n        }\r\n    }\r\n\r\n    _createJointDef (): any {\r\n        const comp = this._jointComp as RelativeJoint2D;\r\n        const def = new b2.MotorJointDef();\r\n        def.linearOffset.Set(comp.linearOffset.x / PHYSICS_2D_PTM_RATIO, comp.linearOffset.y / PHYSICS_2D_PTM_RATIO);\r\n        def.angularOffset = toRadian(comp.angularOffset);\r\n        def.maxForce = comp.maxForce;\r\n        def.maxTorque = comp.maxTorque;\r\n        def.correctionFactor = comp.correctionFactor;\r\n        return def;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { ISliderJoint } from '../../spec/i-physics-joint';\r\nimport { b2Joint } from './joint-2d';\r\nimport { SliderJoint2D } from '../../framework';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework/physics-types';\r\nimport { toRadian } from '../../../core';\r\n\r\n/** @mangle */\r\nexport class b2SliderJoint extends b2Joint implements ISliderJoint {\r\n    // limit\r\n    enableLimit (v: boolean): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.PrismaticJoint).EnableLimit(v);\r\n        }\r\n    }\r\n    setLowerLimit (v: number): void {\r\n        this.updateLimits();\r\n    }\r\n    setUpperLimit (v: number): void {\r\n        this.updateLimits();\r\n    }\r\n    updateLimits (): void {\r\n        if (this._b2joint) {\r\n            const comp = this._jointComp as SliderJoint2D;\r\n            (this._b2joint as b2.PrismaticJoint).SetLimits(comp.lowerLimit / PHYSICS_2D_PTM_RATIO, comp.upperLimit / PHYSICS_2D_PTM_RATIO);\r\n        }\r\n    }\r\n\r\n    // motor\r\n    enableMotor (v: boolean): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.PrismaticJoint).EnableMotor(v);\r\n        }\r\n    }\r\n    setMaxMotorForce (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.PrismaticJoint).SetMaxMotorForce(v);\r\n        }\r\n    }\r\n    setMotorSpeed (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.PrismaticJoint).SetMotorSpeed(v);\r\n        }\r\n    }\r\n\r\n    _createJointDef (): any {\r\n        const comp = this._jointComp as SliderJoint2D;\r\n        const def = new b2.PrismaticJointDef();\r\n        def.localAnchorA.Set(comp.anchor.x / PHYSICS_2D_PTM_RATIO, comp.anchor.y / PHYSICS_2D_PTM_RATIO);\r\n        def.localAnchorB.Set(comp.connectedAnchor.x / PHYSICS_2D_PTM_RATIO, comp.connectedAnchor.y / PHYSICS_2D_PTM_RATIO);\r\n        const angle = toRadian(comp.angle);\r\n        def.localAxisA.Set(Math.cos(angle), Math.sin(angle));\r\n        def.referenceAngle = 0;\r\n        def.enableLimit = comp.enableLimit;\r\n        def.lowerTranslation = comp.lowerLimit / PHYSICS_2D_PTM_RATIO;\r\n        def.upperTranslation = comp.upperLimit / PHYSICS_2D_PTM_RATIO;\r\n        def.enableMotor = comp.enableMotor;\r\n        def.maxMotorForce = comp.maxMotorForce;\r\n        def.motorSpeed = comp.motorSpeed;\r\n        return def;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { IFixedJoint } from '../../spec/i-physics-joint';\r\nimport { b2Joint } from './joint-2d';\r\nimport { FixedJoint2D } from '../../framework';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework/physics-types';\r\n\r\n/** @mangle */\r\nexport class b2FixedJoint extends b2Joint implements IFixedJoint {\r\n    setFrequency (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.WeldJoint).SetFrequency(v);\r\n        }\r\n    }\r\n    setDampingRatio (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.WeldJoint).SetDampingRatio(v);\r\n        }\r\n    }\r\n\r\n    _createJointDef (): any {\r\n        const comp = this._jointComp as FixedJoint2D;\r\n        const def = new b2.WeldJointDef();\r\n        def.localAnchorA.Set(comp.anchor.x / PHYSICS_2D_PTM_RATIO, comp.anchor.y / PHYSICS_2D_PTM_RATIO);\r\n        def.localAnchorB.Set(comp.connectedAnchor.x / PHYSICS_2D_PTM_RATIO, comp.connectedAnchor.y / PHYSICS_2D_PTM_RATIO);\r\n        def.referenceAngle = 0;\r\n        def.frequencyHz = comp.frequency;\r\n        def.dampingRatio = comp.dampingRatio;\r\n        return def;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { IWheelJoint } from '../../spec/i-physics-joint';\r\nimport { WheelJoint2D } from '../../framework';\r\nimport { b2Joint } from './joint-2d';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework/physics-types';\r\nimport { toRadian } from '../../../core';\r\n\r\n/** @mangle */\r\nexport class b2WheelJoint extends b2Joint implements IWheelJoint {\r\n    setDampingRatio (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.WheelJoint).SetSpringDampingRatio(v);\r\n        }\r\n    }\r\n    setFrequency (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.WheelJoint).SetSpringFrequencyHz(v);\r\n        }\r\n    }\r\n\r\n    // motor\r\n    enableMotor (v: boolean): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.WheelJoint).EnableMotor(v);\r\n        }\r\n    }\r\n    setMaxMotorTorque (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.WheelJoint).SetMaxMotorTorque(v);\r\n        }\r\n    }\r\n    setMotorSpeed (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.WheelJoint).SetMotorSpeed(v);\r\n        }\r\n    }\r\n\r\n    _createJointDef (): any {\r\n        const comp = this._jointComp as WheelJoint2D;\r\n        const def = new b2.WheelJointDef();\r\n        def.localAnchorA.Set(comp.anchor.x / PHYSICS_2D_PTM_RATIO, comp.anchor.y / PHYSICS_2D_PTM_RATIO);\r\n        def.localAnchorB.Set(comp.connectedAnchor.x / PHYSICS_2D_PTM_RATIO, comp.connectedAnchor.y / PHYSICS_2D_PTM_RATIO);\r\n        const angle = toRadian(comp.angle);\r\n        def.localAxisA.Set(Math.cos(angle), Math.sin(angle));\r\n        // def.localAxisA.Set(0, 1);\r\n        def.maxMotorTorque = comp.maxMotorTorque;\r\n        def.motorSpeed = toRadian(comp.motorSpeed);\r\n        def.enableMotor = comp.enableMotor;\r\n        def.dampingRatio = comp.dampingRatio;\r\n        def.frequencyHz = comp.frequency;\r\n        return def;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport b2 from '@cocos/box2d';\r\nimport { IHingeJoint } from '../../spec/i-physics-joint';\r\nimport { HingeJoint2D } from '../../framework';\r\nimport { b2Joint } from './joint-2d';\r\nimport { PHYSICS_2D_PTM_RATIO } from '../../framework/physics-types';\r\nimport { toRadian } from '../../../core';\r\n\r\n/** @mangle */\r\nexport class b2HingeJoint extends b2Joint implements IHingeJoint {\r\n    enableLimit (v: boolean): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.RevoluteJoint).EnableLimit(v);\r\n        }\r\n    }\r\n    setLowerAngle (v: number): void {\r\n        this.updateLimits();\r\n    }\r\n    setUpperAngle (v: number): void {\r\n        this.updateLimits();\r\n    }\r\n    updateLimits (): void {\r\n        if (this._b2joint) {\r\n            const comp = this._jointComp as HingeJoint2D;\r\n            (this._b2joint as b2.RevoluteJoint).SetLimits(toRadian(comp.lowerAngle), toRadian(comp.upperAngle));\r\n        }\r\n    }\r\n\r\n    // motor\r\n    enableMotor (v: boolean): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.RevoluteJoint).EnableMotor(v);\r\n        }\r\n    }\r\n    setMaxMotorTorque (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.RevoluteJoint).SetMaxMotorTorque(v);\r\n        }\r\n    }\r\n    setMotorSpeed (v: number): void {\r\n        if (this._b2joint) {\r\n            (this._b2joint as b2.RevoluteJoint).SetMotorSpeed(v);\r\n        }\r\n    }\r\n\r\n    _createJointDef (): any {\r\n        const comp = this._jointComp as HingeJoint2D;\r\n        const def = new b2.RevoluteJointDef();\r\n        def.localAnchorA.Set(comp.anchor.x / PHYSICS_2D_PTM_RATIO, comp.anchor.y / PHYSICS_2D_PTM_RATIO);\r\n        def.localAnchorB.Set(comp.connectedAnchor.x / PHYSICS_2D_PTM_RATIO, comp.connectedAnchor.y / PHYSICS_2D_PTM_RATIO);\r\n\r\n        def.enableMotor = comp.enableMotor;\r\n        def.maxMotorTorque = comp.maxMotorTorque;\r\n        def.motorSpeed = toRadian(comp.motorSpeed);\r\n\r\n        def.enableLimit = comp.enableLimit;\r\n        def.lowerAngle = toRadian(comp.lowerAngle);\r\n        def.upperAngle = toRadian(comp.upperAngle);\r\n        return def;\r\n    }\r\n}\r\n","/*\r\n Copyright (c) 2022-2023 Xiamen Yaji Software Co., Ltd.\r\n\r\n https://www.cocos.com/\r\n\r\n Permission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights to\r\n use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\r\n of the Software, and to permit persons to whom the Software is furnished to do so,\r\n subject to the following conditions:\r\n\r\n The above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n*/\r\n\r\nimport { selector } from '../framework/physics-selector';\r\nimport { b2PhysicsWorld } from './physics-world';\r\nimport { b2RigidBody2D } from './rigid-body';\r\nimport { b2BoxShape } from './shapes/box-shape-2d';\r\nimport { b2CircleShape } from './shapes/circle-shape-2d';\r\nimport { b2PolygonShape } from './shapes/polygon-shape-2d';\r\nimport { b2MouseJoint } from './joints/mouse-joint';\r\nimport { b2DistanceJoint } from './joints/distance-joint';\r\nimport { b2SpringJoint } from './joints/spring-joint';\r\nimport { b2RelativeJoint } from './joints/relative-joint';\r\nimport { b2SliderJoint } from './joints/slider-joint';\r\nimport { b2FixedJoint } from './joints/fixed-joint';\r\nimport { b2WheelJoint } from './joints/wheel-joint';\r\nimport { b2HingeJoint } from './joints/hinge-joint';\r\n\r\nimport { Game, game } from '../../game';\r\n\r\ngame.once(Game.EVENT_PRE_SUBSYSTEM_INIT, () => {\r\n    selector.register('box2d', {\r\n        PhysicsWorld: b2PhysicsWorld,\r\n        RigidBody: b2RigidBody2D,\r\n\r\n        BoxShape: b2BoxShape,\r\n        CircleShape: b2CircleShape,\r\n        PolygonShape: b2PolygonShape,\r\n\r\n        MouseJoint: b2MouseJoint,\r\n        DistanceJoint: b2DistanceJoint,\r\n        SpringJoint: b2SpringJoint,\r\n        RelativeJoint: b2RelativeJoint,\r\n        SliderJoint: b2SliderJoint,\r\n        FixedJoint: b2FixedJoint,\r\n        WheelJoint: b2WheelJoint,\r\n        HingeJoint: b2HingeJoint,\r\n    });\r\n});\r\n"],"names":["PhysicsContactListener","_b2$ContactListener","_this","_len","arguments","length","args","Array","_key","call","apply","concat","_contactFixtures","_BeginContact","_EndContact","_PreSolve","_PostSolve","_inheritsLoose","_proto","prototype","setBeginContact","cb","setEndContact","setPreSolve","setPostSolve","BeginContact","contact","fixtureA","GetFixtureA","fixtureB","GetFixtureB","fixtures","_shouldReport","indexOf","EndContact","PreSolve","oldManifold","PostSolve","impulse","registerContactFixture","fixture","push","unregisterContactFixture","js","b2","ContactListener","PhysicsAABBQueryCallback","_b2$QueryCallback","_point","Vec2","_isPoint","_fixtures","init","point","x","y","ReportFixture","TestPoint","getFixture","getFixtures","QueryCallback","PhysicsRayCastCallback","_b2$RayCastCallback","_type","ERaycast2DType","Closest","_points","_normals","_fractions","_mask","type","mask","normal","fraction","GetFilterData","categoryBits","Any","All","getPoints","getNormals","getFractions","RayCastCallback","pools","pointCache","b2worldmanifold","WorldManifold","worldmanifold","points","separations","ManifoldPoint","localPoint","normalImpulse","tangentImpulse","manifoldPointCache","manifold","localNormal","normalImpulses","tangentImpulses","PhysicsContact","colliderA","colliderB","disabled","disabledOnce","_impulse","_inverted","_b2contact","get","b2contact","c","pop","put","m_userData","reset","_setImpulse","m_fixtureA","collider","m_fixtureB","setTangentSpeed","resetFriction","resetRestitution","getWorldManifold","GetWorldManifold","b2points","b2separations","count","GetManifold","pointCount","i","p","PHYSICS_2D_PTM_RATIO","getManifold","b2manifold","b2p","getImpulse","b2impulse","emit","contactType","_colliderA$body","_colliderB$body","hasListenerA","body","enabledContactListener","hasListenerB","PhysicsSystem2D","instance","setEnabled","value","SetEnabled","isTouching","IsTouching","SetTangentSpeed","getTangentSpeed","GetTangentSpeed","setFriction","SetFriction","getFriction","GetFriction","ResetFriction","setRestitution","SetRestitution","getRestitution","GetRestitution","ResetRestitution","_tmp_vec2","_tmp_color","Color","GREEN_COLOR","GREEN","RED_COLOR","RED","PhysicsDebugDraw","_b2$Draw","drawer","_drawer","_xf","Transform","_dxf","_DrawPolygon","vertices","vertexCount","MulXV","moveTo","lineTo","close","DrawPolygon","color","_applyStrokeColor","stroke","DrawSolidPolygon","_applyFillColor","fill","_DrawCircle","center","radius","circle","DrawCircle","DrawSolidCircle","axis","DrawSegment","p1","p2","DrawTransform","xf","strokeColor","DrawPoint","DrawParticles","set","r","g","b","fillColor","PushTransform","PopTransform","Draw","tempVec3","Vec3","tempVec2_1","tempVec2_2","temoBodyDef","BodyDef","tempB2AABB","AABB","testResults","b2PhysicsWorld","_world","_bodies","_animatedBodies","_rotationAxis","_physicsGroundBody","_contactListener","_aabbQueryCallback","_raycastQueryCallback","_debugGraphics","_b2DebugDrawer","_debugDrawFlags","World","tempBodyDef","CreateBody","listener","_onBeginContact","_onEndContact","_onPreSolve","_onPostSolve","SetContactListener","_checkDebugDrawValid","isValid","canvas","find","scene","director","getScene","Node","addComponent","parent","node","hideFlags","CCObjectFlags","DontSave","worldPosition","ZERO","layer","Layers","Enum","UI_2D","lineWidth","debugDraw","SetDebugDraw","e","errorID","message","destroy","setSiblingIndex","children","SetFlags","debugDrawFlags","setGravity","v","SetGravity","setAllowSleep","SetAllowSleeping","step","deltaTime","velocityIterations","positionIterations","animatedBodies","l","animate","Step","raycast","equals","callback","RayCast","normals","fractions","results","shape","AllClosest","result","j","fixtureIndex","getFixtureIndex","syncPhysicsToScene","bodies","bodyComp","rigidBody","ERigidBody2DType","Animated","resetVelocity","b2body","impl","pos","GetPosition","z","angle","toDegree","GetAngle","setWorldRotationFromEuler","syncSceneToPhysics","addBody","includes","bodyDef","comp","allowSleep","gravityScale","linearDamping","angularDamping","fixedRotation","bullet","position","Set","Quat","getAxisAngle","worldRotation","Math","PI","awake","awakeOnLoad","Kinematic","_animatedPos","_animatedAngle","compPrivate","linearVelocity","_linearVelocity","angularVelocity","_angularVelocity","b2Body","_imp","removeBody","DestroyBody","_updateBodyType","testPoint","d","lowerBound","upperBound","QueryAABB","testAABB","rect","xMin","yMin","xMax","yMax","drawDebug","clear","DrawDebugData","Contact2DType","BEGIN_CONTACT","END_CONTACT","PRE_SOLVE","POST_SOLVE","_createClass","key","b2RigidBody2D","_body","_rigidBody","_inited","initialize","com","_callAfterStep","_init","onDestroy","_destroy","onEnable","setActive","onDisable","nodeTransformChanged","stepping","TransformBit","SCALE","colliders","getComponents","Collider2D","POSITION","syncPositionToPhysics","ROTATION","syncRotationToPhysics","physicsWorld","dt","b2Pos","SetAwake","timeStep","SetLinearVelocity","b2Rotation","TWO_PI","HALF_PI","SetAngularVelocity","dirty","hasChangedFlags","enableAnimated","temp","bodyType","GetLinearVelocity","SetTransformVec","rot","euler","toEulerInYXZOrder","rotation","toRadian","m_linearVelocity","setType","SetType","setLinearDamping","SetLinearDamping","setAngularDamping","SetAngularDamping","setGravityScale","SetGravityScale","setFixedRotation","SetFixedRotation","SetSleepingAllowed","isActive","IsActive","m_world","IsLocked","SetActive","warn","wakeUp","sleep","getMass","GetMass","setLinearVelocity","getLinearVelocity","out","velocity","getLinearVelocityFromWorldPoint","worldPoint","GetLinearVelocityFromWorldPoint","setAngularVelocity","getAngularVelocity","GetAngularVelocity","getLocalVector","worldVector","GetLocalVector","getWorldVector","localVector","GetWorldVector","getLocalPoint","GetLocalPoint","getWorldPoint","GetWorldPoint","getLocalCenter","GetLocalCenter","getWorldCenter","GetWorldCenter","getInertia","GetInertia","applyForce","force","wake","ApplyForce","applyForceToCenter","ApplyForceToCenter","applyTorque","torque","ApplyTorque","applyLinearImpulse","ApplyLinearImpulse","applyLinearImpulseToCenter","applyAngularImpulse","ApplyAngularImpulse","IsAwake","tempFilter","Filter","getFilter","group","PhysicsGroup","DEFAULT","maskBits","collisionMatrix","b2Shape2D","_shapes","_collider","_rect","Rect","onLoad","start","onGroupChanged","filter","forEach","f","SetFilterData","enabledInHierarchy","_createShapes","scaleX","scaleY","relativePositionX","relativePositionY","scale","worldScale","relativePosition","getComponent","RigidBody2D","groundBodyImpl","shapes","fixDef","density","isSensor","sensor","friction","restitution","CreateFixture","DestroyFixture","MAX","minX","minY","maxX","maxY","GetShape","GetChildCount","Copy","GetAABB","m_type","skinWidth","m_radius","SelfAddXY","SelfSubXY","width","height","tempAabb","b2BoxShape","_b2Shape2D","_worldPoints","abs","size","offsetX","offset","offsetY","PolygonShape","SetAsBox","aabb","wps","wp0","wp1","wp2","wp3","transformMat4ToPoints","worldMatrix","b2CircleShape","_worldPosition","CircleShape","m_p","b2PolygonShape","polys","PolygonPartition","logID","name","poly","firstVertice","maxPolygonVertices","worldPoints","m","transformMat4","b2Joint","_b2joint","_jointComp","def","_createJointDef","bodyA","connectedBody","bodyB","collideConnected","CreateJoint","DestroyJoint","tempB2Vec2","b2MouseJoint","_b2Joint","_touchPoint","_isTouched","setTarget","SetTarget","setDampingRatio","SetDampingRatio","setFrequency","SetFrequency","setMaxForce","SetMaxForce","MouseJointDef","target","maxForce","dampingRatio","frequencyHz","frequency","_enableTouch","on","off","NodeEventType","TOUCH_START","onTouchBegan","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","TOUCH_CANCEL","event","getUILocation","world","update","b2DistanceJoint","setMaxLength","SetMaxLength","RopeJointDef","localAnchorA","anchor","localAnchorB","connectedAnchor","maxLength","b2SpringJoint","setDistance","SetLength","DistanceJointDef","distance","b2RelativeJoint","setAngularOffset","SetAngularOffset","setLinearOffset","SetLinearOffset","setCorrectionFactor","m_correctionFactor","setMaxTorque","SetMaxTorque","MotorJointDef","linearOffset","angularOffset","maxTorque","correctionFactor","b2SliderJoint","enableLimit","EnableLimit","setLowerLimit","updateLimits","setUpperLimit","SetLimits","lowerLimit","upperLimit","enableMotor","EnableMotor","setMaxMotorForce","SetMaxMotorForce","setMotorSpeed","SetMotorSpeed","PrismaticJointDef","localAxisA","cos","sin","referenceAngle","lowerTranslation","upperTranslation","maxMotorForce","motorSpeed","b2FixedJoint","WeldJointDef","b2WheelJoint","SetSpringDampingRatio","SetSpringFrequencyHz","setMaxMotorTorque","SetMaxMotorTorque","WheelJointDef","maxMotorTorque","b2HingeJoint","setLowerAngle","setUpperAngle","lowerAngle","upperAngle","RevoluteJointDef","game","once","Game","EVENT_PRE_SUBSYSTEM_INIT","selector","register","PhysicsWorld","RigidBody","BoxShape","MouseJoint","DistanceJoint","SpringJoint","RelativeJoint","SliderJoint","FixedJoint","WheelJoint","HingeJoint"],"mappings":"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"}