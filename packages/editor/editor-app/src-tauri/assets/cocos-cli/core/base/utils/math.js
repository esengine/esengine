'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
exports.clamp = clamp;
exports.clamp01 = clamp01;
exports.add = add;
exports.sub = sub;
exports.multi = multi;
exports.divide = divide;
exports.toFixed = toFixed;
/**
 * 取给定边界范围的值
 * Take the value of the given boundary range
 * @param {number} val
 * @param {number} min
 * @param {number} max
 */
function clamp(val, min, max) {
    return Math.min.call(null, Math.max.call(null, val, min), max);
}
/**
 * 将给定的数值限制在0到1的范围内。
 * @param val 需要限制的数值。
 * @returns 返回限制后的数值，确保在0到1之间。
 */
function clamp01(val) {
    return clamp(val, 0, 1);
}
/**
 * 加法函数
 * 入参：函数内部转化时会先转字符串再转数值，因而传入字符串或 number 均可
 * 返回值：arg1 加上 arg2 的精确结果
 * @param {number|string} arg1
 * @param {number|string} arg2
 */
function add(arg1, arg2) {
    arg1 = toValidNumber(arg1);
    arg2 = toValidNumber(arg2);
    const { maxPow, num1, num2 } = _computeMaxPow(arg1, arg2);
    return (num1 + num2) / maxPow;
}
/**
 * 减法函数
 * 入参：函数内部转化时会先转字符串再转数值，因而传入字符串或 number 均可
 * 返回值：arg1 减 arg2的精确结果
 * @param {number|string} arg1
 * @param {number|string} arg2
 */
function sub(arg1, arg2) {
    arg1 = toValidNumber(arg1);
    arg2 = toValidNumber(arg2);
    const { maxPow, num1, num2 } = _computeMaxPow(arg1, arg2);
    return (num1 - num2) / maxPow;
}
/**
 * 乘法函数
 * @param arg1
 * @param arg2
 * @returns
 */
function multi(arg1, arg2) {
    arg1 = toValidNumber(arg1);
    arg2 = toValidNumber(arg2);
    const { maxPow, num1, num2 } = _computeMaxPow(arg1, arg2);
    return num1 * num2 / maxPow / maxPow;
}
/**
 * 除法函数
 * @param arg1
 * @param arg2
 * @returns
 */
function divide(arg1, arg2) {
    arg1 = toValidNumber(arg1);
    arg2 = toValidNumber(arg2);
    if (!arg2) {
        return arg1 > 0 ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY;
    }
    const { num1, num2 } = _computeMaxPow(arg1, arg2);
    return num1 / num2;
}
function toValidNumber(str) {
    str = Number(str);
    // 需要判断是否是无限大或者是无限小
    if (typeof str === 'number' && !Number.isNaN(str) && isFinite(str)) {
        return str;
    }
    throw new Error(`Invalid params ${str}`);
}
/**
 * 计算两个数值小数点位数的最大位数与10的乘积,与最大精度
 * 入参：函数内部转化时会先转字符串再转数值，因而传入字符串或number均可
 * 返回值：
 * @param {number|string} arg1
 * @param {number|string} arg2
 */
function _computeMaxPow(arg1, arg2) {
    let maxPreci;
    const str1 = toNonExponential(arg1);
    const str2 = toNonExponential(arg2);
    const r1 = _comPreci(str1);
    const r2 = _comPreci(str2);
    maxPreci = Math.max(r1, r2);
    const maxPow = Math.pow(10, maxPreci);
    if (maxPreci > 20) {
        maxPreci = 20;
    }
    const num1 = Number(str1.replace('.', '') + Array(maxPreci - r1).fill(0).join(''));
    const num2 = Number(str2.replace('.', '') + Array(maxPreci - r2).fill(0).join(''));
    return {
        maxPow,
        maxPreci,
        num1,
        num2,
    };
}
/**
 * 移除科学计数法，转为正常的小数点形式
 * @param num
 * @returns
 */
function toNonExponential(num) {
    const m = num.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);
    return num.toFixed(Math.max(0, (m[1] || '').length - Number(m[2])));
}
/**
 * 计算数值的精度（小数点位数）
 * 返回值：该数值的小数点位数
 * @param {Number || String} value
 */
function _comPreci(value) {
    let rang;
    try {
        rang = value.split('.')[1].length;
    }
    catch (error) {
        rang = 0;
    }
    return rang;
}
/**
 * 保留小数点
 * @param val
 * @param num
 */
function toFixed(val, num) {
    return parseFloat((Math.round(val * Math.pow(10, num)) / Math.pow(10, num)).toFixed(num));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0aC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb3JlL2Jhc2UvdXRpbHMvbWF0aC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUFZLENBQUM7O0FBU2Isc0JBRUM7QUFPRCwwQkFFQztBQVNELGtCQUtDO0FBU0Qsa0JBS0M7QUFRRCxzQkFLQztBQVFELHdCQVFDO0FBMEVELDBCQUVDO0FBdkpEOzs7Ozs7R0FNRztBQUNILFNBQWdCLEtBQUssQ0FBQyxHQUFXLEVBQUUsR0FBVyxFQUFFLEdBQVc7SUFDdkQsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUNuRSxDQUFDO0FBRUQ7Ozs7R0FJRztBQUNILFNBQWdCLE9BQU8sQ0FBQyxHQUFXO0lBQy9CLE9BQU8sS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDNUIsQ0FBQztBQUVEOzs7Ozs7R0FNRztBQUNILFNBQWdCLEdBQUcsQ0FBQyxJQUFxQixFQUFFLElBQXFCO0lBQzVELElBQUksR0FBRyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDM0IsSUFBSSxHQUFHLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMzQixNQUFNLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsR0FBRyxjQUFjLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzFELE9BQU8sQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDO0FBQ2xDLENBQUM7QUFFRDs7Ozs7O0dBTUc7QUFDSCxTQUFnQixHQUFHLENBQUMsSUFBcUIsRUFBRSxJQUFxQjtJQUM1RCxJQUFJLEdBQUcsYUFBYSxDQUFDLElBQUksQ0FBQyxD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QUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQzlGLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcblxyXG4vKipcclxuICog5Y+W57uZ5a6a6L6555WM6IyD5Zu055qE5YC8XHJcbiAqIFRha2UgdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBib3VuZGFyeSByYW5nZVxyXG4gKiBAcGFyYW0ge251bWJlcn0gdmFsXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBtaW5cclxuICogQHBhcmFtIHtudW1iZXJ9IG1heFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNsYW1wKHZhbDogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIE1hdGgubWluLmNhbGwobnVsbCwgTWF0aC5tYXguY2FsbChudWxsLCB2YWwsIG1pbiksIG1heCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlsIbnu5nlrprnmoTmlbDlgLzpmZDliLblnKgw5YiwMeeahOiMg+WbtOWGheOAglxyXG4gKiBAcGFyYW0gdmFsIOmcgOimgemZkOWItueahOaVsOWAvOOAglxyXG4gKiBAcmV0dXJucyDov5Tlm57pmZDliLblkI7nmoTmlbDlgLzvvIznoa7kv53lnKgw5YiwMeS5i+mXtOOAglxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNsYW1wMDEodmFsOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIGNsYW1wKHZhbCwgMCwgMSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDliqDms5Xlh73mlbBcclxuICog5YWl5Y+C77ya5Ye95pWw5YaF6YOo6L2s5YyW5pe25Lya5YWI6L2s5a2X56ym5Liy5YaN6L2s5pWw5YC877yM5Zug6ICM5Lyg5YWl5a2X56ym5Liy5oiWIG51bWJlciDlnYflj69cclxuICog6L+U5Zue5YC877yaYXJnMSDliqDkuIogYXJnMiDnmoTnsr7noa7nu5PmnpxcclxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSBhcmcxXHJcbiAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30gYXJnMlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGFkZChhcmcxOiBudW1iZXIgfCBzdHJpbmcsIGFyZzI6IG51bWJlciB8IHN0cmluZykge1xyXG4gICAgYXJnMSA9IHRvVmFsaWROdW1iZXIoYXJnMSk7XHJcbiAgICBhcmcyID0gdG9WYWxpZE51bWJlcihhcmcyKTtcclxuICAgIGNvbnN0IHsgbWF4UG93LCBudW0xLCBudW0yIH0gPSBfY29tcHV0ZU1heFBvdyhhcmcxLCBhcmcyKTtcclxuICAgIHJldHVybiAobnVtMSArIG51bTIpIC8gbWF4UG93O1xyXG59XHJcblxyXG4vKipcclxuICog5YeP5rOV5Ye95pWwXHJcbiAqIOWFpeWPgu+8muWHveaVsOWGhemDqOi9rOWMluaXtuS8muWFiOi9rOWtl+espuS4suWGjei9rOaVsOWAvO+8jOWboOiAjOS8oOWFpeWtl+espuS4suaIliBudW1iZXIg5Z2H5Y+vXHJcbiAqIOi/lOWbnuWAvO+8mmFyZzEg5YePIGFyZzLnmoTnsr7noa7nu5PmnpxcclxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSBhcmcxXHJcbiAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30gYXJnMlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHN1YihhcmcxOiBudW1iZXIgfCBzdHJpbmcsIGFyZzI6IG51bWJlciB8IHN0cmluZykge1xyXG4gICAgYXJnMSA9IHRvVmFsaWROdW1iZXIoYXJnMSk7XHJcbiAgICBhcmcyID0gdG9WYWxpZE51bWJlcihhcmcyKTtcclxuICAgIGNvbnN0IHsgbWF4UG93LCBudW0xLCBudW0yIH0gPSBfY29tcHV0ZU1heFBvdyhhcmcxLCBhcmcyKTtcclxuICAgIHJldHVybiAobnVtMSAtIG51bTIpIC8gbWF4UG93O1xyXG59XHJcblxyXG4vKipcclxuICog5LmY5rOV5Ye95pWwXHJcbiAqIEBwYXJhbSBhcmcxIFxyXG4gKiBAcGFyYW0gYXJnMiBcclxuICogQHJldHVybnMgXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbXVsdGkoYXJnMTogbnVtYmVyIHwgc3RyaW5nLCBhcmcyOiBudW1iZXIgfCBzdHJpbmcpIHtcclxuICAgIGFyZzEgPSB0b1ZhbGlkTnVtYmVyKGFyZzEpO1xyXG4gICAgYXJnMiA9IHRvVmFsaWROdW1iZXIoYXJnMik7XHJcbiAgICBjb25zdCB7IG1heFBvdywgbnVtMSwgbnVtMiB9ID0gX2NvbXB1dGVNYXhQb3coYXJnMSwgYXJnMik7XHJcbiAgICByZXR1cm4gbnVtMSAqIG51bTIgLyBtYXhQb3cgLyBtYXhQb3c7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDpmaTms5Xlh73mlbBcclxuICogQHBhcmFtIGFyZzEgXHJcbiAqIEBwYXJhbSBhcmcyIFxyXG4gKiBAcmV0dXJucyBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBkaXZpZGUoYXJnMTogbnVtYmVyIHwgc3RyaW5nLCBhcmcyOiBudW1iZXIgfCBzdHJpbmcpIHtcclxuICAgIGFyZzEgPSB0b1ZhbGlkTnVtYmVyKGFyZzEpO1xyXG4gICAgYXJnMiA9IHRvVmFsaWROdW1iZXIoYXJnMik7XHJcbiAgICBpZiAoIWFyZzIpIHtcclxuICAgICAgICByZXR1cm4gYXJnMSA+IDAgPyBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgOiBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IG51bTEsIG51bTIgfSA9IF9jb21wdXRlTWF4UG93KGFyZzEsIGFyZzIpO1xyXG4gICAgcmV0dXJuIG51bTEgLyBudW0yO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0b1ZhbGlkTnVtYmVyKHN0cjogc3RyaW5nIHwgbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIHN0ciA9IE51bWJlcihzdHIpO1xyXG4gICAgLy8g6ZyA6KaB5Yik5pat5piv5ZCm5piv5peg6ZmQ5aSn5oiW6ICF5piv5peg6ZmQ5bCPXHJcbiAgICBpZiAodHlwZW9mIHN0ciA9PT0gJ251bWJlcicgJiYgIU51bWJlci5pc05hTihzdHIpICYmIGlzRmluaXRlKHN0cikpIHtcclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgfVxyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHBhcmFtcyAke3N0cn1gKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOiuoeeul+S4pOS4quaVsOWAvOWwj+aVsOeCueS9jeaVsOeahOacgOWkp+S9jeaVsOS4jjEw55qE5LmY56evLOS4juacgOWkp+eyvuW6plxyXG4gKiDlhaXlj4LvvJrlh73mlbDlhoXpg6jovazljJbml7bkvJrlhYjovazlrZfnrKbkuLLlho3ovazmlbDlgLzvvIzlm6DogIzkvKDlhaXlrZfnrKbkuLLmiJZudW1iZXLlnYflj69cclxuICog6L+U5Zue5YC877yaXHJcbiAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30gYXJnMVxyXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IGFyZzJcclxuICovXHJcbmZ1bmN0aW9uIF9jb21wdXRlTWF4UG93KGFyZzE6IG51bWJlciwgYXJnMjogbnVtYmVyKSB7XHJcbiAgICBsZXQgbWF4UHJlY2k7XHJcblxyXG4gICAgY29uc3Qgc3RyMSA9IHRvTm9uRXhwb25lbnRpYWwoYXJnMSk7XHJcbiAgICBjb25zdCBzdHIyID0gdG9Ob25FeHBvbmVudGlhbChhcmcyKTtcclxuXHJcbiAgICBjb25zdCByMSA9IF9jb21QcmVjaShzdHIxKTtcclxuICAgIGNvbnN0IHIyID0gX2NvbVByZWNpKHN0cjIpO1xyXG5cclxuICAgIG1heFByZWNpID0gTWF0aC5tYXgocjEsIHIyKTtcclxuXHJcbiAgICBjb25zdCBtYXhQb3cgPSBNYXRoLnBvdygxMCwgbWF4UHJlY2kpO1xyXG5cclxuICAgIGlmIChtYXhQcmVjaSA+IDIwKSB7XHJcbiAgICAgICAgbWF4UHJlY2kgPSAyMDtcclxuICAgIH1cclxuICAgIGNvbnN0IG51bTEgPSBOdW1iZXIoc3RyMS5yZXBsYWNlKCcuJywgJycpICsgQXJyYXkobWF4UHJlY2kgLSByMSkuZmlsbCgwKS5qb2luKCcnKSk7XHJcbiAgICBjb25zdCBudW0yID0gTnVtYmVyKHN0cjIucmVwbGFjZSgnLicsICcnKSArIEFycmF5KG1heFByZWNpIC0gcjIpLmZpbGwoMCkuam9pbignJykpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBtYXhQb3csXHJcbiAgICAgICAgbWF4UHJlY2ksXHJcbiAgICAgICAgbnVtMSxcclxuICAgICAgICBudW0yLFxyXG4gICAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOenu+mZpOenkeWtpuiuoeaVsOazle+8jOi9rOS4uuato+W4uOeahOWwj+aVsOeCueW9ouW8j1xyXG4gKiBAcGFyYW0gbnVtIFxyXG4gKiBAcmV0dXJucyBcclxuICovXHJcbmZ1bmN0aW9uIHRvTm9uRXhwb25lbnRpYWwobnVtOiBudW1iZXIpIHtcclxuICAgIGNvbnN0IG0gPSBudW0udG9FeHBvbmVudGlhbCgpLm1hdGNoKC9cXGQoPzpcXC4oXFxkKikpP2UoWystXVxcZCspLykgYXMgdW5rbm93biBhcyBzdHJpbmdbXTtcclxuICAgIHJldHVybiBudW0udG9GaXhlZChNYXRoLm1heCgwLCAobVsxXSB8fCAnJykubGVuZ3RoIC0gTnVtYmVyKG1bMl0pKSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDorqHnrpfmlbDlgLznmoTnsr7luqbvvIjlsI/mlbDngrnkvY3mlbDvvIlcclxuICog6L+U5Zue5YC877ya6K+l5pWw5YC855qE5bCP5pWw54K55L2N5pWwXHJcbiAqIEBwYXJhbSB7TnVtYmVyIHx8IFN0cmluZ30gdmFsdWVcclxuICovXHJcbmZ1bmN0aW9uIF9jb21QcmVjaSh2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICBsZXQgcmFuZztcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmFuZyA9IHZhbHVlLnNwbGl0KCcuJylbMV0ubGVuZ3RoO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICByYW5nID0gMDtcclxuICAgIH1cclxuICAgIHJldHVybiByYW5nO1xyXG59XHJcblxyXG4vKipcclxuICog5L+d55WZ5bCP5pWw54K5XHJcbiAqIEBwYXJhbSB2YWwgXHJcbiAqIEBwYXJhbSBudW0gXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdG9GaXhlZCh2YWw6IG51bWJlciwgbnVtOiBudW1iZXIpIHtcclxuICAgIHJldHVybiBwYXJzZUZsb2F0KChNYXRoLnJvdW5kKHZhbCAqIE1hdGgucG93KDEwLCBudW0pKSAvIE1hdGgucG93KDEwLCBudW0pKS50b0ZpeGVkKG51bSkpO1xyXG59XHJcbiJdfQ==