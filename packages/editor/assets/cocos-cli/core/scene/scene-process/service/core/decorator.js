"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Service = void 0;
exports.register = register;
exports.getServiceAll = getServiceAll;
require("reflect-metadata");
// 真正的存储容器
const _serviceRegistry = {};
/** 类装饰器：注册 Service 类，自动收集所有公有方法 */
function register(name) {
    return (target) => {
        const instance = new target();
        const managerName = (name || target.name);
        _serviceRegistry[managerName] = instance;
        console.log(`[Manager] Registered: ${managerName}`);
    };
}
/**
 * 全局代理：通过 Service.Editor.xxx() 访问
 */
exports.Service = new Proxy({}, {
    get(_, prop) {
        const svc = _serviceRegistry[prop];
        if (!svc) {
            throw new Error(`[Service] '${prop}' is not registered.`);
        }
        return svc;
    },
});
/**
 * 获取全部 Service
 */
function getServiceAll() {
    return Object.values(_serviceRegistry);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVjb3JhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2NvcmUvc2NlbmUvc2NlbmUtcHJvY2Vzcy9zZXJ2aWNlL2NvcmUvZGVjb3JhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQStCQSw0QkFRQztBQWtCRCxzQ0FFQztBQTNERCw0QkFBMEI7QUEyQjFCLFVBQVU7QUFDVixNQUFNLGdCQUFnQixHQUF3QixFQUFFLENBQUM7QUFFakQsbUNBQW1DO0FBQ25DLFNBQWdCLFFBQVEsQ0FBQyxJQUFhO0lBQ2xDLE9BQU8sQ0FBQyxNQUFXLEVBQUUsRUFBRTtRQUNuQixNQUFNLFFBQVEsR0FBRyxJQUFJLE1BQU0sRUFBRSxDQUFDO1FBQzlCLE1BQU0sV0FBVyxHQUFHLENBQUMsSUFBSSxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQWdCLENBQUM7UUFFekQsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLEdBQUcsUUFBUSxDQUFDO1FBQ3pDLE9BQU8sQ0FBQyxHQUFHLENBQUMseUJBQXlCLFdBQVcsRUFBRSxDQUFDLENBQUM7SUFDeEQsQ0FBQyxDQUFDO0FBQ04sQ0FBQztBQUVEOztHQUVHO0FBQ1UsUUFBQSxPQUFPLEdBQUcsSUFBSSxLQUFLLENBQUMsRUFBcUIsRUFBRTtJQUNwRCxHQUFHLENBQUMsQ0FBQyxFQUFFLElBQVk7UUFDZixNQUFNLEdBQUcsR0FBRyxnQkFBZ0IsQ0FBQyxJQUFtQixDQUFDLENBQUM7UUFDbEQsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ1AsTUFBTSxJQUFJLEtBQUssQ0FBQyxjQUFjLElBQUksc0JBQXNCLENBQUMsQ0FBQztRQUM5RCxDQUFDO1FBQ0QsT0FBTyxHQUFHLENBQUM7SUFDZixDQUFDO0NBQ0osQ0FBQyxDQUFDO0FBRUg7O0dBRUc7QUFDSCxTQUFnQixhQUFhO0lBQ3pCLE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBQzNDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJ3JlZmxlY3QtbWV0YWRhdGEnO1xyXG5pbXBvcnQgdHlwZSB7IElTZXJ2aWNlTWFuYWdlciB9IGZyb20gJy4uL2ludGVyZmFjZXMnO1xyXG5cclxuLyoqXHJcbiAqIOiMg+S+i1xyXG4gKiBAcmVnaXN0ZXIoJ1NjZW5lJylcclxuICogY2xhc3MgU2NlbmVNYW5hZ2VyIHtcclxuICogICBsb2FkU2NlbmUobmFtZTogc3RyaW5nKSB7XHJcbiAqICAgICBjb25zb2xlLmxvZyhgbG9hZGluZyBzY2VuZTogJHtuYW1lfWApO1xyXG4gKiAgIH1cclxuICpcclxuICogICB1bmxvYWRTY2VuZShuYW1lOiBzdHJpbmcpIHtcclxuICogICAgIGNvbnNvbGUubG9nKGB1bmxvYWRpbmcgc2NlbmU6ICR7bmFtZX1gKTtcclxuICogICB9XHJcbiAqXHJcbiAqICAgcHJpdmF0ZSBpbnRlcm5hbCgpIHtcclxuICogICAgIGNvbnNvbGUubG9nKCdwcml2YXRlIGxvZ2ljJyk7XHJcbiAqICAgfVxyXG4gKiB9XHJcbiAqXHJcbiAqIC8vIOS9v+eUqFxyXG4gKiBpbXBvcnQgeyBTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlJztcclxuICogU2VydmljZS5FZGl0b3IubG9hZFNjZW5lKCdNYWluJyk7XHJcbiAqL1xyXG5cclxuZXhwb3J0IHR5cGUgU2VydmljZU5hbWUgPSBrZXlvZiBJU2VydmljZU1hbmFnZXI7IC8vICdTY2VuZScgfCAnTm9kZScgfCAnU2NyaXB0JyAuLi5cclxuXHJcbi8vIOecn+ato+eahOWtmOWCqOWuueWZqFxyXG5jb25zdCBfc2VydmljZVJlZ2lzdHJ5OiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XHJcblxyXG4vKiog57G76KOF6aWw5Zmo77ya5rOo5YaMIFNlcnZpY2Ug57G777yM6Ieq5Yqo5pS26ZuG5omA5pyJ5YWs5pyJ5pa55rOVICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlcihuYW1lPzogc3RyaW5nKTogQ2xhc3NEZWNvcmF0b3Ige1xyXG4gICAgcmV0dXJuICh0YXJnZXQ6IGFueSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGluc3RhbmNlID0gbmV3IHRhcmdldCgpO1xyXG4gICAgICAgIGNvbnN0IG1hbmFnZXJOYW1lID0gKG5hbWUgfHwgdGFyZ2V0Lm5hbWUpIGFzIFNlcnZpY2VOYW1lO1xyXG5cclxuICAgICAgICBfc2VydmljZVJlZ2lzdHJ5W21hbmFnZXJOYW1lXSA9IGluc3RhbmNlO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbTWFuYWdlcl0gUmVnaXN0ZXJlZDogJHttYW5hZ2VyTmFtZX1gKTtcclxuICAgIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlhajlsYDku6PnkIbvvJrpgJrov4cgU2VydmljZS5FZGl0b3IueHh4KCkg6K6/6ZeuXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgU2VydmljZSA9IG5ldyBQcm94eSh7fSBhcyBJU2VydmljZU1hbmFnZXIsIHtcclxuICAgIGdldChfLCBwcm9wOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBzdmMgPSBfc2VydmljZVJlZ2lzdHJ5W3Byb3AgYXMgU2VydmljZU5hbWVdO1xyXG4gICAgICAgIGlmICghc3ZjKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW1NlcnZpY2VdICcke3Byb3B9JyBpcyBub3QgcmVnaXN0ZXJlZC5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN2YztcclxuICAgIH0sXHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIOiOt+WPluWFqOmDqCBTZXJ2aWNlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZUFsbCgpIHtcclxuICAgIHJldHVybiBPYmplY3QudmFsdWVzKF9zZXJ2aWNlUmVnaXN0cnkpO1xyXG59XHJcbiJdfQ==