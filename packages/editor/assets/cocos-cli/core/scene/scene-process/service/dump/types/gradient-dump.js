"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.gradientDump = void 0;
class GradientDump {
    encode(object, data, opts) {
        // 直接修改 object 会修改到默认值（对象引用问题）
        const dump = JSON.parse(JSON.stringify(object));
        delete dump._color; // _color 值是随机运算的结果，需要去掉
        if (object.colorKeys.length > 0) {
            object.colorKeys.forEach((item, index) => {
                const color = [];
                color[0] = item.color.r;
                color[1] = item.color.g;
                color[2] = item.color.b;
                dump.colorKeys[index].color = color;
            });
        }
        data.value = dump;
    }
    decode(data, info, dump, opts) {
        // 获取需要修改的数据
        const ccType = cc.js.getClassByName('cc.Gradient');
        const gradient = new ccType();
        if (dump.value.alphaKeys.length > 0) {
            for (const item of dump.value.alphaKeys) {
                const AlphaKeyCtor = cc.js.getClassByName('cc.AlphaKey');
                const alphaKey = new AlphaKeyCtor();
                alphaKey.time = item.time;
                alphaKey.alpha = item.alpha;
                gradient.alphaKeys.push(alphaKey);
            }
        }
        if (dump.value.colorKeys.length > 0) {
            for (const item of dump.value.colorKeys) {
                const ColorKeyCtor = cc.js.getClassByName('cc.ColorKey');
                const ColorCtor = cc.js.getClassByName('cc.Color');
                const colorKey = new ColorKeyCtor();
                colorKey.time = item.time;
                item.color && (colorKey.color = new ColorCtor(...item.color));
                gradient.colorKeys.push(colorKey);
            }
        }
        data[info.key] = gradient;
    }
}
exports.gradientDump = new GradientDump();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JhZGllbnQtZHVtcC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3NyYy9jb3JlL3NjZW5lL3NjZW5lLXByb2Nlc3Mvc2VydmljZS9kdW1wL3R5cGVzL2dyYWRpZW50LWR1bXAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBTUEsTUFBTSxZQUFZO0lBQ1AsTUFBTSxDQUFDLE1BQVcsRUFBRSxJQUFlLEVBQUUsSUFBVTtRQUNsRCw4QkFBOEI7UUFDOUIsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDaEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsd0JBQXdCO1FBRTVDLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7WUFDOUIsTUFBTSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFTLEVBQUUsS0FBYSxFQUFFLEVBQUU7Z0JBQ2xELE1BQU0sS0FBSyxHQUFHLEVBQUUsQ0FBQztnQkFDakIsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO2dCQUN4QixLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7Z0JBQ3hCLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztnQkFDeEIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1lBQ3hDLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQztRQUNELElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO0lBQ3RCLENBQUM7SUFFTSxNQUFNLENBQUMsSUFBUyxFQUFFLElBQVMsRUFBRSxJQUFTLEVBQUUsSUFBVTtRQUNyRCxZQUFZO1FBQ1osTUFBTSxNQUFNLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDbkQsTUFBTSxRQUFRLEdBQUcsSUFBSSxNQUFNLEVBQUUsQ0FBQztRQUM5QixJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUNsQyxLQUFLLE1BQU0sSUFBSSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxFQUFFLENBQUM7Z0JBQ3RDLE1BQU0sWUFBWSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQyxDQUFDO2dCQUN6RCxNQUFNLFFBQVEsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO2dCQUNwQyxRQUFRLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUM7Z0JBQzFCLFFBQVEsQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQztnQkFDNUIsUUFBUSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDdEMsQ0FBQztRQUNMLENBQUM7UUFFRCxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUNsQyxLQUFLLE1BQU0sSUFBSSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxFQUFFLENBQUM7Z0JBQ3RDLE1BQU0sWUFBWSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQyxDQUFDO2dCQUN6RCxNQUFNLFNBQVMsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztnQkFDbkQsTUFBTSxRQUFRLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztnQkFDcEMsUUFBUSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO2dCQUMxQixJQUFJLENBQUMsS0FBSyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssR0FBRyxJQUFJLFNBQVMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO2dCQUM5RCxRQUFRLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN0QyxDQUFDO1FBQ0wsQ0FBQztRQUVELElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsUUFBUSxDQUFDO0lBQzlCLENBQUM7Q0FDSjtBQUVZLFFBQUEsWUFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgSVByb3BlcnR5LFxyXG59IGZyb20gJy4uLy4uLy4uLy4uL0B0eXBlcy9wdWJsaWMnO1xyXG5cclxuaW1wb3J0IHsgRHVtcEludGVyZmFjZSB9IGZyb20gJy4vZHVtcC1pbnRlcmZhY2UnO1xyXG5cclxuY2xhc3MgR3JhZGllbnREdW1wIGltcGxlbWVudHMgRHVtcEludGVyZmFjZSB7XHJcbiAgICBwdWJsaWMgZW5jb2RlKG9iamVjdDogYW55LCBkYXRhOiBJUHJvcGVydHksIG9wdHM/OiBhbnkpOiB2b2lkIHtcclxuICAgICAgICAvLyDnm7TmjqXkv67mlLkgb2JqZWN0IOS8muS/ruaUueWIsOm7mOiupOWAvO+8iOWvueixoeW8leeUqOmXrumimO+8iVxyXG4gICAgICAgIGNvbnN0IGR1bXAgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iamVjdCkpO1xyXG4gICAgICAgIGRlbGV0ZSBkdW1wLl9jb2xvcjsgLy8gX2NvbG9yIOWAvOaYr+maj+acuui/kOeul+eahOe7k+aenO+8jOmcgOimgeWOu+aOiVxyXG5cclxuICAgICAgICBpZiAob2JqZWN0LmNvbG9yS2V5cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIG9iamVjdC5jb2xvcktleXMuZm9yRWFjaCgoaXRlbTogYW55LCBpbmRleDogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb2xvciA9IFtdO1xyXG4gICAgICAgICAgICAgICAgY29sb3JbMF0gPSBpdGVtLmNvbG9yLnI7XHJcbiAgICAgICAgICAgICAgICBjb2xvclsxXSA9IGl0ZW0uY29sb3IuZztcclxuICAgICAgICAgICAgICAgIGNvbG9yWzJdID0gaXRlbS5jb2xvci5iO1xyXG4gICAgICAgICAgICAgICAgZHVtcC5jb2xvcktleXNbaW5kZXhdLmNvbG9yID0gY29sb3I7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkYXRhLnZhbHVlID0gZHVtcDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZGVjb2RlKGRhdGE6IGFueSwgaW5mbzogYW55LCBkdW1wOiBhbnksIG9wdHM/OiBhbnkpOiB2b2lkIHtcclxuICAgICAgICAvLyDojrflj5bpnIDopoHkv67mlLnnmoTmlbDmja5cclxuICAgICAgICBjb25zdCBjY1R5cGUgPSBjYy5qcy5nZXRDbGFzc0J5TmFtZSgnY2MuR3JhZGllbnQnKTtcclxuICAgICAgICBjb25zdCBncmFkaWVudCA9IG5ldyBjY1R5cGUoKTtcclxuICAgICAgICBpZiAoZHVtcC52YWx1ZS5hbHBoYUtleXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgZHVtcC52YWx1ZS5hbHBoYUtleXMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IEFscGhhS2V5Q3RvciA9IGNjLmpzLmdldENsYXNzQnlOYW1lKCdjYy5BbHBoYUtleScpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYWxwaGFLZXkgPSBuZXcgQWxwaGFLZXlDdG9yKCk7XHJcbiAgICAgICAgICAgICAgICBhbHBoYUtleS50aW1lID0gaXRlbS50aW1lO1xyXG4gICAgICAgICAgICAgICAgYWxwaGFLZXkuYWxwaGEgPSBpdGVtLmFscGhhO1xyXG4gICAgICAgICAgICAgICAgZ3JhZGllbnQuYWxwaGFLZXlzLnB1c2goYWxwaGFLZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZHVtcC52YWx1ZS5jb2xvcktleXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgZHVtcC52YWx1ZS5jb2xvcktleXMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IENvbG9yS2V5Q3RvciA9IGNjLmpzLmdldENsYXNzQnlOYW1lKCdjYy5Db2xvcktleScpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgQ29sb3JDdG9yID0gY2MuanMuZ2V0Q2xhc3NCeU5hbWUoJ2NjLkNvbG9yJyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb2xvcktleSA9IG5ldyBDb2xvcktleUN0b3IoKTtcclxuICAgICAgICAgICAgICAgIGNvbG9yS2V5LnRpbWUgPSBpdGVtLnRpbWU7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNvbG9yICYmIChjb2xvcktleS5jb2xvciA9IG5ldyBDb2xvckN0b3IoLi4uaXRlbS5jb2xvcikpO1xyXG4gICAgICAgICAgICAgICAgZ3JhZGllbnQuY29sb3JLZXlzLnB1c2goY29sb3JLZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkYXRhW2luZm8ua2V5XSA9IGdyYWRpZW50O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ3JhZGllbnREdW1wID0gbmV3IEdyYWRpZW50RHVtcCgpO1xyXG4iXX0=