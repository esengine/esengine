"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.hasCCONFormatAssetInLibrary = hasCCONFormatAssetInLibrary;
exports.getCCONFormatAssetInLibrary = getCCONFormatAssetInLibrary;
exports.getDesiredCCONExtensionMap = getDesiredCCONExtensionMap;
exports.outputCCONFormat = outputCCONFormat;
const serialization_1 = require("cc/editor/serialization");
const fs_extra_1 = require("fs-extra");
function hasCCONFormatAssetInLibrary(asset) {
    // 目前规则：如果一个 asset 只有一个 .bin 文件，那么它是 CCON 格式。 
    const { files } = asset.meta;
    return files.length === 1 && files[0] === '.bin';
}
function getCCONFormatAssetInLibrary(asset) {
    return hasCCONFormatAssetInLibrary(asset) ? (asset.library + '.bin') : '';
}
function getDesiredCCONExtensionMap(serializeOption) {
    return '.cconb';
}
async function outputCCONFormat(ccon, fullBaseName) {
    await (0, fs_extra_1.outputFile)(`${fullBaseName}.bin`, (0, serialization_1.encodeCCONBinary)(ccon));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2NvbmIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvY29yZS9idWlsZGVyL3dvcmtlci9idWlsZGVyL3V0aWxzL2Njb25iLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBS0Esa0VBSUM7QUFDRCxrRUFFQztBQUVELGdFQUVDO0FBRUQsNENBRUM7QUFwQkQsMkRBQWlFO0FBQ2pFLHVDQUFzQztBQUl0QyxTQUFnQiwyQkFBMkIsQ0FBQyxLQUFhO0lBQ3JELDhDQUE4QztJQUM5QyxNQUFNLEVBQUUsS0FBSyxFQUFFLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQztJQUM3QixPQUFPLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxNQUFNLENBQUM7QUFDckQsQ0FBQztBQUNELFNBQWdCLDJCQUEyQixDQUFDLEtBQWE7SUFDckQsT0FBTywyQkFBMkIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7QUFDOUUsQ0FBQztBQUVELFNBQWdCLDBCQUEwQixDQUFDLGVBQXNDO0lBQzdFLE9BQU8sUUFBUSxDQUFDO0FBQ3BCLENBQUM7QUFFTSxLQUFLLFVBQVUsZ0JBQWdCLENBQUMsSUFBVSxFQUFFLFlBQW9CO0lBQ25FLE1BQU0sSUFBQSxxQkFBVSxFQUFDLEdBQUcsWUFBWSxNQUFNLEVBQUUsSUFBQSxnQ0FBZ0IsRUFBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQ3BFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDQ09OLCBlbmNvZGVDQ09OQmluYXJ5IH0gZnJvbSAnY2MvZWRpdG9yL3NlcmlhbGl6YXRpb24nO1xyXG5pbXBvcnQgeyBvdXRwdXRGaWxlIH0gZnJvbSAnZnMtZXh0cmEnO1xyXG5pbXBvcnQgeyBJQXNzZXQgfSBmcm9tICcuLi8uLi8uLi8uLi9hc3NldHMvQHR5cGVzL3Byb3RlY3RlZCc7XHJcbmltcG9ydCB7IEFzc2V0U2VyaWFsaXplT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uL0B0eXBlcy9wcm90ZWN0ZWQnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc0NDT05Gb3JtYXRBc3NldEluTGlicmFyeShhc3NldDogSUFzc2V0KSB7XHJcbiAgICAvLyDnm67liY3op4TliJnvvJrlpoLmnpzkuIDkuKogYXNzZXQg5Y+q5pyJ5LiA5LiqIC5iaW4g5paH5Lu277yM6YKj5LmI5a6D5pivIENDT04g5qC85byP44CCIFxyXG4gICAgY29uc3QgeyBmaWxlcyB9ID0gYXNzZXQubWV0YTtcclxuICAgIHJldHVybiBmaWxlcy5sZW5ndGggPT09IDEgJiYgZmlsZXNbMF0gPT09ICcuYmluJztcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q0NPTkZvcm1hdEFzc2V0SW5MaWJyYXJ5KGFzc2V0OiBJQXNzZXQpIHtcclxuICAgIHJldHVybiBoYXNDQ09ORm9ybWF0QXNzZXRJbkxpYnJhcnkoYXNzZXQpID8gKGFzc2V0LmxpYnJhcnkgKyAnLmJpbicpIDogJyc7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXREZXNpcmVkQ0NPTkV4dGVuc2lvbk1hcChzZXJpYWxpemVPcHRpb246IEFzc2V0U2VyaWFsaXplT3B0aW9ucykge1xyXG4gICAgcmV0dXJuICcuY2NvbmInO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb3V0cHV0Q0NPTkZvcm1hdChjY29uOiBDQ09OLCBmdWxsQmFzZU5hbWU6IHN0cmluZykge1xyXG4gICAgYXdhaXQgb3V0cHV0RmlsZShgJHtmdWxsQmFzZU5hbWV9LmJpbmAsIGVuY29kZUNDT05CaW5hcnkoY2NvbikpO1xyXG59XHJcbiJdfQ==