'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
exports.ParticleHandler = void 0;
const image_utils_1 = require("./utils/image-utils");
const fs_extra_1 = require("fs-extra");
const path_1 = require("path");
const cc_1 = require("cc");
const utils_1 = require("../utils");
const BlendFactor = cc_1.gfx.BlendFactor;
const { PositionType, EmitterMode } = cc_1.ParticleSystem2D;
const plist = require('plist');
const defaultParticlesUseData = {
    totalParticles: 150,
    life: 1,
    lifeVar: 0,
    emissionRate: 10,
    duration: -1,
    srcBlendFactor: BlendFactor.SRC_ALPHA,
    dstBlendFactor: BlendFactor.ONE_MINUS_CONSTANT_ALPHA,
    startColor: new cc_1.Color(255, 255, 255, 255),
    startColorVar: new cc_1.Color(0, 0, 0, 0),
    endColor: new cc_1.Color(255, 255, 255, 0),
    endColorVar: new cc_1.Color(0, 0, 0, 0),
    startSize: 50,
    startSizeVar: 0,
    endSize: 0,
    endSizeVar: 0,
    positionType: PositionType.FREE,
    sourcePos: new cc_1.Vec2(0, 0),
    posVar: new cc_1.Vec2(0, 0),
    angle: 90,
    angleVar: 20,
    startSpin: 0,
    startSpinVar: 0,
    endSpin: 0,
    endSpinVar: 0,
    emitterMode: EmitterMode.GRAVITY,
    gravity: new cc_1.Vec2(0, 0),
    speed: 180,
    speedVar: 50,
    radialAccel: 80,
    radialAccelVar: 0,
    tangentialAccel: 0,
    tangentialAccelVar: 0,
    rotationIsDir: false,
    startRadius: 0,
    startRadiusVar: 0,
    endRadius: 0,
    endRadiusVar: 0,
    rotatePerS: 0,
    rotatePerSVar: 0,
    spriteFrameUuid: '',
};
function getBlendFactor2DTo3D(value) {
    switch (value) {
        case 0: // ZERO
            return BlendFactor.ZERO;
        case 1: // ONE
            return BlendFactor.ONE;
        case 0x302: // SRC_ALPHA
            return BlendFactor.SRC_ALPHA;
        case 0x304: // DST_ALPHA
            return BlendFactor.DST_ALPHA;
        case 0x303: // ONE_MINUS_SRC_ALPHA
            return BlendFactor.ONE_MINUS_SRC_ALPHA;
        case 0x305: // ONE_MINUS_DST_ALPHA
            return BlendFactor.ONE_MINUS_DST_ALPHA;
        case 0x300: // SRC_COLOR
            return BlendFactor.SRC_COLOR;
        case 0x306: // DST_COLOR
            return BlendFactor.DST_COLOR;
        case 0x301: // ONE_MINUS_SRC_COLOR
            return BlendFactor.ONE_MINUS_SRC_COLOR;
        case 0x307: // ONE_MINUS_DST_COLOR
            return BlendFactor.ONE_MINUS_DST_COLOR;
    }
    return value;
}
exports.ParticleHandler = {
    // Handler 的名字，用于指定 Handler as 等
    name: 'particle',
    // 引擎内对应的类型
    assetType: 'cc.ParticleAsset',
    /**
     * 判断是否允许使用当前的 Handler 进行导入
     * @param asset
     */
    async validate(asset) {
        try {
            const data = plist.parse(await (0, fs_extra_1.readFile)(asset.source, 'utf8'));
            return typeof data.maxParticles !== 'undefined';
        }
        catch (e) {
            return false;
        }
    },
    importer: {
        // 版本号如果变更，则会强制重新导入
        version: '1.0.2',
        /**
         * 实际导入流程
         * 需要自己控制是否生成、拷贝文件
         *
         * 返回是否更新的 boolean
         * 如果返回 true，则会更新依赖这个资源的所有资源
         * @param asset
         */
        async import(asset) {
            const userData = asset.userData;
            // @ts-ignore
            Object.keys(defaultParticlesUseData).forEach((key) => {
                if (!(key in userData)) {
                    // @ts-ignore
                    userData[key] = defaultParticlesUseData[key];
                }
            });
            const ext = (0, path_1.extname)(asset.source);
            // 如果当前资源没有导入，则开始导入当前资源
            if (!(await asset.existsInLibrary('.json')) && asset._assetDB) {
                // 读取 plist 的配置信息
                const data = plist.parse(await (0, fs_extra_1.readFile)(asset.source, 'utf8'));
                await syncParticleData(asset);
                const particle = createParticle(asset);
                if (data.blendFuncSource) {
                    data.blendFuncSource = getBlendFactor2DTo3D(data.blendFuncSource);
                }
                if (data.blendFuncDestination) {
                    data.blendFuncDestination = getBlendFactor2DTo3D(data.blendFuncDestination);
                }
                if (data.textureImageData) {
                    delete data.textureFileName;
                    delete data.spriteFrameUuid;
                }
                else if (data.spriteFrameUuid) {
                    if (!data.spriteFrameUuid.endsWith('@f9941')) {
                        data.spriteFrameUuid = data.spriteFrameUuid + '@f9941';
                    }
                    asset.depend(data.spriteFrameUuid);
                    userData.spriteFrameUuid = data.spriteFrameUuid;
                    particle.spriteFrame = EditorExtends.serialize.asAsset(data.spriteFrameUuid, cc_1.SpriteFrame);
                    delete data.textureFileName;
                    delete data.textureImageData;
                }
                else if (data.textureFileName) {
                    // 如果 plist 内指定了 texture file，则找到这张图片
                    const textureBaseName = (0, path_1.basename)(data.textureFileName);
                    const texturePath = (0, path_1.join)((0, path_1.dirname)(asset.source), textureBaseName);
                    asset.depend(texturePath);
                    const uuid = asset._assetDB.pathToUuid(texturePath);
                    if ((0, fs_extra_1.existsSync)(texturePath)) {
                        if (uuid) {
                            const textureAsset = asset._assetDB.getAsset(uuid);
                            await (0, image_utils_1.changeImageDefaultType)(textureAsset, 'sprite-frame');
                            const spriteFrameUuid = uuid + '@f9941';
                            particle.spriteFrame = EditorExtends.serialize.asAsset(spriteFrameUuid, cc_1.SpriteFrame);
                            userData.spriteFrameUuid = spriteFrameUuid;
                            data.spriteFrameUuid = spriteFrameUuid;
                            delete data.textureFileName;
                            delete data.textureImageData;
                        }
                        else {
                            return false;
                        }
                    }
                    else {
                        console.error(`Particle import failed: Unable to find file Texture, the path: ${texturePath}`);
                        return false;
                    }
                }
                const source = plist.build(data);
                await asset.saveToLibrary(ext, source);
                const serializeJSON = EditorExtends.serialize(particle);
                await asset.saveToLibrary('.json', serializeJSON);
                const depends = (0, utils_1.getDependUUIDList)(serializeJSON);
                asset.setData('depends', depends);
            }
            return true;
        },
    },
};
exports.default = exports.ParticleHandler;
function createParticle(asset) {
    const particle = new cc.ParticleAsset();
    particle.name = asset.basename;
    particle._setRawAsset(asset.extname);
    return particle;
}
async function syncParticleData(asset) {
    const userData = asset.userData;
    const dict = plist.parse(await (0, fs_extra_1.readFile)(asset.source, 'utf8'));
    userData.totalParticles = parseInt(dict['maxParticles'] || 0);
    userData.life = parseFloat(dict['particleLifespan'] || 0);
    userData.lifeVar = parseFloat(dict['particleLifespanVariance'] || 0);
    userData.emissionRate = dict['emissionRate'] || Math.min(userData.totalParticles / userData.life, Number.MAX_VALUE);
    userData.duration = parseFloat(dict['duration'] || 0);
    userData.srcBlendFactor = parseInt(dict['blendFuncSource'] || BlendFactor.SRC_ALPHA);
    userData.dstBlendFactor = parseInt(dict['blendFuncDestination'] || BlendFactor.ONE_MINUS_SRC_ALPHA);
    const startColor = userData.startColor;
    startColor.r = parseFloat(dict['startColorRed'] || 0) * 255;
    startColor.g = parseFloat(dict['startColorGreen'] || 0) * 255;
    startColor.b = parseFloat(dict['startColorBlue'] || 0) * 255;
    startColor.a = parseFloat(dict['startColorAlpha'] || 0) * 255;
    const startColorVar = userData.startColorVar;
    startColorVar.r = parseFloat(dict['startColorVarianceRed'] || 0) * 255;
    startColorVar.g = parseFloat(dict['startColorVarianceGreen'] || 0) * 255;
    startColorVar.b = parseFloat(dict['startColorVarianceBlue'] || 0) * 255;
    startColorVar.a = parseFloat(dict['startColorVarianceAlpha'] || 0) * 255;
    const endColor = userData.endColor;
    endColor.r = parseFloat(dict['finishColorRed'] || 0) * 255;
    endColor.g = parseFloat(dict['finishColorGreen'] || 0) * 255;
    endColor.b = parseFloat(dict['finishColorBlue'] || 0) * 255;
    endColor.a = parseFloat(dict['finishColorAlpha'] || 0) * 255;
    const endColorVar = userData.endColorVar;
    endColorVar.r = parseFloat(dict['finishColorVarianceRed'] || 0) * 255;
    endColorVar.g = parseFloat(dict['finishColorVarianceGreen'] || 0) * 255;
    endColorVar.b = parseFloat(dict['finishColorVarianceBlue'] || 0) * 255;
    endColorVar.a = parseFloat(dict['finishColorVarianceAlpha'] || 0) * 255;
    // particle size
    userData.startSize = parseFloat(dict['startParticleSize'] || 0);
    userData.startSizeVar = parseFloat(dict['startParticleSizeVariance'] || 0);
    userData.endSize = parseFloat(dict['finishParticleSize'] || 0);
    userData.endSizeVar = parseFloat(dict['finishParticleSizeVariance'] || 0);
    // position
    // Make empty positionType value and old version compatible
    userData.positionType = parseFloat(dict['positionType'] !== undefined ? dict['positionType'] : 0);
    userData.sourcePos = new cc_1.Vec2(0, 0);
    const x = parseFloat(dict['sourcePositionVariancex'] || 0);
    const y = parseFloat(dict['sourcePositionVariancey'] || 0);
    userData.posVar = new cc_1.Vec2(x, y);
    // angle
    userData.angle = parseFloat(dict['angle'] || 0);
    userData.angleVar = parseFloat(dict['angleVariance'] || 0);
    // Spinning
    userData.startSpin = parseFloat(dict['rotationStart'] || 0);
    userData.startSpinVar = parseFloat(dict['rotationStartVariance'] || 0);
    userData.endSpin = parseFloat(dict['rotationEnd'] || 0);
    userData.endSpinVar = parseFloat(dict['rotationEndVariance'] || 0);
    userData.emitterMode = parseInt(dict['emitterType'] || 0);
    // Mode A: Gravity + tangential accel + radial accel
    if (userData.emitterMode === EmitterMode.GRAVITY) {
        // gravity
        const gravityx = parseFloat(dict['gravityx'] || 0);
        const gravityy = parseFloat(dict['gravityy'] || 0);
        userData.gravity = new cc_1.Vec2(gravityx, gravityy);
        // speed
        userData.speed = parseFloat(dict['speed'] || 0);
        userData.speedVar = parseFloat(dict['speedVariance'] || 0);
        // radial acceleration
        userData.radialAccel = parseFloat(dict['radialAcceleration'] || 0);
        userData.radialAccelVar = parseFloat(dict['radialAccelVariance'] || 0);
        // tangential acceleration
        userData.tangentialAccel = parseFloat(dict['tangentialAcceleration'] || 0);
        userData.tangentialAccelVar = parseFloat(dict['tangentialAccelVariance'] || 0);
        // rotation is dir
        let locRotationIsDir = dict['rotationIsDir'] || '';
        if (locRotationIsDir !== null) {
            locRotationIsDir = locRotationIsDir.toString().toLowerCase();
            userData.rotationIsDir = locRotationIsDir === 'true' || locRotationIsDir === '1';
        }
        else {
            userData.rotationIsDir = false;
        }
    }
    else if (userData.emitterMode === EmitterMode.RADIUS) {
        // or Mode B: radius movement
        userData.startRadius = parseFloat(dict['maxRadius'] || 0);
        userData.startRadiusVar = parseFloat(dict['maxRadiusVariance'] || 0);
        userData.endRadius = parseFloat(dict['minRadius'] || 0);
        userData.endRadiusVar = parseFloat(dict['minRadiusVariance'] || 0);
        userData.rotatePerS = parseFloat(dict['rotatePerSecond'] || 0);
        userData.rotatePerSVar = parseFloat(dict['rotatePerSecondVariance'] || 0);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFydGljbGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvY29yZS9hc3NldHMvYXNzZXQtaGFuZGxlci9hc3NldHMvcGFydGljbGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDOzs7QUFHYixxREFBNkQ7QUFDN0QsdUNBQWdEO0FBQ2hELCtCQUF3RDtBQUN4RCwyQkFBcUU7QUFFckUsb0NBQTZDO0FBSTdDLE1BQU0sV0FBVyxHQUFHLFFBQUcsQ0FBQyxXQUFXLENBQUM7QUFDcEMsTUFBTSxFQUFFLFlBQVksRUFBRSxXQUFXLEVBQUUsR0FBRyxxQkFBZ0IsQ0FBQztBQUd2RCxNQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7QUFFL0IsTUFBTSx1QkFBdUIsR0FBRztJQUM1QixjQUFjLEVBQUUsR0FBRztJQUNuQixJQUFJLEVBQUUsQ0FBQztJQUNQLE9BQU8sRUFBRSxDQUFDO0lBQ1YsWUFBWSxFQUFFLEVBQUU7SUFDaEIsUUFBUSxFQUFFLENBQUMsQ0FBQztJQUNaLGNBQWMsRUFBRSxXQUFXLENBQUMsU0FBUztJQUNyQyxjQUFjLEVBQUUsV0FBVyxDQUFDLHdCQUF3QjtJQUNwRCxVQUFVLEVBQUUsSUFBSSxVQUFLLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO0lBQ3pDLGFBQWEsRUFBRSxJQUFJLFVBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDcEMsUUFBUSxFQUFFLElBQUksVUFBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNyQyxXQUFXLEVBQUUsSUFBSSxVQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ2xDLFNBQVMsRUFBRSxFQUFFO0lBQ2IsWUFBWSxFQUFFLENBQUM7SUFDZixPQUFP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QVEsQ0FBQyxZQUFZLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ25FLFFBQVEsQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQy9ELFFBQVEsQ0FBQyxhQUFhLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQzlFLENBQUM7QUFDTCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5cclxuaW1wb3J0IHsgQXNzZXQgfSBmcm9tICdAY29jb3MvYXNzZXQtZGInO1xyXG5pbXBvcnQgeyBjaGFuZ2VJbWFnZURlZmF1bHRUeXBlIH0gZnJvbSAnLi91dGlscy9pbWFnZS11dGlscyc7XHJcbmltcG9ydCB7IGV4aXN0c1N5bmMsIHJlYWRGaWxlIH0gZnJvbSAnZnMtZXh0cmEnO1xyXG5pbXBvcnQgeyBiYXNlbmFtZSwgZGlybmFtZSwgZXh0bmFtZSwgam9pbiB9IGZyb20gJ3BhdGgnO1xyXG5pbXBvcnQgeyBDb2xvciwgVmVjMiwgZ2Z4LCBQYXJ0aWNsZVN5c3RlbTJELCBTcHJpdGVGcmFtZSB9IGZyb20gJ2NjJztcclxuXHJcbmltcG9ydCB7IGdldERlcGVuZFVVSURMaXN0IH0gZnJvbSAnLi4vdXRpbHMnO1xyXG5pbXBvcnQgeyBBc3NldEhhbmRsZXIgfSBmcm9tICcuLi8uLi9AdHlwZXMvcHJvdGVjdGVkJztcclxuaW1wb3J0IHsgUGFydGljbGVBc3NldFVzZXJEYXRhIH0gZnJvbSAnLi4vLi4vQHR5cGVzL3VzZXJEYXRhcyc7XHJcblxyXG5jb25zdCBCbGVuZEZhY3RvciA9IGdmeC5CbGVuZEZhY3RvcjtcclxuY29uc3QgeyBQb3NpdGlvblR5cGUsIEVtaXR0ZXJNb2RlIH0gPSBQYXJ0aWNsZVN5c3RlbTJEO1xyXG5cclxuZGVjbGFyZSBjb25zdCBFZGl0b3JFeHRlbmRzOiBhbnk7XHJcbmNvbnN0IHBsaXN0ID0gcmVxdWlyZSgncGxpc3QnKTtcclxuXHJcbmNvbnN0IGRlZmF1bHRQYXJ0aWNsZXNVc2VEYXRhID0ge1xyXG4gICAgdG90YWxQYXJ0aWNsZXM6IDE1MCxcclxuICAgIGxpZmU6IDEsXHJcbiAgICBsaWZlVmFyOiAwLFxyXG4gICAgZW1pc3Npb25SYXRlOiAxMCxcclxuICAgIGR1cmF0aW9uOiAtMSxcclxuICAgIHNyY0JsZW5kRmFjdG9yOiBCbGVuZEZhY3Rvci5TUkNfQUxQSEEsXHJcbiAgICBkc3RCbGVuZEZhY3RvcjogQmxlbmRGYWN0b3IuT05FX01JTlVTX0NPTlNUQU5UX0FMUEhBLFxyXG4gICAgc3RhcnRDb2xvcjogbmV3IENvbG9yKDI1NSwgMjU1LCAyNTUsIDI1NSksXHJcbiAgICBzdGFydENvbG9yVmFyOiBuZXcgQ29sb3IoMCwgMCwgMCwgMCksXHJcbiAgICBlbmRDb2xvcjogbmV3IENvbG9yKDI1NSwgMjU1LCAyNTUsIDApLFxyXG4gICAgZW5kQ29sb3JWYXI6IG5ldyBDb2xvcigwLCAwLCAwLCAwKSxcclxuICAgIHN0YXJ0U2l6ZTogNTAsXHJcbiAgICBzdGFydFNpemVWYXI6IDAsXHJcbiAgICBlbmRTaXplOiAwLFxyXG4gICAgZW5kU2l6ZVZhcjogMCxcclxuICAgIHBvc2l0aW9uVHlwZTogUG9zaXRpb25UeXBlLkZSRUUsXHJcbiAgICBzb3VyY2VQb3M6IG5ldyBWZWMyKDAsIDApLFxyXG4gICAgcG9zVmFyOiBuZXcgVmVjMigwLCAwKSxcclxuICAgIGFuZ2xlOiA5MCxcclxuICAgIGFuZ2xlVmFyOiAyMCxcclxuICAgIHN0YXJ0U3BpbjogMCxcclxuICAgIHN0YXJ0U3BpblZhcjogMCxcclxuICAgIGVuZFNwaW46IDAsXHJcbiAgICBlbmRTcGluVmFyOiAwLFxyXG4gICAgZW1pdHRlck1vZGU6IEVtaXR0ZXJNb2RlLkdSQVZJVFksXHJcbiAgICBncmF2aXR5OiBuZXcgVmVjMigwLCAwKSxcclxuICAgIHNwZWVkOiAxODAsXHJcbiAgICBzcGVlZFZhcjogNTAsXHJcbiAgICByYWRpYWxBY2NlbDogODAsXHJcbiAgICByYWRpYWxBY2NlbFZhcjogMCxcclxuICAgIHRhbmdlbnRpYWxBY2NlbDogMCxcclxuICAgIHRhbmdlbnRpYWxBY2NlbFZhcjogMCxcclxuICAgIHJvdGF0aW9uSXNEaXI6IGZhbHNlLFxyXG4gICAgc3RhcnRSYWRpdXM6IDAsXHJcbiAgICBzdGFydFJhZGl1c1ZhcjogMCxcclxuICAgIGVuZFJhZGl1czogMCxcclxuICAgIGVuZFJhZGl1c1ZhcjogMCxcclxuICAgIHJvdGF0ZVBlclM6IDAsXHJcbiAgICByb3RhdGVQZXJTVmFyOiAwLFxyXG4gICAgc3ByaXRlRnJhbWVVdWlkOiAnJyxcclxufTtcclxuXHJcbmZ1bmN0aW9uIGdldEJsZW5kRmFjdG9yMkRUbzNEKHZhbHVlOiBudW1iZXIpIHtcclxuICAgIHN3aXRjaCAodmFsdWUpIHtcclxuICAgICAgICBjYXNlIDA6IC8vIFpFUk9cclxuICAgICAgICAgICAgcmV0dXJuIEJsZW5kRmFjdG9yLlpFUk87XHJcbiAgICAgICAgY2FzZSAxOiAvLyBPTkVcclxuICAgICAgICAgICAgcmV0dXJuIEJsZW5kRmFjdG9yLk9ORTtcclxuICAgICAgICBjYXNlIDB4MzAyOiAvLyBTUkNfQUxQSEFcclxuICAgICAgICAgICAgcmV0dXJuIEJsZW5kRmFjdG9yLlNSQ19BTFBIQTtcclxuICAgICAgICBjYXNlIDB4MzA0OiAvLyBEU1RfQUxQSEFcclxuICAgICAgICAgICAgcmV0dXJuIEJsZW5kRmFjdG9yLkRTVF9BTFBIQTtcclxuICAgICAgICBjYXNlIDB4MzAzOiAvLyBPTkVfTUlOVVNfU1JDX0FMUEhBXHJcbiAgICAgICAgICAgIHJldHVybiBCbGVuZEZhY3Rvci5PTkVfTUlOVVNfU1JDX0FMUEhBO1xyXG4gICAgICAgIGNhc2UgMHgzMDU6IC8vIE9ORV9NSU5VU19EU1RfQUxQSEFcclxuICAgICAgICAgICAgcmV0dXJuIEJsZW5kRmFjdG9yLk9ORV9NSU5VU19EU1RfQUxQSEE7XHJcbiAgICAgICAgY2FzZSAweDMwMDogLy8gU1JDX0NPTE9SXHJcbiAgICAgICAgICAgIHJldHVybiBCbGVuZEZhY3Rvci5TUkNfQ09MT1I7XHJcbiAgICAgICAgY2FzZSAweDMwNjogLy8gRFNUX0NPTE9SXHJcbiAgICAgICAgICAgIHJldHVybiBCbGVuZEZhY3Rvci5EU1RfQ09MT1I7XHJcbiAgICAgICAgY2FzZSAweDMwMTogLy8gT05FX01JTlVTX1NSQ19DT0xPUlxyXG4gICAgICAgICAgICByZXR1cm4gQmxlbmRGYWN0b3IuT05FX01JTlVTX1NSQ19DT0xPUjtcclxuICAgICAgICBjYXNlIDB4MzA3OiAvLyBPTkVfTUlOVVNfRFNUX0NPTE9SXHJcbiAgICAgICAgICAgIHJldHVybiBCbGVuZEZhY3Rvci5PTkVfTUlOVVNfRFNUX0NPTE9SO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgUGFydGljbGVIYW5kbGVyOiBBc3NldEhhbmRsZXIgPSB7XHJcbiAgICAvLyBIYW5kbGVyIOeahOWQjeWtl++8jOeUqOS6juaMh+WumiBIYW5kbGVyIGFzIOetiVxyXG4gICAgbmFtZTogJ3BhcnRpY2xlJyxcclxuXHJcbiAgICAvLyDlvJXmk47lhoXlr7nlupTnmoTnsbvlnotcclxuICAgIGFzc2V0VHlwZTogJ2NjLlBhcnRpY2xlQXNzZXQnLFxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Yik5pat5piv5ZCm5YWB6K645L2/55So5b2T5YmN55qEIEhhbmRsZXIg6L+b6KGM5a+85YWlXHJcbiAgICAgKiBAcGFyYW0gYXNzZXRcclxuICAgICAqL1xyXG4gICAgYXN5bmMgdmFsaWRhdGUoYXNzZXQ6IEFzc2V0KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHBsaXN0LnBhcnNlKGF3YWl0IHJlYWRGaWxlKGFzc2V0LnNvdXJjZSwgJ3V0ZjgnKSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgZGF0YS5tYXhQYXJ0aWNsZXMgIT09ICd1bmRlZmluZWQnO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgaW1wb3J0ZXI6IHtcclxuICAgICAgICAvLyDniYjmnKzlj7flpoLmnpzlj5jmm7TvvIzliJnkvJrlvLrliLbph43mlrDlr7zlhaVcclxuICAgICAgICB2ZXJzaW9uOiAnMS4wLjInLFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWunumZheWvvOWFpea1geeoi1xyXG4gICAgICAgICAqIOmcgOimgeiHquW3seaOp+WItuaYr+WQpueUn+aIkOOAgeaLt+i0neaWh+S7tlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICog6L+U5Zue5piv5ZCm5pu05paw55qEIGJvb2xlYW5cclxuICAgICAgICAgKiDlpoLmnpzov5Tlm54gdHJ1Ze+8jOWImeS8muabtOaWsOS+nei1lui/meS4qui1hOa6kOeahOaJgOaciei1hOa6kFxyXG4gICAgICAgICAqIEBwYXJhbSBhc3NldFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFzeW5jIGltcG9ydChhc3NldDogQXNzZXQpIHtcclxuICAgICAgICAgICAgY29uc3QgdXNlckRhdGEgPSBhc3NldC51c2VyRGF0YSBhcyBQYXJ0aWNsZUFzc2V0VXNlckRhdGE7XHJcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgICAgT2JqZWN0LmtleXMoZGVmYXVsdFBhcnRpY2xlc1VzZURhdGEpLmZvckVhY2goKGtleTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIShrZXkgaW4gdXNlckRhdGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJEYXRhW2tleV0gPSBkZWZhdWx0UGFydGljbGVzVXNlRGF0YVtrZXldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGV4dCA9IGV4dG5hbWUoYXNzZXQuc291cmNlKTtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5b2T5YmN6LWE5rqQ5rKh5pyJ5a+85YWl77yM5YiZ5byA5aeL5a+85YWl5b2T5YmN6LWE5rqQXHJcbiAgICAgICAgICAgIGlmICghKGF3YWl0IGFzc2V0LmV4aXN0c0luTGlicmFyeSgnLmpzb24nKSkgJiYgYXNzZXQuX2Fzc2V0REIpIHtcclxuICAgICAgICAgICAgICAgIC8vIOivu+WPliBwbGlzdCDnmoTphY3nva7kv6Hmga9cclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBwbGlzdC5wYXJzZShhd2FpdCByZWFkRmlsZShhc3NldC5zb3VyY2UsICd1dGY4JykpO1xyXG5cclxuICAgICAgICAgICAgICAgIGF3YWl0IHN5bmNQYXJ0aWNsZURhdGEoYXNzZXQpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRpY2xlID0gY3JlYXRlUGFydGljbGUoYXNzZXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuYmxlbmRGdW5jU291cmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5ibGVuZEZ1bmNTb3VyY2UgPSBnZXRCbGVuZEZhY3RvcjJEVG8zRChkYXRhLmJsZW5kRnVuY1NvdXJjZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5ibGVuZEZ1bmNEZXN0aW5hdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuYmxlbmRGdW5jRGVzdGluYXRpb24gPSBnZXRCbGVuZEZhY3RvcjJEVG8zRChkYXRhLmJsZW5kRnVuY0Rlc3RpbmF0aW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnRleHR1cmVJbWFnZURhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgZGF0YS50ZXh0dXJlRmlsZU5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEuc3ByaXRlRnJhbWVVdWlkO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnNwcml0ZUZyYW1lVXVpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZGF0YS5zcHJpdGVGcmFtZVV1aWQuZW5kc1dpdGgoJ0BmOTk0MScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc3ByaXRlRnJhbWVVdWlkID0gZGF0YS5zcHJpdGVGcmFtZVV1aWQgKyAnQGY5OTQxJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXQhLmRlcGVuZChkYXRhLnNwcml0ZUZyYW1lVXVpZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlckRhdGEuc3ByaXRlRnJhbWVVdWlkID0gZGF0YS5zcHJpdGVGcmFtZVV1aWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFydGljbGUuc3ByaXRlRnJhbWUgPSBFZGl0b3JFeHRlbmRzLnNlcmlhbGl6ZS5hc0Fzc2V0KGRhdGEuc3ByaXRlRnJhbWVVdWlkLCBTcHJpdGVGcmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEudGV4dHVyZUZpbGVOYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBkYXRhLnRleHR1cmVJbWFnZURhdGE7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEudGV4dHVyZUZpbGVOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6cIHBsaXN0IOWGheaMh+WumuS6hiB0ZXh0dXJlIGZpbGXvvIzliJnmib7liLDov5nlvKDlm77niYdcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0dXJlQmFzZU5hbWUgPSBiYXNlbmFtZShkYXRhLnRleHR1cmVGaWxlTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dHVyZVBhdGggPSBqb2luKGRpcm5hbWUoYXNzZXQuc291cmNlKSwgdGV4dHVyZUJhc2VOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXQuZGVwZW5kKHRleHR1cmVQYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB1dWlkID0gYXNzZXQuX2Fzc2V0REIucGF0aFRvVXVpZCh0ZXh0dXJlUGF0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0c1N5bmModGV4dHVyZVBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1dWlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0dXJlQXNzZXQgPSBhc3NldC5fYXNzZXREQi5nZXRBc3NldCh1dWlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNoYW5nZUltYWdlRGVmYXVsdFR5cGUodGV4dHVyZUFzc2V0LCAnc3ByaXRlLWZyYW1lJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3ByaXRlRnJhbWVVdWlkID0gdXVpZCArICdAZjk5NDEnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydGljbGUuc3ByaXRlRnJhbWUgPSBFZGl0b3JFeHRlbmRzLnNlcmlhbGl6ZS5hc0Fzc2V0KHNwcml0ZUZyYW1lVXVpZCwgU3ByaXRlRnJhbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlckRhdGEuc3ByaXRlRnJhbWVVdWlkID0gc3ByaXRlRnJhbWVVdWlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5zcHJpdGVGcmFtZVV1aWQgPSBzcHJpdGVGcmFtZVV1aWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEudGV4dHVyZUZpbGVOYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEudGV4dHVyZUltYWdlRGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFBhcnRpY2xlIGltcG9ydCBmYWlsZWQ6IFVuYWJsZSB0byBmaW5kIGZpbGUgVGV4dHVyZSwgdGhlIHBhdGg6ICR7dGV4dHVyZVBhdGh9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc291cmNlID0gcGxpc3QuYnVpbGQoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBhc3NldC5zYXZlVG9MaWJyYXJ5KGV4dCwgc291cmNlKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBzZXJpYWxpemVKU09OID0gRWRpdG9yRXh0ZW5kcy5zZXJpYWxpemUocGFydGljbGUpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgYXNzZXQuc2F2ZVRvTGlicmFyeSgnLmpzb24nLCBzZXJpYWxpemVKU09OKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXBlbmRzID0gZ2V0RGVwZW5kVVVJRExpc3Qoc2VyaWFsaXplSlNPTik7XHJcbiAgICAgICAgICAgICAgICBhc3NldC5zZXREYXRhKCdkZXBlbmRzJywgZGVwZW5kcyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgUGFydGljbGVIYW5kbGVyO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlUGFydGljbGUoYXNzZXQ6IEFzc2V0KSB7XHJcbiAgICBjb25zdCBwYXJ0aWNsZSA9IG5ldyBjYy5QYXJ0aWNsZUFzc2V0KCk7XHJcbiAgICBwYXJ0aWNsZS5uYW1lID0gYXNzZXQuYmFzZW5hbWU7XHJcbiAgICBwYXJ0aWNsZS5fc2V0UmF3QXNzZXQoYXNzZXQuZXh0bmFtZSk7XHJcblxyXG4gICAgcmV0dXJuIHBhcnRpY2xlO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBzeW5jUGFydGljbGVEYXRhKGFzc2V0OiBBc3NldCkge1xyXG4gICAgY29uc3QgdXNlckRhdGEgPSBhc3NldC51c2VyRGF0YSBhcyBQYXJ0aWNsZUFzc2V0VXNlckRhdGE7XHJcbiAgICBjb25zdCBkaWN0ID0gcGxpc3QucGFyc2UoYXdhaXQgcmVhZEZpbGUoYXNzZXQuc291cmNlLCAndXRmOCcpKTtcclxuXHJcbiAgICB1c2VyRGF0YS50b3RhbFBhcnRpY2xlcyA9IHBhcnNlSW50KGRpY3RbJ21heFBhcnRpY2xlcyddIHx8IDApO1xyXG4gICAgdXNlckRhdGEubGlmZSA9IHBhcnNlRmxvYXQoZGljdFsncGFydGljbGVMaWZlc3BhbiddIHx8IDApO1xyXG4gICAgdXNlckRhdGEubGlmZVZhciA9IHBhcnNlRmxvYXQoZGljdFsncGFydGljbGVMaWZlc3BhblZhcmlhbmNlJ10gfHwgMCk7XHJcbiAgICB1c2VyRGF0YS5lbWlzc2lvblJhdGUgPSBkaWN0WydlbWlzc2lvblJhdGUnXSB8fCBNYXRoLm1pbih1c2VyRGF0YS50b3RhbFBhcnRpY2xlcyAvIHVzZXJEYXRhLmxpZmUsIE51bWJlci5NQVhfVkFMVUUpO1xyXG4gICAgdXNlckRhdGEuZHVyYXRpb24gPSBwYXJzZUZsb2F0KGRpY3RbJ2R1cmF0aW9uJ10gfHwgMCk7XHJcbiAgICB1c2VyRGF0YS5zcmNCbGVuZEZhY3RvciA9IHBhcnNlSW50KGRpY3RbJ2JsZW5kRnVuY1NvdXJjZSddIHx8IEJsZW5kRmFjdG9yLlNSQ19BTFBIQSk7XHJcbiAgICB1c2VyRGF0YS5kc3RCbGVuZEZhY3RvciA9IHBhcnNlSW50KGRpY3RbJ2JsZW5kRnVuY0Rlc3RpbmF0aW9uJ10gfHwgQmxlbmRGYWN0b3IuT05FX01JTlVTX1NSQ19BTFBIQSk7XHJcblxyXG4gICAgY29uc3Qgc3RhcnRDb2xvciA9IHVzZXJEYXRhLnN0YXJ0Q29sb3I7XHJcbiAgICBzdGFydENvbG9yLnIgPSBwYXJzZUZsb2F0KGRpY3RbJ3N0YXJ0Q29sb3JSZWQnXSB8fCAwKSAqIDI1NTtcclxuICAgIHN0YXJ0Q29sb3IuZyA9IHBhcnNlRmxvYXQoZGljdFsnc3RhcnRDb2xvckdyZWVuJ10gfHwgMCkgKiAyNTU7XHJcbiAgICBzdGFydENvbG9yLmIgPSBwYXJzZUZsb2F0KGRpY3RbJ3N0YXJ0Q29sb3JCbHVlJ10gfHwgMCkgKiAyNTU7XHJcbiAgICBzdGFydENvbG9yLmEgPSBwYXJzZUZsb2F0KGRpY3RbJ3N0YXJ0Q29sb3JBbHBoYSddIHx8IDApICogMjU1O1xyXG5cclxuICAgIGNvbnN0IHN0YXJ0Q29sb3JWYXIgPSB1c2VyRGF0YS5zdGFydENvbG9yVmFyO1xyXG4gICAgc3RhcnRDb2xvclZhci5yID0gcGFyc2VGbG9hdChkaWN0WydzdGFydENvbG9yVmFyaWFuY2VSZWQnXSB8fCAwKSAqIDI1NTtcclxuICAgIHN0YXJ0Q29sb3JWYXIuZyA9IHBhcnNlRmxvYXQoZGljdFsnc3RhcnRDb2xvclZhcmlhbmNlR3JlZW4nXSB8fCAwKSAqIDI1NTtcclxuICAgIHN0YXJ0Q29sb3JWYXIuYiA9IHBhcnNlRmxvYXQoZGljdFsnc3RhcnRDb2xvclZhcmlhbmNlQmx1ZSddIHx8IDApICogMjU1O1xyXG4gICAgc3RhcnRDb2xvclZhci5hID0gcGFyc2VGbG9hdChkaWN0WydzdGFydENvbG9yVmFyaWFuY2VBbHBoYSddIHx8IDApICogMjU1O1xyXG5cclxuICAgIGNvbnN0IGVuZENvbG9yID0gdXNlckRhdGEuZW5kQ29sb3I7XHJcbiAgICBlbmRDb2xvci5yID0gcGFyc2VGbG9hdChkaWN0WydmaW5pc2hDb2xvclJlZCddIHx8IDApICogMjU1O1xyXG4gICAgZW5kQ29sb3IuZyA9IHBhcnNlRmxvYXQoZGljdFsnZmluaXNoQ29sb3JHcmVlbiddIHx8IDApICogMjU1O1xyXG4gICAgZW5kQ29sb3IuYiA9IHBhcnNlRmxvYXQoZGljdFsnZmluaXNoQ29sb3JCbHVlJ10gfHwgMCkgKiAyNTU7XHJcbiAgICBlbmRDb2xvci5hID0gcGFyc2VGbG9hdChkaWN0WydmaW5pc2hDb2xvckFscGhhJ10gfHwgMCkgKiAyNTU7XHJcblxyXG4gICAgY29uc3QgZW5kQ29sb3JWYXIgPSB1c2VyRGF0YS5lbmRDb2xvclZhcjtcclxuICAgIGVuZENvbG9yVmFyLnIgPSBwYXJzZUZsb2F0KGRpY3RbJ2ZpbmlzaENvbG9yVmFyaWFuY2VSZWQnXSB8fCAwKSAqIDI1NTtcclxuICAgIGVuZENvbG9yVmFyLmcgPSBwYXJzZUZsb2F0KGRpY3RbJ2ZpbmlzaENvbG9yVmFyaWFuY2VHcmVlbiddIHx8IDApICogMjU1O1xyXG4gICAgZW5kQ29sb3JWYXIuYiA9IHBhcnNlRmxvYXQoZGljdFsnZmluaXNoQ29sb3JWYXJpYW5jZUJsdWUnXSB8fCAwKSAqIDI1NTtcclxuICAgIGVuZENvbG9yVmFyLmEgPSBwYXJzZUZsb2F0KGRpY3RbJ2ZpbmlzaENvbG9yVmFyaWFuY2VBbHBoYSddIHx8IDApICogMjU1O1xyXG5cclxuICAgIC8vIHBhcnRpY2xlIHNpemVcclxuICAgIHVzZXJEYXRhLnN0YXJ0U2l6ZSA9IHBhcnNlRmxvYXQoZGljdFsnc3RhcnRQYXJ0aWNsZVNpemUnXSB8fCAwKTtcclxuICAgIHVzZXJEYXRhLnN0YXJ0U2l6ZVZhciA9IHBhcnNlRmxvYXQoZGljdFsnc3RhcnRQYXJ0aWNsZVNpemVWYXJpYW5jZSddIHx8IDApO1xyXG4gICAgdXNlckRhdGEuZW5kU2l6ZSA9IHBhcnNlRmxvYXQoZGljdFsnZmluaXNoUGFydGljbGVTaXplJ10gfHwgMCk7XHJcbiAgICB1c2VyRGF0YS5lbmRTaXplVmFyID0gcGFyc2VGbG9hdChkaWN0WydmaW5pc2hQYXJ0aWNsZVNpemVWYXJpYW5jZSddIHx8IDApO1xyXG5cclxuICAgIC8vIHBvc2l0aW9uXHJcbiAgICAvLyBNYWtlIGVtcHR5IHBvc2l0aW9uVHlwZSB2YWx1ZSBhbmQgb2xkIHZlcnNpb24gY29tcGF0aWJsZVxyXG4gICAgdXNlckRhdGEucG9zaXRpb25UeXBlID0gcGFyc2VGbG9hdChkaWN0Wydwb3NpdGlvblR5cGUnXSAhPT0gdW5kZWZpbmVkID8gZGljdFsncG9zaXRpb25UeXBlJ10gOiAwKTtcclxuXHJcbiAgICB1c2VyRGF0YS5zb3VyY2VQb3MgPSBuZXcgVmVjMigwLCAwKTtcclxuICAgIGNvbnN0IHggPSBwYXJzZUZsb2F0KGRpY3RbJ3NvdXJjZVBvc2l0aW9uVmFyaWFuY2V4J10gfHwgMCk7XHJcbiAgICBjb25zdCB5ID0gcGFyc2VGbG9hdChkaWN0Wydzb3VyY2VQb3NpdGlvblZhcmlhbmNleSddIHx8IDApO1xyXG4gICAgdXNlckRhdGEucG9zVmFyID0gbmV3IFZlYzIoeCwgeSk7XHJcbiAgICAvLyBhbmdsZVxyXG4gICAgdXNlckRhdGEuYW5nbGUgPSBwYXJzZUZsb2F0KGRpY3RbJ2FuZ2xlJ10gfHwgMCk7XHJcbiAgICB1c2VyRGF0YS5hbmdsZVZhciA9IHBhcnNlRmxvYXQoZGljdFsnYW5nbGVWYXJpYW5jZSddIHx8IDApO1xyXG5cclxuICAgIC8vIFNwaW5uaW5nXHJcbiAgICB1c2VyRGF0YS5zdGFydFNwaW4gPSBwYXJzZUZsb2F0KGRpY3RbJ3JvdGF0aW9uU3RhcnQnXSB8fCAwKTtcclxuICAgIHVzZXJEYXRhLnN0YXJ0U3BpblZhciA9IHBhcnNlRmxvYXQoZGljdFsncm90YXRpb25TdGFydFZhcmlhbmNlJ10gfHwgMCk7XHJcbiAgICB1c2VyRGF0YS5lbmRTcGluID0gcGFyc2VGbG9hdChkaWN0Wydyb3RhdGlvbkVuZCddIHx8IDApO1xyXG4gICAgdXNlckRhdGEuZW5kU3BpblZhciA9IHBhcnNlRmxvYXQoZGljdFsncm90YXRpb25FbmRWYXJpYW5jZSddIHx8IDApO1xyXG5cclxuICAgIHVzZXJEYXRhLmVtaXR0ZXJNb2RlID0gcGFyc2VJbnQoZGljdFsnZW1pdHRlclR5cGUnXSB8fCAwKTtcclxuXHJcbiAgICAvLyBNb2RlIEE6IEdyYXZpdHkgKyB0YW5nZW50aWFsIGFjY2VsICsgcmFkaWFsIGFjY2VsXHJcbiAgICBpZiAodXNlckRhdGEuZW1pdHRlck1vZGUgPT09IEVtaXR0ZXJNb2RlLkdSQVZJVFkpIHtcclxuICAgICAgICAvLyBncmF2aXR5XHJcbiAgICAgICAgY29uc3QgZ3Jhdml0eXggPSBwYXJzZUZsb2F0KGRpY3RbJ2dyYXZpdHl4J10gfHwgMCk7XHJcbiAgICAgICAgY29uc3QgZ3Jhdml0eXkgPSBwYXJzZUZsb2F0KGRpY3RbJ2dyYXZpdHl5J10gfHwgMCk7XHJcbiAgICAgICAgdXNlckRhdGEuZ3Jhdml0eSA9IG5ldyBWZWMyKGdyYXZpdHl4LCBncmF2aXR5eSk7XHJcbiAgICAgICAgLy8gc3BlZWRcclxuICAgICAgICB1c2VyRGF0YS5zcGVlZCA9IHBhcnNlRmxvYXQoZGljdFsnc3BlZWQnXSB8fCAwKTtcclxuICAgICAgICB1c2VyRGF0YS5zcGVlZFZhciA9IHBhcnNlRmxvYXQoZGljdFsnc3BlZWRWYXJpYW5jZSddIHx8IDApO1xyXG5cclxuICAgICAgICAvLyByYWRpYWwgYWNjZWxlcmF0aW9uXHJcbiAgICAgICAgdXNlckRhdGEucmFkaWFsQWNjZWwgPSBwYXJzZUZsb2F0KGRpY3RbJ3JhZGlhbEFjY2VsZXJhdGlvbiddIHx8IDApO1xyXG4gICAgICAgIHVzZXJEYXRhLnJhZGlhbEFjY2VsVmFyID0gcGFyc2VGbG9hdChkaWN0WydyYWRpYWxBY2NlbFZhcmlhbmNlJ10gfHwgMCk7XHJcblxyXG4gICAgICAgIC8vIHRhbmdlbnRpYWwgYWNjZWxlcmF0aW9uXHJcbiAgICAgICAgdXNlckRhdGEudGFuZ2VudGlhbEFjY2VsID0gcGFyc2VGbG9hdChkaWN0Wyd0YW5nZW50aWFsQWNjZWxlcmF0aW9uJ10gfHwgMCk7XHJcbiAgICAgICAgdXNlckRhdGEudGFuZ2VudGlhbEFjY2VsVmFyID0gcGFyc2VGbG9hdChkaWN0Wyd0YW5nZW50aWFsQWNjZWxWYXJpYW5jZSddIHx8IDApO1xyXG5cclxuICAgICAgICAvLyByb3RhdGlvbiBpcyBkaXJcclxuICAgICAgICBsZXQgbG9jUm90YXRpb25Jc0RpciA9IGRpY3RbJ3JvdGF0aW9uSXNEaXInXSB8fCAnJztcclxuICAgICAgICBpZiAobG9jUm90YXRpb25Jc0RpciAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBsb2NSb3RhdGlvbklzRGlyID0gbG9jUm90YXRpb25Jc0Rpci50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIHVzZXJEYXRhLnJvdGF0aW9uSXNEaXIgPSBsb2NSb3RhdGlvbklzRGlyID09PSAndHJ1ZScgfHwgbG9jUm90YXRpb25Jc0RpciA9PT0gJzEnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHVzZXJEYXRhLnJvdGF0aW9uSXNEaXIgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKHVzZXJEYXRhLmVtaXR0ZXJNb2RlID09PSBFbWl0dGVyTW9kZS5SQURJVVMpIHtcclxuICAgICAgICAvLyBvciBNb2RlIEI6IHJhZGl1cyBtb3ZlbWVudFxyXG4gICAgICAgIHVzZXJEYXRhLnN0YXJ0UmFkaXVzID0gcGFyc2VGbG9hdChkaWN0WydtYXhSYWRpdXMnXSB8fCAwKTtcclxuICAgICAgICB1c2VyRGF0YS5zdGFydFJhZGl1c1ZhciA9IHBhcnNlRmxvYXQoZGljdFsnbWF4UmFkaXVzVmFyaWFuY2UnXSB8fCAwKTtcclxuICAgICAgICB1c2VyRGF0YS5lbmRSYWRpdXMgPSBwYXJzZUZsb2F0KGRpY3RbJ21pblJhZGl1cyddIHx8IDApO1xyXG4gICAgICAgIHVzZXJEYXRhLmVuZFJhZGl1c1ZhciA9IHBhcnNlRmxvYXQoZGljdFsnbWluUmFkaXVzVmFyaWFuY2UnXSB8fCAwKTtcclxuICAgICAgICB1c2VyRGF0YS5yb3RhdGVQZXJTID0gcGFyc2VGbG9hdChkaWN0Wydyb3RhdGVQZXJTZWNvbmQnXSB8fCAwKTtcclxuICAgICAgICB1c2VyRGF0YS5yb3RhdGVQZXJTVmFyID0gcGFyc2VGbG9hdChkaWN0Wydyb3RhdGVQZXJTZWNvbmRWYXJpYW5jZSddIHx8IDApO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==